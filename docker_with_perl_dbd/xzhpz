Problem:    Check for $DISPLAY never fails.
Solution:   Use eval().
Files:      src/testdir/check.vim

Patch 8.2.3110
Problem:    A pattern that matches the cursor position is a bit complicated.
Solution:   Use a dot to indicate the cursor line and column. (Christian
            Brabandt, closes #8497, closes #8179)
Files:      runtime/doc/pattern.txt, src/errors.h, src/regexp_bt.c,
            src/regexp_nfa.c, src/testdir/test_regexp_latin.vim

Patch 8.2.3111
Problem:    Vim9: confusing error with extra whitespace before colon.
Solution:   Check for colon after white space. (closes #8513)
Files:      src/eval.c, src/vim9compile.c, src/testdir/test_vim9_script.vim

Patch 8.2.3112 (after 8.2.3090)
Problem:    With concealing enabled and indirectly closing a fold the cursor
            may be somewhere in a folded line when it is not on the first line
            of the fold.
Solution:   Check if the cursor is somewhere in the folded text.
Files:      src/drawscreen.c

Patch 8.2.3113
Problem:    No error when for loop variable shadows script variable.
Solution:   Check for the error. (closes #8512)
Files:      src/eval.c, src/testdir/test_vim9_script.vim

Patch 8.2.3114
Problem:    Amiga-like systems: build error checking for running process
Solution:   Only build swapfile_process_running() on systems where it is
            actually used. (Ola Söder, closes #8519)
Files:      src/memline.c

Patch 8.2.3115
Problem:    Coverity complains about free_wininfo() use.
Solution:   Add a condition that "wip2" is not equal to "wip". (Neovim #14996)
Files:      src/window.c

Patch 8.2.3116
Problem:    Vim9: crash when debugging a function with line continuation.
Solution:   Check for a NULL pointer. (closes #8521)
Files:      src/vim9execute.c, src/testdir/test_debugger.vim

Patch 8.2.3117
Problem:    Vim9: type not properly checked in for loop.
Solution:   Have items() return a list of lists.  Add runtime type checks.
            (closes #8515)
Files:      src/evalfunc.c, src/globals.h, src/vim9compile.c,
            src/testdir/test_vim9_script.vim

Patch 8.2.3118
Problem:    Vim9: "any" type not handled correctly in for loop.
Solution:   Change compile time check into runtime check. (closes #8516)
Files:      src/vim9compile.c, src/testdir/test_vim9_script.vim

Patch 8.2.3119
Problem:    Compiler warning for unused argument.
Solution:   Add UNUSED.
Files:      src/evalfunc.c

Patch 8.2.3120
Problem:    Crypt with sodium test fails on MS-Windows.
Solution:   Make the tests pass. (closes #8428)
Files:      src/testdir/test_crypt.vim

Patch 8.2.3121
Problem:    'listchars' "exceeds" character appears in foldcolumn. Window
            separator is missing. (Leonid V.  Fedorenchik)
Solution:   Only draw the "exceeds" character in the text area.  Break the
            loop when not drawing the text. (closes #8524)
Files:      src/drawline.c, src/testdir/test_listchars.vim,
            src/testdir/dumps/Test_listchars_01.dump,
            src/testdir/dumps/Test_listchars_02.dump,
            src/testdir/dumps/Test_listchars_03.dump,
            src/testdir/dumps/Test_listchars_04.dump,
            src/testdir/dumps/Test_listchars_05.dump

Patch 8.2.3122
Problem:    With 'nowrap' cursor position is unexpected in narrow window.
            (Leonid V.  Fedorenchik)
Solution:   Put cursor on the last non-empty line. (closes #8525)
Files:      src/move.c, src/testdir/test_listchars.vim,
            src/testdir/dumps/Test_listchars_06.dump,
            src/testdir/dumps/Test_listchars_07.dump

Patch 8.2.3123
Problem:    Vim9: confusing error when using white space after option, before
            one of "!&<".
Solution:   Give a specific error. (issue #8408)
Files:      src/errors.h, src/option.c, src/testdir/test_vim9_script.vim

Patch 8.2.3124
Problem:    Vim9: no error for white space between option and "=9".
Solution:   Check for extraneous white space. (issue #8408)
Files:      src/option.c, src/testdir/test_vim9_script.vim

Patch 8.2.3125
Problem:    Variables are set but not used.
Solution:   Move the declarations to the block where they are used.
            (closes #8527)
Files:      src/regexp_nfa.c

Patch 8.2.3126
Problem:    Vim9: for loop error reports wrong line number.
Solution:   Save and restore the line number when evaluating the expression.
            (closes #8514)
Files:      src/ex_eval.c, src/testdir/test_vim9_script.vim

Patch 8.2.3127
Problem:    Vim9: no error when adding number to list of string.
Solution:   Check the value type. (closes #8529)
Files:      src/list.c, src/testdir/test_vim9_builtin.vim

Patch 8.2.3128
Problem:    Vim9: uninitialized list does not get type checked.
Solution:   Set the type when initializing the variable. (closes #8529)
Files:      src/eval.c, src/evalvars.c, src/vim9script.c,
            src/userfunc.c, src/proto/vim9script.pro,
            src/testdir/test_vim9_builtin.vim

Patch 8.2.3129
Problem:    Vim9: imported uninitialized list does not get type checked.
Solution:   Get type from imported variable.
Files:      src/eval.c, src/evalvars.c, src/vim9script.c,
            src/proto/vim9script.pro, src/userfunc.c,
            src/testdir/test_vim9_script.vim

Patch 8.2.3130
Problem:    Vim9: import test fails.
Solution:   Rename directory back to "import", use "p" to avoid an error when
            the directory already exists.
Files:      src/testdir/test_vim9_script.vim

Patch 8.2.3131
Problem:    MS-Windows: ipv6 channel test is very flaky in the GUI.
Solution:   Skip the test.
Files:      src/testdir/test_channel.vim

Patch 8.2.3132
Problem:    Compiler warns for size_t to colnr_T conversion. (Randall W.
            Morris)
Solution:   Add a type cast.
Files:      src/drawscreen.c

Patch 8.2.3133
Problem:    Vim9: memory leak when add() fails.
Solution:   Allocate listitem_T after type check.
Files:      src/list.c

Patch 8.2.3134
Problem:    Crash when using typename() on a function reference. (Naohiro Ono)
Solution:   Initialize pointer to NULL. (closes #8531)
Files:      src/vim9type.c, src/testdir/test_vim9_builtin.vim

Patch 8.2.3135
Problem:    Vim9: builtin function arguments not checked at compile time.
Solution:   Add more type checks. (Yegappan Lakshmanan, closes #8539)
Files:      src/channel.c, src/errors.h, src/evalfunc.c, src/proto/typval.pro,
            src/terminal.c, src/testdir/test_search.vim,
            src/testdir/test_textprop.vim, src/testdir/test_vim9_builtin.vim,
            src/testing.c, src/textprop.c, src/typval.c

Patch 8.2.3136
Problem:    No test for E187 and "No swap file".
Solution:   Add a test. (Dominique Pellé, closes #8540)
Files:      src/testdir/test_cd.vim, src/testdir/test_swap.vim

Patch 8.2.3137
Problem:    Vim9: no error when a line only has a variable name.
Solution:   Give an error when an expression is evaluated without an effect.
            (closes #8538)
Files:      src/ex_eval.c, src/errors.h, src/vim9compile.c,
            src/testdir/test_vim9_script.vim, src/testdir/test_vim9_expr.vim,
            src/testdir/test_vim9_func.vim

Patch 8.2.3138 (after 8.2.3137)
Problem:    Debugger test fails.
Solution:   Adjust eval command.
Files:      src/testdir/test_debugger.vim

Patch 8.2.3139
Problem:    Functions for string manipulation are spread out.
Solution:   Move string related functions to a new source file. (Yegappan
            Lakshmanan, closes #8470)
Files:      Filelist, src/Make_ami.mak, src/Make_cyg_ming.mak,
            src/Make_mvc.mak, src/Make_vms.mms, src/Makefile, src/README.md,
            src/eval.c, src/evalfunc.c, src/mbyte.c, src/misc1.c, src/misc2.c,
            src/proto.h, src/proto/eval.pro, src/proto/evalfunc.pro,
            src/proto/mbyte.pro, src/proto/misc1.pro, src/proto/misc2.pro,
            src/proto/strings.pro, src/strings.c

Patch 8.2.3140 (after 8.2.3131)
Problem:    MS-Windows: ipv6 channel test is very flaky also without the GUI.
Solution:   Skip the test also without the GUI.
Files:      src/testdir/test_channel.vim

Patch 8.2.3141
Problem:    No error when using :complete for :command without -nargs.
Solution:   Give an error. (Martin Tournoij, closes #8544, closes #8541)
Files:      src/usercmd.c, src/errors.h, src/testdir/test_usercommands.vim

Patch 8.2.3142
Problem:    Vim9: type check for has_key() argument is too strict.
Solution:   Also allow for a number key argument. (closes #8542)
Files:      src/evalfunc.c, src/testdir/test_vim9_builtin.vim

Patch 8.2.3143
Problem:    Vim9: A lambda may be compiled with the wrong context if it is
            called from a profiled function.
Solution:   Compile the lambda with and without profiling. (closes #8543)
Files:      src/vim9compile.c, src/testdir/test_vim9_script.vim

Patch 8.2.3144
Problem:    Vim9: no error when using an invalid value for a line number.
Solution:   Give an error if the string value is not recognized.
            (closes #8536)
Files:      src/errors.h, src/eval.c, src/testdir/test_vim9_builtin.vim

Patch 8.2.3145
Problem:    Vim9: profile test fails without profile feature.
Solution:   Check the profile feature is present.
Files:      src/testdir/test_vim9_script.vim

Patch 8.2.3146
Problem:    Vim9: line number wrong for :execute argument.
Solution:   Use the line number of the :execute command itself. (closes #8537)
Files:      src/eval.c, src/testdir/test_vim9_script.vim

Patch 8.2.3147
Problem:    Vim9: profiling does not work with a nested function.
Solution:   Also compile a nested function without profiling. (closes #8543)
            Handle that compiling may cause the table of compiled functions to
            change.
Files:      src/vim9compile.c, src/vim9execute.c,
            src/testdir/test_vim9_script.vim

Patch 8.2.3148
Problem:    Vim9: function arg type check does not handle base offset.
Solution:   Take the base offset into account when checking builtin function
            argument types.
Files:      src/evalfunc.c, src/vim9compile.c,
            src/testdir/test_vim9_builtin.vim

Patch 8.2.3149 (after 8.2.3141)
Problem:    Some plugins have a problem with the error check for using
            :command with -complete but without -nargs.
Solution:   In legacy script only give a warning message.
Files:      src/usercmd.c, src/message.c, src/proto/message.pro,
            src/testdir/test_usercommands.vim

Patch 8.2.3150
Problem:    Vim9: argument types are not checked at compile time.
Solution:   Add more type checks. (Yegappan Lakshmanan, closes #8545)
Files:      src/evalfunc.c, src/testing.c, src/testdir/test_vim9_builtin.vim

Patch 8.2.3151
Problem:    Vim9: profiling fails if nested function is also profiled.
Solution:   Use the compile type from the outer function. (closes #8543)
Files:      src/vim9compile.c, src/testdir/test_vim9_script.vim

Patch 8.2.3152
Problem:    Vim9: accessing "s:" results in an error.
Solution:   Do not try to lookup a script variable for "s:". (closes #8549)
Files:      src/evalvars.c, src/testdir/test_vim9_expr.vim

Patch 8.2.3153
Problem:    URLs with a dash in the scheme are not recognized.
Solution:   Allow for a scheme with a dash, but not at the start or end.
            (Tsuyoshi CHO, closes #8299)
Files:      src/misc1.c, src/testdir/test_buffer.vim

Patch 8.2.3154
Problem:    Vim9: some type checks for builtin functions fail.
Solution:   Correct the type checks. (Yegappan Lakshmanan, closes #8551,
            closes #8550)
Files:      src/evalfunc.c, src/testdir/test_vim9_builtin.vim

Patch 8.2.3155
Problem:    Some option related code not covered by tests.
Solution:   Add a few test cases. (Dominique Pellé, closes #8552)
Files:      src/testdir/test_options.vim, src/testdir/test_set.vim

Patch 8.2.3156
Problem:    Vim9: term_getansicolors() test fails without +termguicolors.
Solution:   Add a check for the feature. (Dominique Pellé, closes #8555)
Files:      src/testdir/test_vim9_builtin.vim

Patch 8.2.3157
Problem:    Crypt test may fail on MS-Windows.
Solution:   Ignore "[unix]" in the file message. (Christian Brabandt,
            closes #8561)
Files:      src/testdir/test_crypt.vim

Patch 8.2.3158
Problem:    Strange error message when using islocked() with a number.
            (Yegappan Lakshmanan)
Solution:   Check that the name is empty.
Files:      src/evalfunc.c, src/testdir/test_functions.vim

Patch 8.2.3159
Problem:    Cursor displayed in wrong position after deleting line.
Solution:   When deleting lines do not approximate botline. (fixes #8559)
Files:      src/change.c

Patch 8.2.3160
Problem:    'breakindent' does not work well for bulleted and numbered lists.
Solution:   Add the "list" entry to 'breakindentopt'. (Christian Brabandt,
            closes #8564, closes #1661)
Files:      runtime/doc/options.txt, src/indent.c, src/structs.h,
            src/testdir/test_breakindent.vim

Patch 8.2.3161
Problem:    Vim9: no error when reltime() has invalid arguments.
Solution:   Add an error. (closes #8562)
Files:      src/time.c, src/testdir/test_vim9_builtin.vim

Patch 8.2.3162
Problem:    Vim9: argument types are not checked at compile time.
Solution:   Add more type checks. (Yegappan Lakshmanan, closes #8560)
Files:      runtime/doc/channel.txt, src/clientserver.c, src/cmdhist.c,
            src/errors.h, src/evalfunc.c, src/evalwindow.c, src/filepath.c,
            src/globals.h, src/popupwin.c, src/proto/typval.pro, src/sign.c,
            src/strings.c, src/terminal.c, src/testdir/test_normal.vim,
            src/testdir/test_reltime.vim, src/testdir/test_vim9_builtin.vim,
            src/testdir/test_vim9_expr.vim, src/testing.c, src/textprop.c,
            src/time.c, src/typval.c

Patch 8.2.3163
Problem:    Location list window may open a wrong file.
Solution:   Also update the qf_ptr field. (Wei-Chung Wen, closes #8565,
            closes #8566)
Files:      src/quickfix.c, src/testdir/test_quickfix.vim

Patch 8.2.3164
Problem:    MS-Windows: reported version lacks patchlevel, causing some update
            tools to update too often. (Klaus Frank)
Solution:   Add the patchlevel to the version. (Christian Brabandt)
Files:      src/dosinst.c

Patch 8.2.3165
Problem:    Vim9: in a || expression the error line number may be wrong.
Solution:   Save and restore the line number when checking the type.
            (closes #8569)
Files:      src/vim9compile.c, src/testdir/test_vim9_expr.vim

Patch 8.2.3166
Problem:    Vim9: nested autoload call error overruled by "Unknown error".
Solution:   Check need_rethrow before giving an "Unknown error".
            (closes #8568)
Files:      src/vim9execute.c, src/testdir/test_vim9_script.vim

Patch 8.2.3167
Problem:    Get E12 in a job callback when searching for tags. (Andy Stewart)
Solution:   Use the sandbox only for executing a command, not for searching.
            (closes #8511)
Files:      src/tag.c

Patch 8.2.3168
Problem:    Vim9: type error for constant of type any.
Solution:   Do add a runtime type check if a constant has type any.
            (closes #8570)
Files:      src/vim9compile.c, src/testdir/test_vim9_assign.vim

Patch 8.2.3169
Problem:    Vim9: cannot handle nested inline function.
Solution:   Check for nested inline function. (closes #8575)
Files:      src/userfunc.c, src/testdir/test_vim9_func.vim,
            src/testdir/test_vim9_expr.vim

Patch 8.2.3170
Problem:    Illegal memory access in test.
Solution:   Check pointer is not before the start of the line.
Files:      src/userfunc.c

Patch 8.2.3171
Problem:    Another illegal memory access in test.
Solution:   Check pointer is after the start of the line.
Files:      src/userfunc.c

Patch 8.2.3172
Problem:    MzScheme test fails. (Christian Brabandt)
Solution:   Correct function name.
Files:      src/testdir/test_vim9_builtin.vim

Patch 8.2.3173
Problem:    Vim9: argument types are not checked at compile time.
Solution:   Add more type checks. (Yegappan Lakshmanan, closes #8581)
Files:      src/diff.c, src/errors.h, src/evalfunc.c, src/globals.h,
            src/job.c, src/proto/typval.pro, src/strings.c, src/terminal.c,
            src/testdir/test_vim9_builtin.vim, src/typval.c

Patch 8.2.3174
Problem:    Vim9: "legacy undo" finds "undo" variable.
Solution:   Do not pass lookup function to find_ex_command(). (closes #8563)
Files:      src/vim9compile.c, src/testdir/test_vim9_assign.vim

Patch 8.2.3175
Problem:    Vim9: using illegal pointer with inline function inside a lambda.
Solution:   Clear eval_tofree_cmdline when advancing to the next line.
            (closes #8578)
Files:      src/eval.c, src/testdir/test_vim9_func.vim

Patch 8.2.3176
Problem:    Vim9: no type error for comparing number with string.
Solution:   Add a runtime type check. (closes #8571)
Files:      src/typval.c, src/errors.h, src/testdir/test_vim9_expr.vim

Patch 8.2.3177
Problem:    Vim9: can not use "for _ in expr" at script level.
Solution:   Skip assignment if the loop variable is "_".
Files:      src/eval.c, src/testdir/test_vim9_script.vim

Patch 8.2.3178
Problem:    Vim9: the file name of an :import cannot be an expression.
Solution:   Accept an expression that results in a string.  Do not support
            :import in a function.
Files:      runtime/doc/vim9.txt, src/vim9script.c, src/vim9compile.c,
            src/testdir/test_vim9_script.vim

Patch 8.2.3179
Problem:    Vim9: cannot assign to an imported variable at script level.
Solution:   Lookup imported items when assigning.
Files:      src/evalvars.c, src/errors.h, src/eval.c,
            src/testdir/test_vim9_script.vim

Patch 8.2.3180
Problem:    Vim9: memory leak when concatenating to an imported string.
Solution:   Clear the destination.
Files:      src/evalvars.c

Patch 8.2.3181
Problem:    Vim9: builtin function test fails without channel feature.
Solution:   Add feature checks. (Dominique Pellé, closes #8586)  Make feature
            checks more consistent.
Files:      src/testdir/test_vim9_builtin.vim

Patch 8.2.3182
Problem:    Vim9: crash when using removing items from a constant list.
            (Yegappan Lakshmanan)
Solution:   When a list was allocated with items copy them.
Files:      src/list.c, src/testdir/test_vim9_builtin.vim

Patch 8.2.3183
Problem:    Duplicate error numbers.
Solution:   Adjust the error numbers.
Files:      src/errors.h, src/testdir/test_vim9_builtin.vim

Patch 8.2.3184
Problem:    Cannot add a digraph with a leading space.  It is not easy to list
            existing digraphs.
Solution:   Add setdigraph(), setdigraphlist(), getdigraph() and
            getdigraphlist(). (closes #8580)
Files:      runtime/doc/digraph.txt, runtime/doc/eval.txt,
            runtime/doc/usr_41.txt, src/digraph.c, src/evalfunc.c,
            src/ex_docmd.c, src/globals.h, src/errors.h,
            src/proto/digraph.pro, src/testdir/test_digraph.vim

Patch 8.2.3185
Problem:    Vim9: start of inline function found in comment line.
Solution:   Do not check for inline function in comment line. (closes #8589)
Files:      src/userfunc.c, src/testdir/test_vim9_expr.vim

Patch 8.2.3186
Problem:    Vim9: not all failures for import tested
Solution:   Test more import failures
Files:      src/errors.h, src/evalvars.c, src/testdir/test_vim9_script.vim

Patch 8.2.3187
Problem:    Vim9: popup timer callback is not compiled.
Solution:   Compile the callback when creating the timer.
Files:      src/vim9compile.c, src/proto/vim9compile.pro, src/popupwin.c

Patch 8.2.3188
Problem:    Vim9: argument types are not checked at compile time.
Solution:   Add several more type checks, also at runtime. (Yegappan
            Lakshmanan, closes #8587)
Files:      src/blob.c, src/channel.c, src/clientserver.c, src/cmdexpand.c,
            src/cmdhist.c, src/dict.c, src/diff.c, src/errors.h, src/eval.c,
            src/evalbuffer.c, src/evalfunc.c, src/evalvars.c,
            src/evalwindow.c, src/filepath.c, src/globals.h, src/insexpand.c,
            src/job.c, src/list.c, src/map.c, src/match.c,
            src/proto/typval.pro, src/quickfix.c, src/search.c, src/sign.c,
            src/strings.c, src/terminal.c, src/testdir/test_blob.vim,
            src/testdir/test_gui.vim, src/testdir/test_vim9_builtin.vim,
            src/testing.c, src/textprop.c, src/time.c, src/typval.c

Patch 8.2.3189
Problem:    Vim9: error when using "try|".
Solution:   Allow for "|" right after a command.
Files:      src/ex_docmd.c, src/testdir/test_vim9_script.vim

Patch 8.2.3190
Problem:    Error messages are spread out.
Solution:   Move error messages to errors.h and give them a clear name.
Files:      src/globals.h, src/errors.h, src/buffer.c, src/debugger.c,
            src/digraph.c, src/edit.c, src/ex_cmds.c, src/ex_cmds2.c,
            src/ex_docmd.c, src/ex_eval.c, src/gui.c, src/list.c, src/main.c,
            src/map.c, src/match.c, src/quickfix.c, src/regexp.c,
            src/regexp_bt.c, src/regexp_nfa.c, src/register.c, src/search.c,
            src/session.c, src/spell.c, src/syntax.c, src/time.c,
            src/userfunc.c, src/vim9execute.c, src/window.c

Patch 8.2.3191
Problem:    Vim9: not enough code is tested.
Solution:   Use CheckLegacyAndVim9Success() in more places.  Fix uncovered
            problems.
Files:      src/vim9compile.c, src/vim9execute.c,
            src/testdir/test_listdict.vim

Patch 8.2.3192 (after 8.2.3190)
Problem:    Build failure with small version (Tony Mechelynck).
Solution:   Remove stray #ifdef.
Files:      src/errors.h

Patch 8.2.3193
Problem:    screenpos() is wrong when the last line is partially visible and
            'display' is "lastline".
Solution:   Also compute the position for a partially visible line.
            (closes #8599)
Files:      src/move.c, src/testdir/test_cursor_func.vim

Patch 8.2.3194
Problem:    Vim9: argument types are not checked at compile time.
Solution:   Add several more type checks, simplify some. (Yegappan
            Lakshmanan, closes #8598)
Files:      src/diff.c, src/evalbuffer.c, src/evalfunc.c, src/job.c,
            src/proto/typval.pro, src/sign.c, src/terminal.c,
            src/testdir/test_vim9_builtin.vim, src/typval.c

Patch 8.2.3195
Problem:    Vim9: unclear error when passing too many arguments to lambda.
Solution:   Pass the expression itself instead of "[expression]".
            (closes #8604)
Files:      src/vim9compile.c, src/testdir/test_vim9_func.vim

Patch 8.2.3196
Problem:    Vim9: bool expression with numbers only fails at runtime.
Solution:   Check constant to be bool at compile time. (closes #8603)
Files:      src/vim9compile.c, src/testdir/test_vim9_expr.vim

Patch 8.2.3197
Problem:    Error messages are spread out.
Solution:   Move a few more error messages to errors.h.
Files:      src/globals.h, src/errors.h, src/edit.c, src/ex_cmds.c,
            src/ex_docmd.c, src/evalvars.c, src/option.c, src/quickfix.c,
            src/regexp_bt.c, src/regexp_nfa.c, src/regexp.c, src/undo.c,
            src/vim9compile.c, src/vim9script.c

Patch 8.2.3198
Problem:    Cannot use 'formatlistpat' for breakindent.
Solution:   Use a negative list indent. (Maxim Kim, closes #8594)
Files:      runtime/doc/options.txt, src/indent.c,
            src/testdir/test_breakindent.vim

Patch 8.2.3199
Problem:    Vim9: execution speed can be improved.
Solution:   Make the break counter static.
Files:      src/vim9execute.c

Patch 8.2.3200
Problem:    Vim9: hard to guess where a type error is given.
Solution:   Add the function name where possible. (closes #8608)
Files:      src/dict.c, src/proto/dict.pro, src/eval.c, src/list.c,
            src/vim9compile.c, src/vim9execute.c, src/structs.h,
            src/vim9type.c, src/proto/vim9type.pro, src/if_py_both.h,
            src/errors.h, src/testdir/test_vim9_builtin.vim

Patch 8.2.3201 (after 8.2.3200)
Problem:    Crash in test.
Solution:   Initialize "where".
Files:      src/eval.c, src/evalvars.c

Patch 8.2.3202
Problem:    Vim9: tests are only executed for legacy script.
Solution:   Run more tests also for Vim9 script.  Fix uncovered problems.
Files:      src/vim9execute.c, src/ex_docmd.c, src/testdir/test_listdict.vim

Patch 8.2.3203
Problem:    Vim9: compiled string expression causes type error. (Yegappan
            Lakshmanan)
Solution:   Remove the string type from the stack.
Files:      src/vim9compile.c, src/evalfunc.c

Patch 8.2.3204
Problem:    Display garbled when 'cursorline' is set and lines wrap. (Gabriel
            Dupras)
Solution:   Avoid inserting lines twice. (closes #7255)
Files:      src/drawscreen.c, src/testdir/test_cursorline.vim,
            src/testdir/dumps/Test_cursorline_redraw_1.dump,
            src/testdir/dumps/Test_cursorline_redraw_2.dump

Patch 8.2.3205
Problem:    Coverity reports a null pointer dereference.
Solution:   Change the logic to avoid Coverity gets confused.
Files:      src/vim9compile.c

Patch 8.2.3206
Problem:    Vim9: argument types are not checked at compile time.
Solution:   Add several more type checks. (Yegappan Lakshmanan, closes #8611)
Files:      runtime/doc/eval.txt, src/blob.c, src/cmdhist.c, src/dict.c,
            src/errors.h, src/evalfunc.c, src/filepath.c, src/globals.h,
            src/job.c, src/list.c, src/match.c, src/misc1.c, src/popupwin.c,
            src/proto/typval.pro, src/sign.c, src/terminal.c,
            src/testdir/test_blob.vim, src/testdir/test_vim9_builtin.vim,
            src/typval.c

Patch 8.2.3207
Problem:    Vim9: crash when compiling string fails. (Yegappan Lakshmanan)
Solution:   Adjust the type stack length.
Files:      src/vim9compile.c, src/testdir/test_vim9_builtin.vim

Patch 8.2.3208
Problem:    Dynamic library load error does not mention why it failed.
Solution:   Add the error message. (Martin Tournoij, closes #8621)
Files:      src/globals.h, src/if_cscope.c, src/if_lua.c, src/if_mzsch.c,
            src/if_perl.xs, src/if_python.c, src/if_python3.c, src/if_ruby.c,
            src/if_tcl.c, src/mbyte.c, src/os_win32.c, src/proto/os_win32.pro,
            src/terminal.c

Patch 8.2.3209
Problem:    Vim9: lambda doesn't find block-local variable.
Solution:   Adjust how a script-local variable is found. (closes #8614)
Files:      src/vim9compile.c, src/testdir/test_vim9_func.vim

Patch 8.2.3210
Problem:    Vim9: searchpair() sixth argument is compiled. (Yegappan
            Lakshmanan)
Solution:   Only compile the fifth argument.
Files:      src/vim9compile.c, src/testdir/test_vim9_builtin.vim

Patch 8.2.3211
Problem:    Vim9: argument types are not checked at compile time.
Solution:   Add several more type checks. Fix type check for matchaddpos().
            (Yegappan Lakshmanan, closes #8619)
Files:      src/channel.c, src/evalfunc.c, src/evalvars.c, src/if_cscope.c,
            src/job.c, src/proto/typval.pro,
            src/testdir/test_vim9_builtin.vim, src/time.c, src/typval.c

Patch 8.2.3212
Problem:    Vim9: execution speed can be improved.
Solution:   Use __builtin_expect() to have the compiler produce better code.
            (Dominique Pellé, closes #8613)
Files:      src/vim9execute.c

Patch 8.2.3213
Problem:    NOCOMPOUNDSUGS entry in spell file not tested.
Solution:   Add a test. (Dominique Pellé, closes #8624)
Files:      src/testdir/test_spellfile.vim

Patch 8.2.3214
Problem:    MS-Windows: passing /D does not set the install location.
Solution:   Adjust how the installer uses $VIM. Update the documentation.
            (Christian Brabandt, Ken Takata, closes #8605)
Files:      nsis/gvim.nsi, runtime/doc/os_win32.txt

Patch 8.2.3215
Problem:    Vim9: argument types are not checked at compile time.
Solution:   Add several more type checks. Sort the argument lists.
            (Yegappan Lakshmanan, closes #8626)
Files:      src/change.c, src/evalfunc.c, src/filepath.c, src/sound.c,
            src/testdir/test_gui.vim, src/testdir/test_vim9_builtin.vim,
            src/testing.c

Patch 8.2.3216
Problem:    Vim9: crash when using variable in a loop at script level.
Solution:   Do not clear the variable if a function was defined.
            Do not create a new entry in sn_var_vals every time.
            (closes #8628)
Files:      src/eval.c, src/ex_eval.c, src/vim9script.c, src/userfunc.c,
            src/evalvars.c, src/structs.h

Patch 8.2.3217 (after 8.2.3216)
Problem:    Build failure.
Solution:   Add missing changes.
Files:      src/globals.h

Patch 8.2.3218
Problem:    When using xchaha20 crypt undo file is not removed.
Solution:   Reset 'undofile' and delete the file. (Christian Brabandt,
            closes #8630, closes #8467)
Files:      src/bufwrite.c, src/crypt.c, src/proto/undo.pro,
            src/testdir/test_crypt.vim, src/undo.c

Patch 8.2.3219
Problem:    :find searches non-existing directories.
Solution:   Check the path is not "..".  Update help. (Christian Brabandt,
            closes #8612, closes #8533)
Files:      runtime/doc/editing.txt, src/findfile.c,
            src/testdir/test_findfile.vim

Patch 8.2.3220
Problem:    Test_term_setansicolors() fails in some configurations.
Solution:   Check available features. (Dominique Pellé, closes #8636)
Files:      src/testdir/test_vim9_builtin.vim

Patch 8.2.3221
Problem:    Vim9: argument types are not checked at compile time.
Solution:   Add several more type checks. (Yegappan Lakshmanan, closes #8632)
Files:      src/evalfunc.c, src/popupwin.c, src/proto/typval.pro,
            src/testdir/test_assert.vim, src/testdir/test_vim9_builtin.vim,
            src/testdir/test_vim9_script.vim, src/testing.c, src/typval.c

Patch 8.2.3222
Problem:    Vim9: cannot use loop variable later as lambda argument.
Solution:   When not in function context check the current block ID.
            (closes #8637)
Files:      src/vim9compile.c, src/testdir/test_vim9_func.vim

Patch 8.2.3223
Problem:    Vim: using {} block in autoloaded omnifunc fails.
Solution:   Allow using {} block when text is locked. (closes #8631)
Files:      src/ex_cmds.h, src/testdir/test_ins_complete.vim

Patch 8.2.3224
Problem:    Cannot call script-local function after :vim9cmd. (Christian J.
            Robinson)
Solution:   Skip over "<SNR>123".
Files:      src/vim9compile.c, src/eval.c, src/testdir/test_vim9_cmd.vim

Patch 8.2.3225
Problem:    Incsearch highlighting is attempted halfway a mapping.
Solution:   Only do incsearch highlighting if keys were typed or there is no
            more typeahead.
Files:      src/ex_getln.c

Patch 8.2.3226
Problem:    New digraph functions use old naming scheme.
Solution:   Use the digraph_ prefix. (Hirohito Higashi, closes #8642)
Files:      runtime/doc/digraph.txt, runtime/doc/eval.txt,
            runtime/doc/usr_41.txt, src/digraph.c, src/edit.c, src/errors.h,
            src/evalfunc.c, src/proto/digraph.pro,
            src/testdir/test_digraph.vim

Patch 8.2.3227
Problem:    'virtualedit' can only be set globally.
Solution:   Make 'virtualedit' global-local. (Gary Johnson, closes #8638)
Files:      runtime/doc/options.txt, src/buffer.c, src/change.c,
            src/drawscreen.c, src/edit.c, src/misc2.c, src/normal.c,
            src/ops.c, src/option.c, src/option.h, src/optiondefs.h,
            src/optionstr.c, src/proto/option.pro, src/register.c,
            src/structs.h, src/testdir/test_virtualedit.vim

Patch 8.2.3228
Problem:    Cannot use a simple block for the :command argument. (Maarten
            Tournoij)
Solution:   Recognize a simple {} block. (issue #8623)
Files:      runtime/doc/map.txt, src/misc2.c, src/proto/misc2.pro,
            src/usercmd.c, src/testdir/test_usercommands.vim

Patch 8.2.3229
Problem:    Vim9: runtime and compile time type checks are not the same.
Solution:   Add more runtime type checks for builtin functions. (Yegappan
            Lakshmanan, closes #8646)
Files:      src/arglist.c, src/change.c, src/channel.c, src/cindent.c,
            src/clientserver.c, src/cmdhist.c, src/dict.c, src/diff.c,
            src/digraph.c, src/errors.h, src/eval.c, src/evalbuffer.c,
            src/evalfunc.c, src/evalwindow.c, src/ex_docmd.c, src/ex_getln.c,
            src/filepath.c, src/findfile.c, src/float.c, src/fold.c,
            src/getchar.c, src/indent.c, src/insexpand.c, src/job.c,
            src/json.c, src/list.c, src/mark.c, src/match.c, src/mbyte.c,
            src/menu.c, src/misc1.c, src/move.c, src/popupwin.c,
            src/proto/typval.pro, src/quickfix.c, src/search.c, src/sign.c,
            src/sound.c, src/strings.c, src/terminal.c,
            src/testdir/test_assert.vim, src/testdir/test_blob.vim,
            src/testdir/test_execute_func.vim,
            src/testdir/test_float_func.vim, src/testdir/test_functions.vim,
            src/testdir/test_glob2regpat.vim, src/testdir/test_listdict.vim,
            src/testdir/test_vim9_builtin.vim,
            src/testdir/test_vim9_script.vim, src/testing.c, src/textprop.c,
            src/time.c, src/typval.c, src/undo.c

Patch 8.2.3230
Problem:    Vim9: type error when function return type is not known yet.
Solution:   When return type is unknown, use "any". (closes #8644)
Files:      src/vim9compile.c, src/testdir/test_vim9_builtin.vim

Patch 8.2.3231
Problem:    Build failure with small features.
Solution:   Adjust #ifdef.
Files:      src/errors.h

Patch 8.2.3232 (after 8.2.3229)
Problem:    system() does not work without a second argument.
Solution:   Do not require a second argument. (Yegappan Lakshmanan,
            closes #8651, closes #8650)
Files:      src/misc1.c, src/proto/typval.pro,
            src/testdir/test_vim9_builtin.vim, src/typval.c

Patch 8.2.3233
Problem:    prop_list() and prop_find() do not indicate the buffer for the
            used type.
Solution:   Add "type_bufnr" to the results. (closes #8647)
Files:      runtime/doc/textprop.txt, src/testdir/test_textprop.vim,
            src/textprop.c

Patch 8.2.3234
Problem:    Crash when printing long string with Lua.
Solution:   Remove lua_pop(). (Martin Tournoij, closes #8648)
Files:      src/if_lua.c, src/testdir/test_lua.vim

Patch 8.2.3235
Problem:    Cannot use lambda in {} block in user command. (Martin Tournoij)
Solution:   Do not go over the end of the lambda.
Files:      src/userfunc.c, src/testdir/test_usercommands.vim

Patch 8.2.3236
Problem:    mode() does not indicate using CTRL-O in Select mode.
Solution:   Use "vs" and similar. (closes #8640)
Files:      runtime/doc/eval.txt, src/globals.h, src/misc1.c, src/normal.c,
            src/testdir/test_functions.vim

Patch 8.2.3237
Problem:    When a builtin function gives an error processing continues.
Solution:   In Vim9 script return FAIL in get_func_tv().
Files:      src/userfunc.c, src/testdir/test_vim9_assign.vim

Patch 8.2.3238
Problem:    Vim9: error message does not indicate the location.
Solution:   Add the relevant text. (issue #8634)
Files:      src/errors.h, src/vim9compile.c, src/testdir/test_vim9_expr.vim

Patch 8.2.3239
Problem:    Vim9: no error using heredoc for a number variable.
Solution:   Add a type check. (closes #8627)
Files:      src/vim9compile.c, src/evalvars.c,
            src/testdir/test_vim9_assign.vim

Patch 8.2.3240
Problem:    Lua print() does not work properly.
Solution:   Put back lua_pop().
Files:      src/if_lua.c, src/testdir/test_lua.vim

Patch 8.2.3241
Problem:    Vim9: memory leak when function reports an error.
Solution:   Clear the return value.
Files:      src/userfunc.c

Patch 8.2.3242
Problem:    Vim9: valgrind reports leaks in builtin function test.
Solution:   Do not start a job.
Files:      src/testdir/test_vim9_builtin.vim

Patch 8.2.3243
Problem:    MS-Windows: the "edit with multiple Vim" choice is not that
            useful.
Solution:   Change it to "Edit with multiple tabs". (Michael Soyka,
            closes #8645)
Files:      src/GvimExt/gvimext.cpp, src/GvimExt/gvimext.h

Patch 8.2.3244
Problem:    Lua 5.3 print() with a long string crashes.
Solution:   Use a growarray instead of a Lua buffer. (Yegappan Lakshmanan,
            closes #8655)
Files:      src/if_lua.c, src/misc2.c, src/proto/misc2.pro

Patch 8.2.3245
Problem:    The crypt key may appear in a swap partition.
Solution:   When using xchacha20 use sodium_mlock(). (Christian Brabandt,
            closes #8657)
Files:      src/buffer.c, src/crypt.c, src/errors.h, src/fileio.c,
            src/memline.c, src/vim.h

Patch 8.2.3246
Problem:    Memory use after free.
Solution:   When clearing a string option set the pointer to "empty_option".
Files:      src/option.c

Patch 8.2.3247
Problem:    Using uninitialized memory when checking for crypt method.
Solution:   Check the header length before using the salt and seed.
Files:      src/fileio.c

Patch 8.2.3248
Problem:    Vim9: error message for wrong input uses wrong line number.
Solution:   Use the line number of the start of the command. (issue #8653)
Files:      src/vim9script.c, src/testdir/test_vim9_script.vim

Patch 8.2.3249
Problem:    Vim9: error for re-imported function with default argument.
Solution:   Do not check argument type if it is still unknown. (closes #8653)
Files:      src/vim9type.c, src/proto/vim9type.pro, src/vim9script.c,
            src/vim.h, src/eval.c, src/vim9execute.c,
            src/testdir/test_vim9_script.vim

Patch 8.2.3250
Problem:    MS-Windows: cannot build with libsodium.
Solution:   Change FEAT_SODIUM into HAVE_SODIUM. (Christian Brabandt,
            closes #8668, closes #8663)
Files:      src/Make_mvc.mak

Patch 8.2.3251
Problem:    Listing builtin_gui as an available terminal is confusing.
Solution:   Do not list builtin_gui. (Christian Brabandt, closes #8669,
            closes #8661)
Files:      src/term.c, src/testdir/test_termcodes.vim

Patch 8.2.3252
Problem:    Duplicated code for adding buffer lines.
Solution:   Move code to a common function.  Also move map functions to map.c.
            (Yegappan Lakshmanan, closes #8665)
Files:      src/evalbuffer.c, src/evalfunc.c, src/map.c, src/proto/map.pro

Patch 8.2.3253
Problem:    Channel test fails randomly.
Solution:   Add a sleep after sending the "echoerr" command. (Michael Soyka)
Files:      src/testdir/test_channel.vim, src/testdir/test_channel.py

Patch 8.2.3254
Problem:    win_gettype() does not recognize a quickfix window.
Solution:   Add "quickfix" and "loclist". (Yegappan Lakshmanan, closes #8676)
Files:      runtime/doc/eval.txt, src/evalwindow.c, src/misc2.c,
            src/testdir/test_quickfix.vim

Patch 8.2.3255
Problem:    ci" finds following string but ci< and others don't.
Solution:   When not inside an object find the start. (Connor Lane Smit,
            closes #8670)
Files:      src/search.c, src/testdir/test_textobjects.vim, src/textobject.c

Patch 8.2.3256
Problem:    Executable test may fail on new Ubuntu system.
Solution:   Consider /usr/bin/cat and /bin/cat the same.
Files:      src/testdir/test_functions.vim

Patch 8.2.3257
Problem:    Calling prop_find() with -1 for ID gives erroneous error. (Naohiro
            Ono)
Solution:   When passing -1 use -2. (closes #8674)
Files:      src/textprop.c, src/testdir/test_textprop.vim

Patch 8.2.3258
Problem:    Error messages have the wrong text.
Solution:   Adjust the error message.
Files:      src/errors.h, src/typval.c, src/testdir/test_vim9_builtin.vim

Patch 8.2.3259
Problem:    When 'indentexpr' causes an error the did_throw flag may remain
            set.
Solution:   Reset did_throw and show the error. (closes #8677)
Files:      src/indent.c, src/ex_docmd.c, src/proto/ex_docmd.pro

Patch 8.2.3260
Problem:    Build failure with small features.
Solution:   Add #ifdef.
Files:      src/ex_docmd.c

Patch 8.2.3261
Problem:    Vim9: when compiling repeat(123, N) return type is number.
Solution:   Make return type a string. (closes #8664)
Files:      src/evalfunc.c, src/testdir/test_vim9_builtin.vim

Patch 8.2.3262
Problem:    Build failure when ABORT_ON_INTERNAL_ERROR is defined.
Solution:   Adjust how estack_len_before is used.
Files:      src/ex_docmd.c

Patch 8.2.3263
Problem:    Vim9: "..=" does not accept same types as the ".." operator.
Solution:   Convert value to string like ".." does. (issue #8664)
Files:      src/vim9compile.c, src/testdir/test_vim9_assign.vim,
            src/testdir/test_vim9_disassemble.vim

Patch 8.2.3264 (after 8.2.3263)
Problem:    Vim9: assign test fails.
Solution:   Add missing change.
Files:      src/eval.c

Patch 8.2.3265
Problem:    Smartcase does not work correctly in very magic pattern.
Solution:   Take the magicness into account when skipping over regexp items.
            (Christian Brabandt, closes #8682, closes #7845)
Files:      src/search.c, src/testdir/test_search.vim

Patch 8.2.3266
Problem:    Vim9: assignment with two indexes may check next line.
Solution:   Limit the number of lines to avoid checking the next line when
            assigning to a LHS subscript. (closes #8660)
Files:      src/vim9compile.c, src/testdir/test_vim9_assign.vim

Patch 8.2.3267
Problem:    Vim9: crash when disassembling a function that uses a deleted
            script variable.
Solution:   Check the variable still exists. (closes #8683)
Files:      src/vim9execute.c, src/testdir/test_vim9_disassemble.vim

Patch 8.2.3268
Problem:    Cannot use a block with :autocmd like with :command.
Solution:   Add support for a {} block after :autocmd. (closes #8620)
Files:      runtime/doc/autocmd.txt, runtime/doc/map.txt, src/autocmd.c,
            src/proto/autocmd.pro, src/usercmd.c, src/proto/usercmd.pro,
            src/ex_docmd.c, src/vim.h, src/testdir/test_autocmd.vim

Patch 8.2.3269
Problem:    Vim9: wrong argument check for partial. (Naohiro Ono)
Solution:   Handle getting return type without arguments. Correct the minimal
            number of arguments for what is included in the partial.
            (closes #8667)
Files:      src/evalfunc.c, src/vim9type.c, src/testdir/test_vim9_func.vim

