Problem:    Stuck in redraw loop when 'lazyredraw' is set.
Solution:   Don't loop on update_screen() when not redrawing. (Yasuhiro
            Matsumoto, closes #2082)
Files:      src/terminal.c, src/screen.c, src/proto/screen.pro

Patch 8.0.1101
Problem:    Channel write fails if writing to log fails.
Solution:   Ignore return value of fwrite(). (Ozaki Kiichi, closes #2081)
Files:      src/channel.c

Patch 8.0.1102
Problem:    Terminal window does not use Normal colors.
Solution:   For the GUI and when 'termguicolors' is enabled, use the actual
            foreground and background colors for the terminal.  (Yasuhiro
            Matsumoto, closes #2067)
            Use the "Terminal" highlight group if defined.
Files:      src/terminal.c, src/syntax.c, src/proto/syntax.pro

Patch 8.0.1103 (after 8.0.1102)
Problem:    Converting cterm color fails for grey ramp.
Solution:   Use index instead of number.
Files:      src/terminal.c

Patch 8.0.1104
Problem:    The qf_jump() function is too long.
Solution:   Split of parts to separate functions. (Yegappan Lakshmanan)
Files:      src/quickfix.c

Patch 8.0.1105
Problem:    match() and matchend() are not tested.
Solution:   Add tests. (Ozaki Kiichi, closes #2088)
Files:      src/testdir/test_functions.vim, src/testdir/test_match.vim

Patch 8.0.1106
Problem:    Terminal colors on an MS-Windows console are not matching the
            normal colors.
Solution:   Use the normal colors for the terminal. (Yasuhiro Matsumoto,
            closes #2087)
Files:      src/terminal.c

Patch 8.0.1107
Problem:    Terminal debugger jumps to non-existing file.
Solution:   Check that the file exists.  Add an option to make the Vim width
            wide. Fix removing highlight groups.
Files:      runtime/pack/dist/opt/termdebug/plugin/termdebug.vim,
            runtime/doc/terminal.txt

Patch 8.0.1108
Problem:    Cannot specify mappings for the terminal window.
Solution:   Add the :tmap command and associated code.  (Jacob Askeland,
            closes #2073)
Files:      runtime/doc/map.txt, runtime/doc/terminal.txt, src/ex_cmdidxs.h,
            src/ex_cmds.h, src/ex_docmd.c, src/getchar.c, src/gui.c,
            src/terminal.c, src/testdir/test_terminal.vim, src/vim.h,
            src/proto/terminal.pro, src/main.c, src/evalfunc.c

Patch 8.0.1109
Problem:    Timer causes error on exit from Ex mode. (xtal8)
Solution:   save and restore the ex_pressedreturn flag. (Christian Brabandt,
            closes #2079)
Files:      src/ex_docmd.c, src/proto/ex_docmd.pro, src/ex_cmds2.c,
            src/testdir/test_timers.vim

Patch 8.0.1110
Problem:    FORTIFY_SOURCE from Perl causes problems. (Scott Baker)
Solution:   Filter out the flag. (Christian Brabandt, closes #2068)
Files:      src/configure.ac, src/auto/configure

Patch 8.0.1111
Problem:    Syntax error in configure when using Perl.
Solution:   Add missing quote
Files:      src/configure.ac, src/auto/configure

Patch 8.0.1112
Problem:    Can't get size or current index from quickfix list.
Solution:   Add "idx" and "size" options. (Yegappan Lakshmanan)
Files:      runtime/doc/eval.txt, src/quickfix.c,
            src/testdir/test_quickfix.vim

Patch 8.0.1113
Problem:    Can go to Insert mode from Terminal-Normal mode.
Solution:   Prevent :startinsert and "VA" to enter Insert mode. (Yasuhiro
            Matsumoto, closes #2092)
Files:      src/normal.c

Patch 8.0.1114
Problem:    Default for 'iminsert' is annoying.
Solution:   Make the default always zero. (Yasuhiro Matsumoto, closes #2071)
Files:      src/option.c, runtime/doc/options.txt

Patch 8.0.1115
Problem:    Crash when using foldtextresult() recursively.
Solution:   Avoid recursive calls. (Yasuhiro Matsumoto, closes #2098)
Files:      src/evalfunc.c, src/testdir/test_fold.vim

Patch 8.0.1116
Problem:    Terminal test fails on MS-Windows.
Solution:   Wait for the text to appear. (micbou, closes #2097)
Files:      src/testdir/test_terminal.vim

Patch 8.0.1117
Problem:    Test_terminal_no_cmd hangs on MS-Windows with GUI. (Christian
            Brabandt)
Solution:   Run the command with "start" and wait for the text to appear.
            (micbou, closes #2096)
Files:      src/testdir/test_terminal.vim

Patch 8.0.1118
Problem:    FEAT_WINDOWS adds a lot of #ifdefs while it is nearly always
            enabled and only adds 7% to the binary size of the tiny build.
Solution:   Graduate FEAT_WINDOWS.
Files:      src/feature.h, src/window.c, src/vim.h, src/structs.h,
            src/globals.h, src/gui.h, src/if_py_both.h, src/option.h,
            src/term.h, src/buffer.c, src/charset.c, src/digraph.c,
            src/edit.c, src/eval.c, src/evalfunc.c, src/ex_cmds.c,
            src/ex_cmds2.c, src/ex_docmd.c, src/ex_getln.c, src/fileio.c,
            src/fold.c, src/getchar.c, src/gui.c, src/gui_athena.c,
            src/gui_beval.c, src/gui_gtk.c, src/gui_motif.c, src/gui_w32.c,
            src/if_cscope.c, src/if_lua.c, src/if_mzsch.c, src/if_python.c,
            src/if_python3.c, src/if_ruby.c, src/if_tcl.c, src/main.c,
            src/mark.c, src/memline.c, src/misc1.c, src/misc2.c, src/move.c,
            src/netbeans.c, src/normal.c, src/option.c, src/popupmnu.c,
            src/quickfix.c, src/screen.c, src/search.c, src/spell.c,
            src/syntax.c, src/tag.c, src/term.c, src/ui.c, src/version.c,
            src/workshop.c, src/if_perl.xs, src/testdir/test_normal.vim

Patch 8.0.1119
Problem:    Quitting a split terminal window kills the job. (Yasuhiro
            Matsumoto)
Solution:   Only stop terminal job if it is the last window.
Files:      src/buffer.c, src/testdir/test_terminal.vim

Patch 8.0.1120 (after 8.0.1108)
Problem:    :tm means :tmap instead of :tmenu. (Taro Muraoka)
Solution:   Move the new entry below the old entry. (closes #2102)
Files:      src/ex_cmds.h, runtime/doc/map.txt

Patch 8.0.1121
Problem:    Can uncheck executables in MS-Windows installer.
Solution:   Make the choice read-only. (Ken Takata, closes #2106)
Files:      nsis/gvim.nsi

Patch 8.0.1122
Problem:    vimtutor.bat doesn't work well with vim.bat.
Solution:   Use "call vim". (Ken Takata, closes #2105)
Files:      vimtutor.bat

Patch 8.0.1123
Problem:    Cannot define a toolbar for a window.
Solution:   Add a window-local toolbar.
Files:      src/syntax.c, src/proto/syntax.pro, src/structs.h, src/menu.c,
            src/proto/menu.pro, src/testdir/test_winbar.vim, src/Makefile,
            src/normal.c, src/testdir/Make_all.mak, src/if_perl.xs,
            src/eval.c, src/evalfunc.c, src/window.c, src/ui.c,
            src/terminal.c, src/screen.c,
            runtime/pack/dist/opt/termdebug/plugin/termdebug.vim,
            runtime/doc/gui.txt, runtime/doc/terminal.txt

Patch 8.0.1124
Problem:    Use of MZSCHEME_VER is unclear.
Solution:   Add a comment. (Ken Takata)
Files:      src/Make_cyg_ming.mak, src/Make_mvc.mak

Patch 8.0.1125
Problem:    Wrong window height when splitting window with window toolbar.
Solution:   Add or subtract the window toolbar height.
Files:      src/window.c

Patch 8.0.1126
Problem:    Endless resize when terminal showing in two buffers. (Hirohito
            Higashi)
Solution:   Set a flag to prevent resizing the window.
Files:      src/terminal.c

Patch 8.0.1127
Problem:    Test_peek_and_get_char fails on 32 bit system. (Elimar
            Riesebieter)
Solution:   Avoid an integer overflow. (James McCoy, closes #2116)
Files:      src/ex_cmds2.c

Patch 8.0.1128
Problem:    Old xterm sends CTRL-X in response to t_RS.
Solution:   Only send t_RS for xterm 279 and later.  Remove the workaround to
            ignore CTRL-X.
Files:      src/term.c

Patch 8.0.1129
Problem:    Window toolbar missing a part of the patch.
Solution:   Add change in vim.h.
Files:      src/vim.h

Patch 8.0.1130
Problem:    The qf_jump() function is still too long.
Solution:   Split of parts to separate functions. (Yegappan Lakshmanan)
Files:      src/quickfix.c

Patch 8.0.1131
Problem:    It is not easy to trigger an autocommand for new terminal window.
            (Marco Restelli)
Solution:   Trigger BufWinEnter after setting 'buftype'.
Files:      src/terminal.c, src/testdir/test_terminal.vim

Patch 8.0.1132
Problem:    #if condition is not portable.
Solution:   Add defined(). (Zuloloxi, closes #2136)
Files:      src/libvterm/src/vterm.c

Patch 8.0.1133
Problem:    Syntax timeout not used correctly.
Solution:   Do not pass the timeout to syntax_start() but set it explicitly.
            (Yasuhiro Matsumoto, closes #2139)
Files:      src/proto/syntax.pro, src/screen.c, src/syntax.c

Patch 8.0.1134
Problem:    Superfluous call to syn_get_final_id().
Solution:   Remove it. (Ken Takata)
Files:      src/syntax.c

Patch 8.0.1135
Problem:    W_WINCOL() is always the same.
Solution:   Expand the macro.
Files:      src/edit.c, src/ex_docmd.c, src/gui_gtk.c, src/gui_w32.c,
            src/netbeans.c, src/popupmnu.c, src/screen.c, src/term.c,
            src/terminal.c, src/ui.c, src/window.c, src/if_py_both.h,
            src/structs.h, src/vim.h

Patch 8.0.1136
Problem:    W_WIDTH() is always the same.
Solution:   Expand the macro.
Files:      src/charset.c, src/edit.c, src/evalfunc.c, src/ex_cmds.c,
            src/ex_docmd.c, src/getchar.c, src/gui.c, src/gui_beval.c,
            src/gui_mac.c, src/if_lua.c, src/if_mzsch.c, src/if_py_both.h,
            src/if_ruby.c, src/misc1.c, src/misc2.c, src/move.c, src/normal.c,
            src/popupmnu.c, src/quickfix.c, src/screen.c, src/search.c,
            src/structs.h, src/ui.c, src/vim.h, src/window.c

Patch 8.0.1137 (after 8.0.1136)
Problem:    Cannot build with Ruby.
Solution:   Fix misplaced brace.
Files:      src/if_ruby.c

Patch 8.0.1138
Problem:    Click in window toolbar starts Visual mode.
Solution:   Add the MOUSE_WINBAR flag.
Files:      src/ui.c, src/vim.h, src/normal.c

Patch 8.0.1139
Problem:    Using window toolbar changes state.
Solution:   Always execute window toolbar actions in Normal mode.
Files:      runtime/doc/gui.txt, src/structs.h, src/ex_docmd.c,
            src/proto/ex_docmd.pro, src/menu.c

Patch 8.0.1140
Problem:    Still old style tests.
Solution:   Convert two tests to new style. (Yegappan Lakshmanan)
Files:      src/Makefile, src/testdir/Make_all.mak, src/testdir/Make_vms.mms,
            src/testdir/test56.in, src/testdir/test56.ok,
            src/testdir/test57.in, src/testdir/test57.ok,
            src/testdir/test_sort.vim, src/testdir/test_vimscript.vim

Patch 8.0.1141
Problem:    MS-Windows build dependencies are incomplete.
Solution:   Fix the dependencies. (Ken Takata)
Files:      src/Make_cyg.mak, src/Make_cyg_ming.mak, src/Make_ming.mak,
            src/Make_mvc.mak

Patch 8.0.1142
Problem:    Window toolbar menu gets a tear-off item.
Solution:   Recognize the window toolbar.
Files:      src/menu.c

Patch 8.0.1143
Problem:    Macros always expand to the same thing.
Solution:   Remove W_VSEP_WIDTH() and W_STATUS_HEIGHT().
Files:      src/vim.h, src/structs.h, src/gui.c, src/ex_getln.c, src/screen.c

Patch 8.0.1144
Problem:    Using wrong #ifdef for computing length.
Solution:   use BACKSLASH_IN_FILENAME instead of COLON_IN_FILENAME. (Yasuhiro
            Matsumoto, closes #2153)
Files:      src/quickfix.c

Patch 8.0.1145
Problem:    Warning when compiling with Perl.
Solution:   Remove unused variable. (Ken Takata)
Files:      src/if_perl.xs

Patch 8.0.1146
Problem:    Redraw when highlight is set with same names. (Ozaki Kiichi)
Solution:   Only free and save a name when it changed. (closes #2120)
Files:      src/syntax.c

Patch 8.0.1147
Problem:    Fail to build with tiny features. (Tony Mechelynck)
Solution:   Move #ifdefs.
Files:      src/syntax.c

Patch 8.0.1148
Problem:    "gN" doesn't work on last match with 'wrapscan' off. (fcpg)
Solution:   Adjust for searching backward. (Christian Brabandt)
Files:      src/search.c, src/testdir/test_gn.vim

Patch 8.0.1149
Problem:    libvterm colors differ from xterm.
Solution:   Use the xterm colors for libvterm.
Files:      src/terminal.c, src/libvterm/src/pen.c,
            src/testdir/xterm_ramp.vim, Filelist

Patch 8.0.1150
Problem:    MS-Windows GUI: dialog font size is incorrect.
Solution:   Pass flag to indicate 'encoding' or active codepage. (Yasuhiro
            Matsumoto, closes #2160)
Files:      src/gui_w32.c

Patch 8.0.1151
Problem:    "vim -c startinsert!" doesn't append.
Solution:   Correct line number on startup. (Christian Brabandt, closes #2117)
Files:      src/ex_docmd.c, src/testdir/test_startup.vim

Patch 8.0.1152
Problem:    Encoding of error message wrong in Cygwin terminal.
Solution:   Get locale from environment variables. (Ken Takata)
Files:      src/main.c, src/mbyte.c, src/proto/mbyte.pro

Patch 8.0.1153
Problem:    No tests for diff_hlID() and diff_filler().
Solution:   Add tests. (Dominique Pelle, closes #2156)
Files:      src/testdir/test_diffmode.vim

Patch 8.0.1154
Problem:    'indentkeys' does not work properly. (Gary Johnson)
Solution:   Get the cursor line again. (Christian Brabandt, closes #2151)
Files:      src/edit.c, src/testdir/test_edit.vim

Patch 8.0.1155
Problem:    Ruby command triggers a warning when RUBYOPT is set to "-w".
Solution:   use "-e_=0" instead of "-e0". (Masataka Pocke Kuwabara, closes
            #2143)
Files:      src/if_ruby.c

Patch 8.0.1156
Problem:    Removing one -W argument from Perl CFLAGS may cause trouble.
Solution:   Remove all -W flags. (Christian Brabandt)
Files:      src/configure.ac, src/auto/configure

Patch 8.0.1157
Problem:    Compiler warning on MS-Windows.
Solution:   Add type cast. (Yasuhiro Matsumoto)
Files:      src/main.c

Patch 8.0.1158
Problem:    Still old style tests.
Solution:   Convert several tests to new style. (Yegappan Lakshmanan)
Files:      src/Makefile, src/testdir/Make_all.mak, src/testdir/Make_vms.mms,
            src/testdir/main.aap, src/testdir/test33.in,
            src/testdir/test33.ok, src/testdir/test41.in,
            src/testdir/test41.ok, src/testdir/test43.in,
            src/testdir/test43.ok, src/testdir/test53.in,
            src/testdir/test53.ok, src/testdir/test_file_size.vim,
            src/testdir/test_lispwords.vim, src/testdir/test_search.vim,
            src/testdir/test_textobjects.vim

Patch 8.0.1159
Problem:    Typo in #ifdef.
Solution:   Change "PROT" to "PROTO". (Nobuhiro Takasaki, closes #2165)
Files:      src/syntax.c

Patch 8.0.1160
Problem:    Getting tab-local variable fails after closing window.
Solution:   set tp_firstwin and tp_lastwin. (Jason Franklin, closes #2170)
Files:      src/window.c, src/evalfunc.c, src/testdir/test_getvar.vim

Patch 8.0.1161
Problem:    Popup menu drawing problem when resizing terminal.
Solution:   Redraw after resizing also when a popup menu is visible. (Ozaki
            Kiichi, closes #2110)
Files:      src/popupmnu.c, src/term.c, src/testdir/shared.vim,
            src/testdir/test_popup.vim

Patch 8.0.1162
Problem:    Shared script for tests cannot be included twice.
Solution:   Include it where needed, it will "finish" if loaded again.
Files:      src/testdir/test_alot.vim, src/testdir/test_bufline.vim,
            src/testdir/test_timers.vim

Patch 8.0.1163
Problem:    Popup test is flaky.
Solution:   Add a WaitFor() and fix another.
Files:      src/testdir/test_popup.vim

Patch 8.0.1164
Problem:    Changing StatusLine highlight while evaluating 'statusline' may
            not change the status line color.
Solution:   When changing highlighting while redrawing don't cause another
            redraw. (suggested by Ozaki Kiichi, closes #2171, closes #2120)
Files:      src/buffer.c, src/syntax.c

Patch 8.0.1165
Problem:    Popup test is still flaky.
Solution:   Add a term_wait() call. (Ozaki Kiichi)
Files:      src/testdir/test_popup.vim

Patch 8.0.1166
Problem:    :terminal doesn't work on Mac High Sierra.
Solution:   Change #ifdef for OpenPTY(). (Ozaki Kiichi, Kazunobu Kuriyama,
            closes #2162)
Files:      src/pty.c

Patch 8.0.1167
Problem:    Motif: typing in terminal window is slow.
Solution:   Do not redraw the whole terminal window but only what was changed.
Files:      src/terminal.c

Patch 8.0.1168
Problem:    wrong highlighting with combination of match and 'cursorline'.
Solution:   Use "line_attr" when appropriate. (Ozaki Kiichi, closes #2111)
            But don't highlight more than one character.
Files:      src/screen.c, src/testdir/test_highlight.vim,
            src/testdir/view_util.vim

Patch 8.0.1169
Problem:    Highlighting one char too many with 'list' and 'cul'.
Solution:   Check for 'list' being active. (Ozaki Kiichi, closes #2177)
Files:      src/screen.c, src/testdir/test_highlight.vim

Patch 8.0.1170
Problem:    Using termdebug results in 100% CPU time. (tomleb)
Solution:   Use polling instead of select().
Files:      src/os_unix.c, src/channel.c, src/proto/channel.pro

Patch 8.0.1171
Problem:    Popup test is still a bit flaky.
Solution:   Change term_wait() calls. (Ozaki Kiichi)
Files:      src/testdir/test_popup.vim

Patch 8.0.1172
Problem:    When E734 is given option is still set.
Solution:   Assign NULL to "s". (Christian Brabandt)
Files:      src/eval.c, src/testdir/test_assign.vim

Patch 8.0.1173
Problem:    Terminal window is not redrawn after CTRL-L. (Marcin Szamotulski)
Solution:   Redraw the whole terminal when w_redr_type is NOT_VALID.
Files:      src/terminal.c

Patch 8.0.1174
Problem:    Mac Terminal.app has wrong color for white.
Solution:   Use white from the color cube.
Files:      src/globals.h, src/term.c, src/syntax.c

Patch 8.0.1175 (after  8.0.1174)
Problem:    Build failure without +termresponse.
Solution:   Add #ifdef.
Files:      src/syntax.c

Patch 8.0.1176
Problem:    Job_start() does not handle quote and backslash correctly.
Solution:   Remove quotes, recognize and remove backslashes.
Files:      src/testdir/test_channel.vim, src/os_unix.c

Patch 8.0.1177
Problem:    In a terminal window the popup menu is not cleared. (Gerry
            Agbobada)
Solution:   Redraw when SOME_VALID is used instead of NOT_VALID. (closes
            #2194)
Files:      src/terminal.c

Patch 8.0.1178
Problem:    Using old compiler on MS-Windows.
Solution:   Switch default build on MS-Windows to use MSVC 2015. (Ken Takata)
Files:      src/msvc2015.bat, src/INSTALLpc.txt, src/GvimExt/Makefile,
            src/Make_mvc.mak, src/tee/Make_mvc.mak, src/xxd/Make_mvc.mak

Patch 8.0.1179
Problem:    Test_popup_and_window_resize() does not always pass.
Solution:   Do not use $VIMPROG, pass the Vim executable in the vimcmd file.
            (Ozaki Kiichi, closes #2186)
Files:      src/testdir/Makefile, src/testdir/shared.vim,
            src/testdir/test_popup.vim

Patch 8.0.1180
Problem:    MS-Windows testclean target deletes the color script.
Solution:   Rename the script file.
Files:      src/testdir/xterm_ramp.vim, src/testdir/color_ramp.vim

Patch 8.0.1181
Problem:    Tests using Vim command fail on MS-Windows.
Solution:   Do not add quotes around the Vim command.
Files:      src/testdir/Make_dos.mak, src/testdir/Make_ming.mak

Patch 8.0.1182
Problem:    Cannot see or change mzscheme dll name.
Solution:   Add 'mzschemedll' and 'mzschemegcdll'.
Files:      src/if_mzsch.c, src/option.h, src/option.c,
            runtime/doc/if_mzsch.txt

Patch 8.0.1183
Problem:    MS-Windows build instructions are outdated.
Solution:   Update instructions for MSVC 2015.  Update the build script.
Files:      Filelist, Makefile, src/INSTALLpc.txt, src/bigvim.bat

Patch 8.0.1184
Problem:    The :marks command is not tested.
Solution:   Add a test. (Dominique Pelle, closes #2197)
Files:      src/testdir/test_marks.vim

Patch 8.0.1185
Problem:    Ruby library includes minor version number.
Solution:   Only use the API version number. (Ben Boeckel, closes #2199)
Files:      src/configure.ac, src/auto/configure

Patch 8.0.1186
Problem:    Still quite a few old style tests.
Solution:   Convert old to new style tests. (Yegappan Lakshmanan)
            Avoid ringing the bell while running tests.
Files:      src/Makefile, src/testdir/Make_all.mak, src/testdir/Make_ming.mak,
            src/testdir/Make_vms.mms, src/testdir/main.aap,
            src/testdir/test31.in, src/testdir/test31.ok,
            src/testdir/test4.in, src/testdir/test4.ok, src/testdir/test5.in,
            src/testdir/test5.ok, src/testdir/test60.in,
            src/testdir/test60.ok, src/testdir/test60.vim,
            src/testdir/test7.in, src/testdir/test7.ok, src/testdir/test78.in,
            src/testdir/test78.ok, src/testdir/test_autocmd.vim,
            src/testdir/test_exists.vim, src/testdir/test_recover.vim,
            src/testdir/test_winbuf_close.vim, src/testdir/runtest.vim

Patch 8.0.1187
Problem:    Building with lua fails for OSX on Travis.
Solution:   Separate brew-update and brew-install. (Ozaki Kiichi, closes #2203)
Files:      .travis.yml

Patch 8.0.1188
Problem:    Autocmd test fails on MS-Windows.
Solution:   Give the buffer a name and find the buffer to be wiped out by
            name.
Files:      src/testdir/test_autocmd.vim

Patch 8.0.1189
Problem:    E172 is not actually useful, it's only on Unix anyway.
Solution:   Remove the check and the error.
Files:      src/ex_docmd.c, runtime/doc/message.txt

Patch 8.0.1190
Problem:    Vim becomes unusable after opening new window in BufWritePre
            event.
Solution:   Call not_exiting(). (Martin Tournoij, closes #2205)
            Also for "2q" when a help window is open.  Add a test.
Files:      src/ex_docmd.c, src/testdir/test_writefile.vim

Patch 8.0.1191
Problem:    MS-Windows: missing 32 and 64 bit files in installer.
Solution:   Include both 32 and 64 bit GvimExt and related dll files. Remove
            old Windows code from the installer. (Ken Takata, closes #2144)
Files:      nsis/README.txt, nsis/gvim.nsi, src/GvimExt/gvimext.cpp,
            src/dosinst.c, src/dosinst.h, src/uninstal.c, Makefile

Patch 8.0.1192
Problem:    MS-Windows: terminal feature not enabled by default.
Solution:   Enable it. (Ken Takata)
Files:      src/Make_cyg_ming.mak, src/Make_mvc.mak

Patch 8.0.1193
Problem:    Crash when wiping out a buffer after using getbufinfo().
            (Yegappan Lakshmanan)
Solution:   Remove b:changedtick from the buffer variables.
Files:      src/buffer.c, src/testdir/test_autocmd.vim

Patch 8.0.1194
Problem:    Actual fg and bg colors of terminal are unknown.
Solution:   Add t_RF.  Store response to t_RB and t_RF, use for terminal.
Files:      src/term.c, src/term.h, src/proto/term.pro, src/terminal.c,
            src/vim.h, src/eval.c, runtime/doc/eval.txt

Patch 8.0.1195 (after 8.0.1194)
Problem:    Can't build on MS-Windows.
Solution:   Adjust #ifdef and add #ifdefs.
Files:      src/term.c, src/terminal.c

Patch 8.0.1196 (after 8.0.1194)
Problem:    Crash when t_RF is not set. (Brian Pina)
Solution:   Add t_RF to the list of terminal options. (Hirohito Higashi)
Files:      src/option.c

Patch 8.0.1197
Problem:    MS-Windows build instructions are not up to date.
Solution:   Adjust the instructions.  Fix the nsis script.
Files:      Makefile, nsis/gvim.nsi

Patch 8.0.1198
Problem:    Older compilers don't know uint8_t.
Solution:   Use char_u instead.
Files:      src/term.c, src/proto/term.pro

Patch 8.0.1199
Problem:    When 'clipboard' is "autoselectplus" the star register is also
            set. (Gilles Moris)
Solution:   Don't set the star register in this situation.
Files:      src/ops.c

Patch 8.0.1200
Problem:    Tests switch the bell off twice.
Solution:   Don't set 'belloff' in individual tests. (Christian Brabandt)
Files:      src/testdir/test_alot.vim, src/testdir/test_alot_utf8.vim,
            src/testdir/test_autocmd.vim, src/testdir/test_cmdline.vim,
            src/testdir/test_diffmode.vim, src/testdir/test_digraph.vim,
            src/testdir/test_edit.vim, src/testdir/test_file_size.vim,
            src/testdir/test_gn.vim, src/testdir/test_normal.vim,
            src/testdir/test_packadd.vim, src/testdir/test_popup.vim,
            src/testdir/test_recover.vim, src/testdir/test_search.vim,
            src/testdir/test_textobjects.vim, src/testdir/test_undo.vim,
            src/testdir/test_usercommands.vim, src/testdir/test_visual.vim

Patch 8.0.1201
Problem:    "yL" is affected by 'scrolloff'. (Eli the Bearded)
Solution:   Don't use 'scrolloff' when an operator is pending.
Files:      src/normal.c, runtime/doc/motion.txt

Patch 8.0.1202
Problem:    :wall gives an error for a terminal window. (Marius Gedminas)
Solution:   Don't try writing a buffer that can't be written. (Yasuhiro
            Matsumoto, closes #2190)
Files:      src/ex_cmds.c, src/testdir/test_terminal.vim

Patch 8.0.1203
Problem:    Terminal window mistreats composing characters.
Solution:   Count composing characters with the base character. (Ozaki Kiichi,
            closes #2195)
Files:      src/mbyte.c, src/terminal.c, src/testdir/test_terminal.vim

Patch 8.0.1204
Problem:    A QuitPre autocommand may get the wrong file name.
Solution:   Pass the buffer being closed to apply_autocmds(). (Rich Howe)
Files:      src/ex_docmd.c, src/testdir/test_autocmd.vim

Patch 8.0.1205
Problem:    Using "1q" it is possible to unload a changed buffer. (Rick Howe)
Solution:   Check the right window for changes.
Files:      src/testdir/test_edit.vim, src/ex_docmd.c

Patch 8.0.1206
Problem:    No autocmd for entering or leaving the command line.
Solution:   Add CmdlineEnter and CmdlineLeave.
Files:      runtime/doc/autocmd.txt, src/ex_getln.c, src/fileio.c, src/vim.h,
            src/testdir/test_autocmd.vim

Patch 8.0.1207
Problem:    Profiling skips the first and last script line.
Solution:   Check for BOM after setting script ID. (LemonBoy, closes #2103,
            closes #2112) Add a test. List the trailing script lines.
Files:      src/testdir/test_profile.vim, src/ex_cmds2.c

Patch 8.0.1208
Problem:    'statusline' drops empty group with highlight change.
Solution:   Do not drop an empty group if it changes highlighting. (Marius
            Gedminas, closes #2228)
Files:      src/buffer.c, src/testdir/test_statusline.vim

Patch 8.0.1209
Problem:    Still too many old style tests.
Solution:   Convert a few more tests to new style. (Yegappan Lakshmanan,
            closes #2230)
Files:      src/Makefile, src/testdir/Make_all.mak, src/testdir/Make_ming.mak,
            src/testdir/Make_amiga.mak, src/testdir/Make_dos.mak,
            src/testdir/Makefile, src/testdir/Make_vms.mms,
            src/testdir/main.aap, src/testdir/test34.in,
            src/testdir/test34.ok, src/testdir/test54.in,
            src/testdir/test54.ok, src/testdir/test8.in, src/testdir/test8.ok,
            src/testdir/test_autocmd.vim, src/testdir/test_autoformat_join.in,
            src/testdir/test_autoformat_join.ok, src/testdir/test_join.vim,
            src/testdir/test_user_func.vim

Patch 8.0.1210
Problem:    When typing a search pattern CTRL-G and CTRL-T are ignored when
            there is typeahead.
Solution:   Don't pass SEARCH_PEEK and don't call char_avail(). (haya14busa,
            closes #2233)
Files:      src/ex_getln.c, src/testdir/test_search.vim

Patch 8.0.1211
Problem:    Cannot reorder tab pages with drag & drop.
Solution:   Support drag & drop for GTK and MS-Windows. (Ken Takata, Masamichi
            Abe)
Files:      src/gui_gtk_x11.c, src/gui_w32.c

Patch 8.0.1212
Problem:    MS-Windows: tear-off menu does not work on 64 bit. (shaggyaxe)
Solution:   Change how the menu handle is looked up. (Ken Takata, closes
            #1205)
Files:      src/gui_w32.c

Patch 8.0.1213
Problem:    Setting 'mzschemedll' has no effect.
Solution:   Move loading .vimrc to before call to mzscheme_main().
Files:      src/main.c

Patch 8.0.1214
Problem:    Accessing freed memory when EXITFREE is set and there is more than
            one tab and window. (Dominique Pelle)
Solution:   Free options later.  Skip redraw when exiting.
Files:      src/screen.c, src/misc2.c

Patch 8.0.1215
Problem:    Newer gcc warns for implicit fallthrough.
Solution:   Consistently use a FALLTHROUGH comment. (Christian Brabandt)
Files:      src/buffer.c, src/edit.c, src/eval.c, src/ex_docmd.c,
            src/ex_getln.c, src/main.c, src/message.c, src/normal.c,
            src/regexp.c, src/regexp_nfa.c, src/spell.c, src/window.c,
            src/if_perl.xs

Patch 8.0.1216
Problem:    Tabline is not always updated for :file command. (Norio Takagi)
Solution:   Set redraw_tabline. (Hirohito Higashi)
Files:      src/ex_cmds.c

Patch 8.0.1217
Problem:    Can't use remote eval to inspect vars in debug mode.
Solution:   Don't discard the call stack in debug mode. (closes #2237, #2247)
Files:      src/globals.h, src/ex_cmds2.c, src/main.c

Patch 8.0.1218
Problem:    Writing to freed memory in autocmd.
Solution:   Make a copy of the tag line. (Dominique Pelle, closes #2245)
Files:      src/tag.c, src/testdir/test_autocmd.vim

Patch 8.0.1219
Problem:    Terminal test is flaky.
Solution:   Add test function to list of flaky tests.
Files:      src/testdir/runtest.vim

Patch 8.0.1220
Problem:    Skipping empty statusline groups is not correct.
Solution:   Also set group_end_userhl. (itchyny)
Files:      src/buffer.c, src/testdir/test_statusline.vim

Patch 8.0.1221
Problem:    Still too many old style tests.
Solution:   Convert a few more tests to new style. (Yegappan Lakshmanan,
            closes #2256)
Files:      src/Makefile, src/testdir/Make_all.mak,
            src/testdir/Make_amiga.mak, src/testdir/Make_dos.mak,
            src/testdir/Make_ming.mak, src/testdir/Make_vms.mms,
            src/testdir/main.aap, src/testdir/test19.in,
            src/testdir/test19.ok, src/testdir/test20.in,
            src/testdir/test20.ok, src/testdir/test25.in,
            src/testdir/test25.ok, src/testdir/test28.in,
            src/testdir/test28.ok, src/testdir/test32.in,
            src/testdir/test32.ok, src/testdir/test38.in,
            src/testdir/test38.ok, src/testdir/test66.in,
            src/testdir/test66.ok, src/testdir/test79.in,
            src/testdir/test79.ok, src/testdir/test_ins_complete.vim,
            src/testdir/test_source_utf8.vim, src/testdir/test_substitute.vim,
            src/testdir/test_tab.vim, src/testdir/test_tagjump.vim,
            src/testdir/test_undo.vim, src/testdir/test_visual.vim,
            src/testdir/test79.ok, src/testdir/test79.in,
            src/testdir/test28.in

Patch 8.0.1222
Problem:    Test functions interfere with each other.
Solution:   Cleanup tab pages, windows and buffers.  Reset option.
Files:      src/testdir/runtest.vim, src/testdir/test_filetype.vim,
            src/testdir/test_tabpage.vim, src/testdir/test_lispwords.vim

Patch 8.0.1223
Problem:    Crash when using autocomplete and tab pages.
Solution:   Check if the current tab changed. (Christian Brabandt, closes
            #2239)
Files:      src/popupmnu.c, src/testdir/test_popup.vim, src/misc1.c,

Patch 8.0.1224
Problem:    Still interference between test functions.
Solution:   Clear autocommands. Wipe all buffers.  Fix tests that depend on a
            specific start context.
Files:      src/testdir/runtest.vim, src/testdir/test_autocmd.vim,
            src/testdir/test_arglist.vim, src/testdir/test_bufwintabinfo.vim,
            src/testdir/test_command_count.vim, src/testdir/test_quickfix.vim,
            src/testdir/test_hardcopy.vim, src/testdir/test_ins_complete.vim,
            src/testdir/test_packadd.vim, src/testdir/test_signs.vim,
            src/testdir/test_autochdir.vim

Patch 8.0.1225
Problem:    No check for spell region being zero. (geeknik)
Solution:   Check for zero. (closes #2252)
Files:      src/spellfile.c, src/testdir/test_spell.vim

Patch 8.0.1226
Problem:    Edit and popup tests failing.
Solution:   Make the tests pass.
Files:      src/testdir/test_edit.vim, src/testdir/test_popup.vim

Patch 8.0.1227
Problem:    Undefined left shift in readfile(). (Brian 'geeknik' Carpenter)
Solution:   Add cast to unsigned. (Dominique Pelle, closes #2253)
Files:      src/fileio.c

Patch 8.0.1228
Problem:    Invalid memory access in GUI test.
Solution:   Check that the row is not outside of the screen.
Files:      src/screen.c

Patch 8.0.1229
Problem:    Condition in vim_str2nr() is always true. (Nikolai Pavlov)
Solution:   Remove the condition. (Closes #2259)
Files:      src/charset.c

Patch 8.0.1230
Problem:    CTRL-A in Visual mode uses character after selection. (Nikolai
            Pavlov)
Solution:   Check the length before using a character.
Files:      src/charset.c

Patch 8.0.1231
Problem:    Expanding file name drops dash. (stucki)
Solution:   Use the right position. (Christian Brabandt, closes #2184)
Files:      src/ex_docmd.c, src/testdir/test_cmdline.vim

Patch 8.0.1232
Problem:    MS-Windows users are confused about default mappings.
Solution:   Don't map keys in the console where they don't work.  Add a choice
            in the installer to use MS-Windows key bindings or not. (Christian
            Brabandt, Ken Takata, closes #2093)
Files:      Filelist, nsis/gvim.nsi, nsis/vimrc.ini, src/dosinst.c,
            runtime/mswin.vim

Patch 8.0.1233
Problem:    Typo in dos installer.
Solution:   Remove comma.
Files:      src/dosinst.c

Patch 8.0.1234
Problem:    MS-Windows: composing characters are not shown properly.
Solution:   Pass base character and composing characters to the renderer at
            once. (Ken Takata, closes #2206)
Files:      src/gui.c, src/gui_w32.c

Patch 8.0.1235
Problem:    Cannot disable the terminal feature in a huge build. (lindhobe)
Solution:   Adjust the autoconf check. (Kazunobu Kuriyama, closes #2242)
Files:      src/configure.ac, src/auto/configure, src/Makefile

Patch 8.0.1236
Problem:    Mac features are confusing.
Solution:   Make feature names more consistent, add "osxdarwin". Rename
            feature flags, cleanup Mac code. (Kazunobu Kuriyama, closes #2178)
            Also includes a fix for when Ruby throws an exception inside
            :rubyfile. (ujihisa)
Files:      runtime/doc/eval.txt, runtime/doc/os_mac.txt, src/auto/configure,
            src/config.h.in, src/configure.ac, src/digraph.c, src/edit.c,
            src/evalfunc.c, src/feature.h, src/fileio.c, src/getchar.c,
            src/globals.h, src/gui.c, src/gui_mac.c, src/if_python.c,
            src/if_python3.c, src/if_ruby.c, src/keymap.h, src/macros.h,
            src/main.c, src/mbyte.c, src/message.c, src/misc1.c, src/misc2.c,
            src/option.c, src/os_mac.h, src/os_macosx.m, src/os_unix.c,
            src/proto.h, src/pty.c, src/structs.h, src/term.c, src/termlib.c,
            src/ui.c, src/undo.c, src/version.c, src/vim.h, src/window.c

Patch 8.0.1237
Problem:    ":set scroll&" often gives an error.
Solution:   Don't use a fixed default value, use half the window height. Add a
            test. (Ozaki Kiichi, closes #2104)
Files:      src/Makefile, src/option.c, src/testdir/test_alot.vim,
            src/testdir/test_scroll_opt.vim

Patch 8.0.1238
Problem:    Incremental search only shows one match.
Solution:   When 'incsearch' and 'hlsearch' are both set highlight all
            matches. (haya14busa, itchyny, closes #2198)
Files:      runtime/doc/options.txt, src/ex_getln.c, src/proto/search.pro,
            src/search.c, src/testdir/test_search.vim

Patch 8.0.1239
Problem:    Cannot use a lambda for the skip argument to searchpair().
Solution:   Evaluate a partial, funcref and lambda. (LemonBoy, closes #1454,
            closes #2265)
Files:      runtime/doc/eval.txt, src/evalfunc.c, src/proto/evalfunc.pro,
            src/eval.c, src/proto/eval.pro, src/search.c,
            src/testdir/test_search.vim

Patch 8.0.1240
Problem:    MS-Windows: term_start() does not support environment.
Solution:   Implement the environment argument. (Yasuhiro Matsumoto, closes
            #2264)
Files:      src/os_win32.c, src/proto/os_win32.pro, src/terminal.c,
            src/testdir/test_terminal.vim

Patch 8.0.1241
Problem:    Popup test is flaky. (James McCoy)
Solution:   Increase the wait time. (Dominique Pelle)
Files:      src/testdir/test_popup.vim

Patch 8.0.1242
Problem:    Function argument with only dash is seen as number zero. (Wang
            Shidong)
Solution:   See a dash as a string. (Christian Brabandt)
Files:      src/testdir/test_ins_complete.vim, src/Makefile, src/eval.c

Patch 8.0.1243
Problem:    No test for what 8.0.1227 fixes.
Solution:   Add a test that triggers the problem. (Christian Brabandt)
Files:      src/testdir/test_normal.vim, src/testdir/test_search.vim

Patch 8.0.1244
Problem:    Search test does not work correctly on MS-Windows.
Solution:   Put text in a file instead of sending it to the terminal.
            (Christian Brabandt)
Files:      src/testdir/test_search.vim

Patch 8.0.1245
Problem:    When WaitFor() has a wrong expression it just waits a second,
            which goes unnoticed. (James McCoy)
Solution:   When WaitFor() times out throw an exception.  Fix places where the
            expression was wrong.
Files:      src/testdir/shared.vim, src/testdir/test_channel.vim,
            src/testdir/test_netbeans.vim, src/testdir/test_terminal.vim

Patch 8.0.1246
Problem:    Popup test has an arbitrary delay.
Solution:   Wait for the ruler to show. (James McCoy)
Files:      src/testdir/test_popup.vim

Patch 8.0.1247
Problem:    Not easy to find Debian build info.
Solution:   Add a badge in the README file. (Dominique Pelle)
Files:      README.md

Patch 8.0.1248 (after 8.0.1247)
Problem:    Stray + in README file.
Solution:   Remove the +.  Add a line break.
Files:      README.md

Patch 8.0.1249
Problem:    No error when WaitFor() gets an invalid wrong expression.
Solution:   Do not ignore errors in evaluation of the expression.  Fix places
            where the expression was wrong.
Files:      src/testdir/shared.vim, src/testdir/test_netbeans.vim

Patch 8.0.1250
Problem:    'hlsearch' highlighting not removed after incsearch (lacygoill)
Solution:   Redraw all windows. Start search at the end of the match.  Improve
            how CTRL-G works with incremental search. Add tests. (Christian
            Brabandt, Hirohito Higashi, haya14busa, closes #2267)
Files:      runtime/doc/options.txt, src/ex_getln.c,
            src/testdir/test_search.vim

Patch 8.0.1251 (after 8.0.1249)
Problem:    Invalid expression passed to WaitFor().
Solution:   Check if the variable exists.
Files:      src/testdir/test_clientserver.vim

Patch 8.0.1252
Problem:    Incomplete translations makefile for MinGW/Cygwin.
Solution:   Add missing source files.  Make it work with msys2's bash. (Ken
            Takata)
Files:      src/po/Make_cyg.mak, src/po/Make_ming.mak, src/po/Make_mvc.mak

Patch 8.0.1253
Problem:    Still too many old style tests.
Solution:   Convert a few more tests to new style. (Yegappan Lakshmanan,
            closes #2272)
Files:      src/Makefile, src/testdir/Make_all.mak,
            src/testdir/Make_amiga.mak, src/testdir/Make_dos.mak,
            src/testdir/Make_ming.mak, src/testdir/Make_vms.mms,
            src/testdir/main.aap, src/testdir/test12.in,
            src/testdir/test12.ok, src/testdir/test40.in,
            src/testdir/test40.ok, src/testdir/test45.in,
            src/testdir/test45.ok, src/testdir/test83.in,
            src/testdir/test83.ok, src/testdir/test_autocmd.vim,
            src/testdir/test_fold.vim, src/testdir/test_swap.vim,
            src/testdir/test_tagjump.vim

Patch 8.0.1254
Problem:    Undefined left shift in gethexchrs(). (geeknik)
Solution:   Use unsigned long. (idea by Christian Brabandt, closes #2255)
Files:      src/regexp.c, src/regexp_nfa.c


Patch 8.0.1255 (after 8.0.1248)
Problem:    duplicate badge README file.
Solution:   Remove one. (Dominique Pelle)
Files:      README.md

Patch 8.0.1256
Problem:    Typo in configure variable vim_cv_tgent. (Matthieu Guillard)
Solution:   Rename the variable. (closes #2281)
Files:      src/configure.ac, src/auto/configure

Patch 8.0.1257 (after 8.0.1254)
Problem:    No test for fix of undefined behavior.
Solution:   Add a test. (closes #2255)
Files:      src/testdir/test_search.vim

Patch 8.0.1258
Problem:    'ttymouse' is set to "sgr" even though it's not supported. (Gary
            Johnson)
Solution:   Adjust #ifdef
Files:      src/term.c

Patch 8.0.1259
Problem:    Search test can be flaky.
Solution:   Use WaitFor() instead of a delay.  Make it possible to pass a
            funcref to WaitFor() to avoid the need for global variables.
