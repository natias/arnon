Files:	    src/term.c

Patch 8.1.1665
Problem:    Crash when popup window with mask is below the screen.
Solution:   Correct boundary check.
Files:	    src/popupwin.c, src/testdir/test_popupwin.vim,
            src/testdir/dumps/Test_popupwin_mask_5.dump

Patch 8.1.1666
Problem:    Click in popup window scrollbar with border doesn't scroll.
Solution:   Correct column for the border. (Naruhiko Nishino, closes #4650)
Files:	    src/popupwin.c, src/testdir/test_popupwin.vim,
            src/testdir/dumps/Test_popupwin_scroll_9.dump

Patch 8.1.1667
Problem:    Flags for Ex commands may clash with other symbols.
Solution:   Prepend with EX_.
Files:	    src/ex_cmds.h, src/evalfunc.c, src/ex_docmd.c, src/ex_getln.c,
            src/usercmd.c, src/syntax.c

Patch 8.1.1668
Problem:    Popup window test is a bit flaky on some systems.
Solution:   Clear the command line. (Naruhiko Nishino, closes #4656)
Files:	    src/testdir/test_popupwin.vim

Patch 8.1.1669
Problem:    Travis: test results section is closed even when some tests
            failed.
Solution:   Only close the section on success. (Daniel Hahler, closes #4659)
Files:	    .travis.yml

Patch 8.1.1670
Problem:    Sign column not always properly aligned.
Solution:   Use "col" only after it was calculated. (Yee Cheng Chin,
            closes #4649)
Files:	    src/gui.c

Patch 8.1.1671
Problem:    Copying a blob may result in it being locked.
Solution:   Reset v_lock. (Ken Takata, closes #4648)
Files:	    src/blob.c, src/testdir/test_blob.vim

Patch 8.1.1672 (after  8.1.1667)
Problem:    "make cmdidxs" doesn't work.
Solution:   Update macro names. (Naruhiko Nishino, closes #4660)
Files:	    src/create_cmdidxs.vim

Patch 8.1.1673
Problem:    Cannot easily find the popup window at a certain position.
Solution:   Add popup_locate().
Files:	    runtime/doc/popup.txt, src/evalfunc.c, src/popupwin.c,
            src/proto/popupwin.pro, src/testdir/test_popupwin.vim

Patch 8.1.1674
Problem:    Script to check a colorscheme can be improved.
Solution:   Match the whole group name. Don't warn for what is usually omitted.
Files:	    runtime/colors/tools/check_colors.vim

Patch 8.1.1675
Problem:    Listener list not correctly updated on listener_remove().
Solution:   Only set "prev" when not removing a listener.  Return one if the
            listener was found and removed.
Files:	    src/change.c

Patch 8.1.1676
Problem:    "maxwidth" of popup window does not always work properly.
Solution:   Adjust the computation. (Naruhiko Nishino, closes #4653)
Files:	    src/popupwin.c, src/testdir/test_popupwin.vim,
            src/testdir/dumps/Test_popupwin_menu_maxwidth_1.dump

Patch 8.1.1677
Problem:    Tests get stuck when running into an existing swapfile.
Solution:   Set v:swapchoice to "q" and report an error. (Daniel Hahler,
            closes #4644)
Files:	    src/testdir/runtest.vim

Patch 8.1.1678
Problem:    When using popup_menu() does not scroll to show the selected line.
Solution:   Scroll the text. (Naruhiko Nishino, closes #4651)
Files:	    src/popupwin.c, src/testdir/test_popupwin.vim,
            src/testdir/dumps/Test_popupwin_menu_scroll_1.dump,
            src/testdir/dumps/Test_popupwin_menu_scroll_2.dump,
            src/testdir/dumps/Test_popupwin_menu_scroll_3.dump,
            src/testdir/dumps/Test_popupwin_menu_scroll_4.dump,
            src/testdir/dumps/Test_popupwin_menu_scroll_5.dump,
            src/testdir/dumps/Test_popupwin_menu_scroll_6.dump

Patch 8.1.1679
Problem:    Test using SwapExists autocommand file may fail.
Solution:   Remove the SwapExists autocommand.
Files:	    src/testdir/test_window_cmd.vim

Patch 8.1.1680
Problem:    The command table is not well aligned.
Solution:   Adjust indent.
Files:	    src/ex_cmds.h

Patch 8.1.1681
Problem:    Insert stray "{" when listener gets buffer line. (Paul Jolly)
Solution:   Flush the cached line after invoking listeners. (closes #4455)
Files:	    src/memline.c, src/testdir/test_listener.vim

Patch 8.1.1682
Problem:    Placing a larger number of signs is slow.
Solution:   Add functions for dealing with a list of signs. (Yegappan
            Lakshmanan, closes #4636)
Files:	    runtime/doc/eval.txt, runtime/doc/usr_41.txt, src/evalfunc.c,
            src/proto/sign.pro, src/sign.c, src/testdir/test_signs.vim

Patch 8.1.1683
Problem:    Dictionary with string keys is longer than needed.
Solution:   Use *{key: val} for literal keys.
Files:	    runtime/doc/eval.txt, src/eval.c, src/dict.c, src/proto/dict.pro,
            src/testdir/test_listdict.vim, src/testdir/test_popupwin.vim,
            src/testdir/dumps/Test_popupwin_07.dump,
            src/testdir/dumps/Test_popupwin_mask_2.dump,
            src/testdir/dumps/Test_popupwin_mask_3.dump,
            src/testdir/dumps/Test_popupwin_mask_4.dump,
            src/testdir/dumps/Test_popupwin_mask_5.dump,
            src/testdir/dumps/Test_popupwin_scroll_2.dump,
            src/testdir/dumps/Test_popupwin_scroll_3.dump,
            src/testdir/dumps/Test_popupwin_scroll_4.dump

Patch 8.1.1684
Problem:    Profiling functionality is spread out.
Solution:   Put profiling functionality in profiler.c. (Yegappan Lakshmanan,
            closes #4666)
Files:	    Filelist, src/Make_cyg_ming.mak, src/Make_dice.mak,
            src/Make_manx.mak, src/Make_morph.mak, src/Make_mvc.mak,
            src/Make_sas.mak, src/Make_vms.mms, src/Makefile, src/README.md,
            src/ex_cmds2.c, src/globals.h, src/profiler.c, src/proto.h,
            src/proto/ex_cmds2.pro, src/proto/profiler.pro,
            src/proto/userfunc.pro, src/structs.h, src/userfunc.c

Patch 8.1.1685
Problem:    Missing file in distributed file list.
Solution:   Add profiler.pro
Files:	    Filelist

Patch 8.1.1686
Problem:    "*" of "*{" is recognized as multiply operator. (Yasuhiro
            Matsumoto)
Solution:   Check for the "{".
Files:	    src/eval.c, src/testdir/test_listdict.vim

Patch 8.1.1687
Problem:    The evalfunc.c file is too big.
Solution:   Move testing support to a separate file.
Files:	    Filelist, src/evalfunc.c, src/eval.c, src/proto/eval.pro,
            src/testing.c, src/proto/testing.pro, src/Make_cyg_ming.mak,
            src/Make_morph.mak, src/Make_mvc.mak, src/Make_vms.mms,
            src/Makefile, src/README.md, src/proto.h

Patch 8.1.1688
Problem:    Old makefiles are no longer useful.
Solution:   Delete the makefiles, they most likely don't work anyway.
Files:	    Filelist, src/Make_dice.mak, src/Make_manx.mak, src/Make_sas.mak

Patch 8.1.1689
Problem:    Profiling code is spread out.
Solution:   Move more profiling code to profiler.c. (Yegappan Lakshmanan,
            closes #4668)
Files:	    src/ex_cmds2.c, src/profiler.c, src/proto/ex_cmds2.pro,
            src/proto/profiler.pro, src/proto/userfunc.pro, src/structs.h,
            src/userfunc.c

Patch 8.1.1690
Problem:    Default padding for popup window menu is too much.
Solution:   Only add padding left and right.
Files:	    runtime/doc/popup.txt, src/popupwin.c,
            src/testdir/dumps/Test_popupwin_menu_01.dump,
            src/testdir/dumps/Test_popupwin_menu_02.dump,
            src/testdir/dumps/Test_popupwin_menu_maxwidth_1.dump,
            src/testdir/dumps/Test_popupwin_menu_scroll_1.dump,
            src/testdir/dumps/Test_popupwin_menu_scroll_2.dump,
            src/testdir/dumps/Test_popupwin_menu_scroll_3.dump,
            src/testdir/dumps/Test_popupwin_menu_scroll_4.dump,
            src/testdir/dumps/Test_popupwin_menu_scroll_5.dump,
            src/testdir/dumps/Test_popupwin_menu_scroll_6.dump

Patch 8.1.1691
Problem:    Diff test fails on some systems. (Elimar Riesebieter)
Solution:   Add a term_wait() call.
Files:	    src/testdir/test_diffmode.vim

Patch 8.1.1692
Problem:    Using *{} for literal dict is not backwards compatible. (Yasuhiro
            Matsumoto)
Solution:   Use ~{} instead.
Files:	    runtime/doc/eval.txt runtime/doc/popup.txt, src/eval.c,
            src/testdir/test_listdict.vim src/testdir/test_popupwin.vim,
            src/testdir/dumps/Test_popupwin_07.dump,
            src/testdir/dumps/Test_popupwin_mask_2.dump,
            src/testdir/dumps/Test_popupwin_mask_3.dump,
            src/testdir/dumps/Test_popupwin_mask_4.dump,
            src/testdir/dumps/Test_popupwin_mask_5.dump,
            src/testdir/dumps/Test_popupwin_scroll_2.dump,
            src/testdir/dumps/Test_popupwin_scroll_3.dump,
            src/testdir/dumps/Test_popupwin_scroll_4.dump

Patch 8.1.1693
Problem:    Syntax coloring and highlighting is in one big file.
Solution:   Move the highlighting to a separate file. (Yegappan Lakshmanan,
            closes #4674)
Files:	    Filelist, src/Make_cyg_ming.mak, src/Make_morph.mak,
            src/Make_mvc.mak, src/Make_vms.mms, src/Makefile, src/README.md,
            src/globals.h, src/highlight.c, src/proto.h,
            src/proto/highlight.pro, src/proto/syntax.pro, src/structs.h,
            src/syntax.c

Patch 8.1.1694
Problem:    The RUN_VIM variable is longer than needed.
Solution:   Shorten RUN_VIM. (Daniel Hahler, closes #4643)
Files:	    src/testdir/Makefile, src/testdir/shared.vim

Patch 8.1.1695
Problem:    Windows 10: crash when cursor is at bottom of terminal.
Solution:   Position the cursor before resizing. (Yasuhiro Matsumoto,
            closes #4679)
Files:	    src/os_win32.c

Patch 8.1.1696
Problem:    MSVC: link command line is too long.
Solution:   Use the @<< mechanism to pass the arguments via a file. (Christian
            Brabandt)
Files:	    src/Make_mvc.mak

Patch 8.1.1697
Problem:    Cannot build with MSVC.
Solution:   Remove the backslashes after the @<< mechanism.
Files:	    src/Make_mvc.mak

Patch 8.1.1698
Problem:    Appveyor build with MSVC fails.
Solution:   Remove the sed command
Files:	    ci/appveyor.bat

Patch 8.1.1699
Problem:    Highlight_ga can be local instead of global.
Solution:   Move highlight_ga into highlight.c. (Yegappan Lakshmanan,
            closes #4675)
Files:	    src/globals.h, src/highlight.c, src/proto/highlight.pro,
            src/structs.h, src/syntax.c

Patch 8.1.1700
Problem:    Listener callback called for the wrong buffer.
Solution:   Invoke listeners before calling ml_append_int().
Files:	    src/memline.c

Patch 8.1.1701
Problem:    Appveyor build with MSVC fails puts progress bar in log.
Solution:   Adjust the sed command. (Ken Takata)
Files:	    ci/appveyor.bat

Patch 8.1.1702
Problem:    Compiler warning for uninitialized variable.
Solution:   Initialize it. (Christian Brabandt)
Files:	    src/gui.c

Patch 8.1.1703
Problem:    Breaking out of loop by checking window pointer is insufficient.
Solution:   Check the window ID and the buffer number. (closes #4683)
Files:	    src/misc2.c

Patch 8.1.1704
Problem:    C-R C-W does not work after C-G when using 'incsearch'.
Solution:   Put cursor at end of the match. (Yasuhiro Matsumoto, closes #4664)
Files:	    src/ex_getln.c, src/testdir/test_search.vim

Patch 8.1.1705
Problem:    Using ~{} for a literal dict is not nice.
Solution:   Use #{} instead.
Files:	    runtime/doc/eval.txt runtime/doc/popup.txt, src/eval.c,
            src/testdir/test_listdict.vim src/testdir/test_popupwin.vim

Patch 8.1.1706
Problem:    Typo in #ifdef.
Solution:   Change PROT to PROTO.
Files:	    src/beval.c

Patch 8.1.1707
Problem:    Coverity warns for possibly using a NULL pointer.
Solution:   Change the logic to make sure no NULL pointer is used.
Files:	    src/popupwin.c, src/testdir/test_popupwin.vim

Patch 8.1.1708
Problem:    Coverity warns for using uninitialized variable.
Solution:   Set the start col when col is set.
Files:	    src/beval.c

Patch 8.1.1709
Problem:    Coverity warns for possibly using a NULL pointer.
Solution:   Make sure no NULL pointer is used.
Files:	    src/popupwin.c, src/testdir/test_popupwin.vim

Patch 8.1.1710
Problem:    Coverity found dead code.
Solution:   Remove merging of listener changes.
Files:	    src/change.c

Patch 8.1.1711
Problem:    Listener callback called at the wrong moment
Solution:   Invoke listeners before calling ml_delete_int(). (closes #4657)
Files:	    src/memline.c

Patch 8.1.1712
Problem:    Signs in number column cause text to be misaligned.
Solution:   Improve alignment. (Yasuhiro Matsumoto, closes #4694)
Files:	    src/screen.c, src/testdir/test_signs.vim

Patch 8.1.1713
Problem:    Highlighting cursor line only works with popup_menu().
Solution:   Add the "cursorline" property. (Naruhiko Nishino, closes #4671)
Files:	    runtime/doc/popup.txt, src/popupwin.c,
            src/testdir/dumps/Test_popupwin_cursorline_1.dump,
            src/testdir/dumps/Test_popupwin_cursorline_2.dump,
            src/testdir/dumps/Test_popupwin_cursorline_3.dump,
            src/testdir/dumps/Test_popupwin_cursorline_4.dump,
            src/testdir/dumps/Test_popupwin_cursorline_5.dump,
            src/testdir/dumps/Test_popupwin_cursorline_6.dump,
            src/testdir/dumps/Test_popupwin_menu_filter_1.dump,
            src/testdir/dumps/Test_popupwin_menu_filter_2.dump,
            src/testdir/dumps/Test_popupwin_menu_filter_3.dump,
            src/testdir/dumps/Test_popupwin_menu_filter_4.dump,
            src/testdir/test_popupwin.vim, src/vim.h

Patch 8.1.1714
Problem:    Cannot preview a file in a popup window.
Solution:   Add the 'previewpopup' option.
Files:	    runtime/doc/windows.txt, runtime/doc/options.txt, src/popupwin.c,
            src/proto/popupwin.pro, src/option.c, src/option.h, src/ex_cmds.c,
            src/testdir/dumps/Test_popupwin_previewpopup_1.dump,
            src/testdir/dumps/Test_popupwin_previewpopup_2.dump,
            src/ex_docmd.c, src/testdir/gen_opt_test.vim

Patch 8.1.1715
Problem:    Emoji characters are seen as word characters for spelling. (Gautam
            Iyer)
Solution:   Exclude class 3 from word characters.
Files:	    src/spell.c

Patch 8.1.1716
Problem:    Old style comments are wasting space
Solution:   Use new style comments in option header file. (closes #4702)
Files:	    src/option.h

Patch 8.1.1717
Problem:    Last char in menu popup window highlighted.
Solution:   Do not highlight an extra character twice.
Files:	    src/screen.c, src/testdir/test_popupwin.vim,
            src/testdir/dumps/Test_popupwin_menu_04.dump

Patch 8.1.1718
Problem:    Popup menu highlighting does not look good.
Solution:   Highlight the whole window line.  Fix that sign line HL is not
            displayed in a window with a background color.
Files:	    src/popupwin.c, src/sign.c, src/proto/sign.pro, src/screen.c,
            src/testdir/dumps/Test_popupwin_menu_scroll_1.dump,
            src/testdir/dumps/Test_popupwin_menu_scroll_2.dump,
            src/testdir/dumps/Test_popupwin_menu_scroll_3.dump,
            src/testdir/dumps/Test_popupwin_menu_scroll_4.dump,
            src/testdir/dumps/Test_popupwin_menu_scroll_5.dump,
            src/testdir/dumps/Test_popupwin_menu_scroll_6.dump,
            src/testdir/dumps/Test_popupwin_menu_01.dump,
            src/testdir/dumps/Test_popupwin_menu_02.dump,
            src/testdir/dumps/Test_popupwin_menu_04.dump

Patch 8.1.1719
Problem:    Popup too wide when 'showbreak' is set.
Solution:   Set window width when computing line length. (closes #4701)
Files:	    src/popupwin.c, src/testdir/test_popupwin.vim,
            src/testdir/dumps/Test_popupwin_showbreak.dump

Patch 8.1.1720
Problem:    Crash with very long %[] pattern. (Reza Mirzazade farkhani)
Solution:   Check for reg_toolong. (closes #4703)
Files:	    src/regexp.c, src/testdir/test_regexp_utf8.vim

Patch 8.1.1721
Problem:    Build failure with normal features without netbeans interface.
Solution:   Enable signs when using the text properties feature.
Files:	    src/feature.h

Patch 8.1.1722
Problem:    Error when scriptversion is 2 a making a dictionary access.
Solution:   Parse the subscript even when not evaluating the sub-expression.
            (closes #4704)
Files:	    src/eval.c, src/testdir/test_eval_stuff.vim

Patch 8.1.1723
Problem:    Heredoc assignment has no room for new features. (FUJIWARA Takuya)
Solution:   Require the marker does not start with a lower case character.
            (closes #4705)
Files:	    runtime/doc/eval.txt, src/eval.c, src/testdir/test_let.vim

Patch 8.1.1724
Problem:    Too much overhead checking for CTRL-C while processing text.
Solution:   Increase BREAKCHECK_SKIP.  Remove the difference for when built
            with the GUI. (suggested by Andy Massimino, closes #4708)
Files:	    src/misc1.c, src/screen.c, src/feature.h

Patch 8.1.1725
Problem:    MS-Windows: E325 message may use incorrect date format.
Solution:   Convert strftime() result to 'encoding'.  Also make the message
            translatable. (Ken Takata, closes #4685, closes #4681)
Files:	    src/memline.c

Patch 8.1.1726
Problem:    The eval.txt help file is too big.
Solution:   Split off testing support to testing.txt.  Move function details
            to where the functionality is explained.
Files:	    runtime/doc/Makefile, runtime/doc/eval.txt,
            runtime/doc/testing.txt, runtime/doc/sign.txt,
            runtime/doc/textprop.txt, runtime/doc/help.txt,
            runtime/doc/channel.txt, runtime/doc/tags

Patch 8.1.1727
Problem:    Code for viminfo support is spread out.
Solution:   Move to code to viminfo.c. (Yegappan Lakshmanan, closes #4686)
Files:	    Filelist, src/Make_cyg_ming.mak, src/Make_morph.mak,
            src/Make_mvc.mak, src/Make_vms.mms, src/Makefile, src/buffer.c,
            src/eval.c, src/ex_cmds.c, src/ex_docmd.c, src/globals.h,
            src/proto.h, src/proto/buffer.pro, src/proto/eval.pro,
            src/proto/ex_cmds.pro, src/proto/viminfo.pro, src/structs.h,
            src/viminfo.c

Patch 8.1.1728
Problem:    Wrong place for command line history viminfo support.
Solution:   Move it to viminfo.c.
Files:	    src/ex_getln.c, src/proto/ex_getln.pro, src/viminfo.c,
            src/structs.h

Patch 8.1.1729
Problem:    Heredoc with trim not properly handled in function.
Solution:   Allow for missing indent. (FUJIWARA Takuya, closes #4713)
Files:	    src/userfunc.c, src/testdir/test_let.vim

Patch 8.1.1730
Problem:    Wrong place for mark viminfo support.
Solution:   Move it to viminfo.c. (Yegappan Lakshmanan, closes #4716)
Files:	    src/README.md, src/mark.c, src/proto/mark.pro,
            src/proto/viminfo.pro, src/structs.h, src/viminfo.c

Patch 8.1.1731
Problem:    Command line history not read from viminfo on startup.
Solution:   Get history length after initializing it.
Files:	    src/viminfo.c, src/testdir/test_viminfo.vim

Patch 8.1.1732
Problem:    Completion in cmdwin does not work for buffer-local commands.
Solution:   Use the right buffer. (closes #4711)
Files:	    src/usercmd.c, src/testdir/test_ins_complete.vim

Patch 8.1.1733
Problem:    The man ftplugin leaves an empty buffer behind.
Solution:   Don't make new window and edit, use split. (Jason Franklin)
Files:	    runtime/ftplugin/man.vim, src/testdir/test_man.vim

Patch 8.1.1734
Problem:    The evalfunc.c file is too big.
Solution:   Move some functions to other files.
Files:	    src/evalfunc.c, src/proto/evalfunc.pro, src/json.c,
            src/proto/json.pro src/window.c, src/proto/window.pro,
            src/highlight.c, src/proto/highlight.pro, src/globals.h

Patch 8.1.1735 (after 8.1.1734)
Problem:    Can't build with tiny features.
Solution:   Add missing #ifdefs.
Files:	    src/json.c, src/highlight.c

Patch 8.1.1736
Problem:    Viminfo support is spread out.
Solution:   Move more viminfo code to viminfo.c. (Yegappan Lakshmanan,
            closes #4717)  Reorder code to make most functions static.
Files:	    src/fileio.c, src/ops.c, src/option.c, src/proto/ops.pro,
            src/proto/option.pro, src/proto/search.pro, src/proto/viminfo.pro,
            src/search.c, src/structs.h, src/viminfo.c, src/ex_cmds.c,
            src/proto/ex_cmds.pro

Patch 8.1.1737
Problem:    :args command that outputs one line gives more prompt.
Solution:   Only output line break if needed. (Daniel Hahler, closes #4715)
Files:	    src/version.c, src/testdir/test_arglist.vim

Patch 8.1.1738
Problem:    Testing lambda with timer is slow.
Solution:   Do not test timer accuracy, only that it works. (Daniel Hahler,
            closes #4723)
Files:	    src/testdir/test_lambda.vim

Patch 8.1.1739
Problem:    Deleted match highlighting not updated in other window.
Solution:   Mark the window for refresh. (closes #4720)  Also fix that
            ambi-width check clears with wrong attributes.
Files:	    src/term.c, src/highlight.c, src/testdir/test_match.vim,
            src/testdir/dumps/Test_matchdelete_1.dump

Patch 8.1.1740
Problem:    Exepath() doesn't work for "bin/cat".
Solution:   Check for any path separator. (Daniel Hahler, closes #4724,
            closes #4710)
Files:	    src/evalfunc.c, src/os_unix.c, src/testdir/test_functions.vim

Patch 8.1.1741
Problem:    Cleared/added match highlighting not updated in other window.
            (Andy Massimino)
Solution:   Mark the right window for refresh.
Files:	    src/highlight.c, src/testdir/test_match.vim,
            src/testdir/dumps/Test_matchclear_1.dump,
            src/testdir/dumps/Test_matchadd_1.dump

Patch 8.1.1742
Problem:    Still some match functions in evalfunc.c.
Solution:   Move them to highlight.c.
Files:	    src/evalfunc.c, src/highlight.c, src/proto/highlight.pro,
            src/ex_docmd.c

Patch 8.1.1743
Problem:    'hlsearch' and match highlighting in the wrong place.
Solution:   Move highlighting from inside screen functions to highlight.c.
Files:	    src/screen.c, src/highlight.c, src/proto/highlight.pro

Patch 8.1.1744
Problem:    Build error without the conceal feature.
Solution:   Define variables also without the conceal feature.
Files:	    src/screen.c

Patch 8.1.1745
Problem:    Compiler warning for unused argument.
Solution:   Add UNUSED.  Change comments to new style.
Files:	    src/highlight.c

Patch 8.1.1746
Problem:    ":dl" is seen as ":dlist" instead of ":delete".
Solution:   Do not use cmdidxs2[] if the length is 1. (closes #4721)
Files:	    src/ex_docmd.c, src/testdir/test_excmd.vim,
            src/testdir/Make_all.mak

Patch 8.1.1747
Problem:    Compiler warning for unused variables. (Tony Mechelynck)
Solution:   Add #ifdef.
Files:	    src/screen.c

Patch 8.1.1748 (after 8.1.1737)
Problem:    :args output is not aligned.
Solution:   Output a line break after the last item in a row.
Files:	    src/version.c

Patch 8.1.1749
Problem:    Coverity warns for using negative index.
Solution:   Move using index inside "if".
Files:	    src/viminfo.c

Patch 8.1.1750
Problem:    Depending on the terminal width :version may miss a line break.
Solution:   Add a line break when needed.
Files:	    src/version.c

Patch 8.1.1751
Problem:    When redrawing popups plines_win() may be called often.
Solution:   Pass a cache to mouse_comp_pos().
Files:	    src/ui.c, src/proto/ui.pro, src/beval.c, src/evalfunc.c,
            src/popupwin.c

Patch 8.1.1752
Problem:    Resizing hashtable is inefficient.
Solution:   Avoid resizing when the final size is predictable.
Files:	    src/hashtab.c, src/proto/hashtab.pro, src/popupwin.c

Patch 8.1.1753
Problem:    Use of popup window mask is inefficient.
Solution:   Precompute and cache the mask.
Files:	    src/popupwin.c

Patch 8.1.1754 (after 8.1.1753)
Problem:    Build failure.
Solution:   Add missing change to window struct.
Files:	    src/structs.h

Patch 8.1.1755
Problem:    Leaking memory when using a popup window mask.
Solution:   Free the cached mask.
Files:	    src/window.c

Patch 8.1.1756
Problem:    Autocommand that splits window messes up window layout.
Solution:   Disallow splitting a window while closing one.  In ":all" give an
            error when moving a window will not work.
Files:	    src/buffer.c, src/window.c, src/testdir/test_window_cmd.vim

Patch 8.1.1757
Problem:    Text added with appendbufline() to another buffer isn't displayed.
Solution:   Update topline. (partly by Christian Brabandt, closes #4718)
Files:	    src/evalfunc.c, src/testdir/test_bufline.vim,
            src/testdir/dumps/Test_appendbufline_1.dump

Patch 8.1.1758
Problem:    Count of g$ not used correctly when text is not wrapped.
Solution:   Do use the count. (Christian Brabandt, closes #4729, closes #4566)
Files:	    src/normal.c, src/testdir/test_normal.vim

Patch 8.1.1759
Problem:    No mode char for terminal mapping from maparg().
Solution:   Check for TERMINAL mode. (closes #4735)
Files:	    src/getchar.c, src/testdir/test_maparg.vim

Patch 8.1.1760
Problem:    Extra line break for wrapping output of :args.
Solution:   Avoid the extra line break. (Daniel Hahler, closes #4737)
Files:	    src/version.c, src/testdir/test_arglist.vim

Patch 8.1.1761
Problem:    Filetype "vuejs" causes problems for some users.
Solution:   Rename to "vue".
Files:	    runtime/filetype.vim, src/testdir/test_filetype.vim

Patch 8.1.1762
Problem:    Some filetype rules are in the wrong place.
Solution:   Move to the right place.  Add a few more tests.
Files:	    runtime/filetype.vim, src/testdir/test_filetype.vim

Patch 8.1.1763
Problem:    Evalfunc.c is still too big.
Solution:   Move dict and list functions to a better place.
Files:	    src/evalfunc.c, src/dict.c, src/proto/dict.pro, src/list.c,
            src/proto/list.pro, src/blob.c, src/proto/blob.pro

Patch 8.1.1764
Problem:    ":browse oldfiles" is not tested.
Solution:   Add a test.
Files:	    src/testdir/test_viminfo.vim

Patch 8.1.1765
Problem:    get(func, dict, def) does not work properly.
Solution:   Handle NULL dict better. (Takuya Fujiwara, closes #4734)
Files:	    src/evalfunc.c, src/testdir/test_getvar.vim,
            src/testdir/test_partial.vim

Patch 8.1.1766
Problem:    Code for writing session file is spread out.
Solution:   Put it in one file. (Yegappan Lakshmanan, closes #4728)
Files:	    Filelist, src/Make_cyg_ming.mak, src/Make_morph.mak,
            src/Make_mvc.mak, src/Make_vms.mms, src/Makefile, src/README.md,
            src/eval.c, src/ex_docmd.c, src/misc2.c, src/proto.h,
            src/proto/eval.pro, src/proto/misc2.pro, src/proto/session.pro,
            src/session.c

Patch 8.1.1767
Problem:    FEAT_SESSION defined separately.
Solution:   Make FEAT_SESSION depend on FEAT_EVAL.
Files:	    src/feature.h, src/session.c, src/evalfunc.c, src/ex_docmd.c,
            src/gui_gtk_x11.c, src/proto.h

Patch 8.1.1768
Problem:    Man plugin changes setting in current window.
Solution:   Set options later. (Jason Franklin)
Files:	    runtime/ftplugin/man.vim, src/testdir/test_man.vim

Patch 8.1.1769
Problem:    'shellslash' is also used for completion.
Solution:   Add the 'completeslash' option. (Yasuhiro Matsumoto, closes #3612)
Files:	    runtime/doc/options.txt, src/ex_getln.c, src/insexpand.c,
            src/option.c, src/option.h, src/structs.h,
            src/testdir/test_ins_complete.vim

Patch 8.1.1770
Problem:    Cannot get the window ID of the popup preview window.
Solution:   Add popup_getpreview().
Files:	    src/evalfunc.c, src/popupwin.c, src/proto/popupwin.pro,
            runtime/doc/eval.txt, runtime/doc/popup.txt,
            src/testdir/dumps/Test_popupwin_previewpopup_3.dump

Patch 8.1.1771
Problem:    Options test fails on MS-Windows.
Solution:   Add correct and incorrect values for 'completeslash'.
Files:	    src/testdir/gen_opt_test.vim

Patch 8.1.1772
Problem:    Options test still fails on MS-Windows.
Solution:   Check buffer-local value of 'completeslash'.
Files:	    src/option.c

Patch 8.1.1773
Problem:    The preview popup window may be too far to the right.
Solution:   Keep it inside the screen.  Also keep the close button and
            scrollbar visible if possible.
Files:	    src/popupwin.c, src/proto/popupwin.pro, src/ex_cmds.c,
            src/screen.c, src/vim.h, src/testdir/test_popupwin.vim,
            src/testdir/dumps/Test_popupwin_previewpopup_1.dump,
            src/testdir/dumps/Test_popupwin_previewpopup_2.dump,
            src/testdir/dumps/Test_popupwin_previewpopup_3.dump,
            src/testdir/dumps/Test_popupwin_previewpopup_4.dump

Patch 8.1.1774
Problem:    Test is silently skipped.
Solution:   Throw "Skipped".
Files:	    src/testdir/test_ins_complete.vim

Patch 8.1.1775
Problem:    Error message may be empty in filetype test.
Solution:   Use v:exception instead. (Daniel Hahler, closes #4744)
Files:	    src/testdir/test_filetype.vim

Patch 8.1.1776
Problem:    Text added with a job to another buffer isn't displayed.
Solution:   Update topline after adding a line. (closes #4745)
Files:	    src/channel.c, src/testdir/test_channel.vim, src/testdir/check.vim,
            src/testdir/dumps/Test_job_buffer_scroll_1.dump

Patch 8.1.1777
Problem:    Useless checks for job feature in channel test.
Solution:   Remove the checks.  Remove ch_log() calls.
Files:	    src/testdir/test_channel.vim

Patch 8.1.1778
Problem:    Not showing the popup window right border is confusing.
Solution:   Also show the border when there is no close button. (closes #4747)
Files:	    src/popupwin.c, src/testdir/dumps/Test_popupwin_20.dump,
            src/testdir/dumps/Test_popupwin_21.dump

Patch 8.1.1779
Problem:    Not showing the popup window right border is confusing.
Solution:   Also show the border when 'wrap' is off. (closes #4747)
Files:	    src/popupwin.c, src/testdir/dumps/Test_popupwin_20.dump,
            src/testdir/dumps/Test_popupwin_21.dump

Patch 8.1.1780
Problem:    Warning for file no longer available is repeated every time Vim is
            focused. (Brian Armstrong)
Solution:   Only give the message once. (closes #4748)
Files:	    src/fileio.c

Patch 8.1.1781
Problem:    Amiga: no builtin OS readable version info.
Solution:   Add a "version" variable. (Ola Söder, closes #4753)
Files:	    src/os_amiga.c

Patch 8.1.1782
Problem:    MS-Windows: system() has temp file error with 'noshelltemp'.
Solution:   Check s_dont_use_vimrun. (Ken Takata, closes #4754)
Files:	    src/os_win32.c

Patch 8.1.1783
Problem:    MS-Windows: compiler test may fail when using %:S.
Solution:   Reset 'shellslash'.
Files:	    src/testdir/test_compiler.vim

Patch 8.1.1784
Problem:    MS-Windows: resolve() does not work if serial nr duplicated.
Solution:   Use another method to get the full path. (Ken Takata, closes #4661)
Files:	    src/os_mswin.c

Patch 8.1.1785
Problem:    Map functionality mixed with character input.
Solution:   Move the map functionality to a separate file. (Yegappan
            Lakshmanan, closes #4740)  Graduate the +localmap feature.
Files:	    Filelist, src/Make_cyg_ming.mak, src/Make_morph.mak,
            src/Make_mvc.mak, src/Make_vms.mms, src/Makefile, src/README.md,
            src/buffer.c, src/feature.h, src/evalfunc.c, src/ex_docmd.c,
            src/getchar.c, src/map.c, src/proto.h, src/proto/getchar.pro,
            src/proto/map.pro, src/version.c, src/structs.h

Patch 8.1.1786
Problem:    Double click in popup scrollbar starts selection.
Solution:   Ignore the double click.
Files:	    src/ui.c, src/popupwin.c, src/proto/popupwin.pro

Patch 8.1.1787
Problem:    Cannot resize a popup window.
Solution:   Allow for resizing by dragging the lower right corner.
Files:	    runtime/doc/popup.txt, src/popupwin.c, src/structs.h, src/vim.h,
            src/ui.c src/testdir/test_popupwin.vim,
            src/testdir/dumps/Test_popupwin_drag_01.dump,
            src/testdir/dumps/Test_popupwin_drag_02.dump,
            src/testdir/dumps/Test_popupwin_drag_03.dump,
            src/testdir/dumps/Test_popupwin_previewpopup_1.dump,
            src/testdir/dumps/Test_popupwin_previewpopup_2.dump,
            src/testdir/dumps/Test_popupwin_previewpopup_3.dump,
            src/testdir/dumps/Test_popupwin_previewpopup_4.dump

Patch 8.1.1788 (after 8.1.1787)
Problem:    missing changes in proto file
Solution:   Update proto file.
Files:	    src/proto/popupwin.pro

Patch 8.1.1789
Problem:    Cannot see file name of preview popup window.
Solution:   Add the file name as the title.
Files:	    src/ex_cmds.c, src/popupwin.c, src/proto/popupwin.pro,
            src/fileio.c,
            src/testdir/dumps/Test_popupwin_previewpopup_1.dump,
            src/testdir/dumps/Test_popupwin_previewpopup_2.dump,
            src/testdir/dumps/Test_popupwin_previewpopup_3.dump,
            src/testdir/dumps/Test_popupwin_previewpopup_4.dump,
            src/testdir/dumps/Test_popupwin_previewpopup_5.dump

Patch 8.1.1790
Problem:    :mkvimrc is not tested.
Solution:   Add a test.
Files:	    src/testdir/test_mksession.vim

Patch 8.1.1791
Problem:    'completeslash' also applies to globpath().
Solution:   Add the WILD_IGNORE_COMPLETESLASH flag. (test by Yasuhiro
            Matsumoto, closes #4760)
Files:	    src/testdir/test_ins_complete.vim, src/ex_getln.c, src/evalfunc.c,
            src/vim.h

Patch 8.1.1792
Problem:    The vgetorpeek() function is too long.
Solution:   Split off the part that handles mappings.
Files:	    src/getchar.c

Patch 8.1.1793
Problem:    Mixed comment style in globals.
Solution:   Use // comments where appropriate.
Files:	    src/globals.h

Patch 8.1.1794 (after 8.1.1792)
Problem:    Tests are flaky.
Solution:   Undo the change to vgetorpeek().
Files:	    src/getchar.c

Patch 8.1.1795
Problem:    No syntax HL after splitting windows with :bufdo. (Yasuhiro
            Matsumoto)
Solution:   Trigger Syntax autocommands in buffers that are active.
            (closes #4761)
Files:	    src/vim.h, src/option.c, src/ex_cmds2.c,
            src/testdir/test_syntax.vim

Patch 8.1.1796
Problem:    :argdo is not tested
Solution:   Add a test.
Files:	    src/testdir/test_arglist.vim

Patch 8.1.1797 (after 8.1.1794)
Problem:    The vgetorpeek() function is too long.
Solution:   Split off the part that handles mappings, with fix.
Files:	    src/getchar.c

Patch 8.1.1798
Problem:    Warning for unused variable in tiny version. (Tony Mechelynck)
Solution:   Move inside #ifdef.  Reformat code.
Files:	    src/getchar.c

Patch 8.1.1799
Problem:    Cannot avoid mapping for a popup window.
Solution:   Add the "mapping" property, default TRUE.
Files:	    runtime/doc/popup.txt, src/getchar.c, src/popupwin.c, src/vim.h,
            src/proto/popupwin.pro, src/testdir/test_popupwin.vim

Patch 8.1.1800
Problem:    Function call functions have too many arguments.
Solution:   Pass values in a funcexe_T struct.
Files:	    src/eval.c, src/structs.h, src/userfunc.c, src/proto/userfunc.pro,
            src/list.c, src/regexp.c, src/terminal.c, src/change.c,
            src/ex_cmds2.c, src/popupwin.c, src/channel.c

Patch 8.1.1801
Problem:    Cannot build without the +eval feature.
Solution:   Always define funcexe_T.
Files:	    src/structs.h

Patch 8.1.1802
Problem:    Missing change to call_callback().
Solution:   Add missing change.
Files:	    src/sound.c

Patch 8.1.1803
Problem:    All builtin functions are global.
Solution:   Add the method call operator ->.  Implemented for a limited number
            of functions.
Files:	    runtime/doc/eval.txt, src/eval.c, src/structs.h, src/userfunc.c,
            src/globals.h, src/evalfunc.c, src/proto/evalfunc.pro,
            src/testdir/test_method.vim, src/testdir/Make_all.mak

Patch 8.1.1804
Problem:    No test for display updating without a scroll region.
Solution:   Add a test.
Files:	    src/testdir/test_display.vim, src/testdir/check.vim,
            src/testdir/test_diffmode.vim,
            src/testdir/dumps/Test_scroll_no_region_1.dump,
            src/testdir/dumps/Test_scroll_no_region_2.dump,
            src/testdir/dumps/Test_scroll_no_region_3.dump

Patch 8.1.1805
Problem:    Au_did_filetype is declared twice.
Solution:   Remove it from autocmd.c. (closes #4767)
Files:	    src/globals.h, src/autocmd.c

Patch 8.1.1806
Problem:    Test for display updating doesn't check without statusline.
Solution:   Add screenshots without a status line.
Files:	    src/testdir/test_display.vim,
            src/testdir/dumps/Test_scroll_no_region_4.dump,
            src/testdir/dumps/Test_scroll_no_region_5.dump,
            src/testdir/dumps/Test_scroll_no_region_6.dump

Patch 8.1.1807
Problem:    More functions can be used as a method.
Solution:   Add append(), appendbufline(), assert_equal(), etc.
            Also add the :eval command.
Files:	    runtime/doc/eval.txt, runtime/doc/testing.txt, src/evalfunc.c,
            src/testdir/test_method.vim, src/ex_cmds.h, src/ex_eval.c,
            src/proto/ex_eval.pro, src/ex_cmdidxs.h

Patch 8.1.1808
Problem:    Build failure for tiny version.
Solution:   Define ex_eval to ex_ni.  Clean up the ordering a bit.
Files:	    src/ex_docmd.c

Patch 8.1.1809
Problem:    More functions can be used as a method.
Solution:   Add has_key(), split(), str2list(), etc.
Files:	    runtime/doc/eval.txt, src/evalfunc.c, src/testdir/test_method.vim,
            src/testdir/test_diffmode.vim, src/testdir/test_syntax.vim,
            src/testdir/test_system.vim

Patch 8.1.1810
Problem:    Popup_getoptions() is missing an entry for "mapping".
Solution:   Add the entry.
Files:	    src/popupwin.c, src/testdir/test_popupwin.vim

Patch 8.1.1811
Problem:    Popup window color cannot be set to "Normal".
Solution:   Check for non-empty 'wincolor' instead of zero attribute.
            (closes #4772)
Files:	    src/screen.c, src/testdir/test_popupwin.vim,
            src/testdir/dumps/Test_popupwin_20.dump,
            src/testdir/dumps/Test_popupwin_21.dump

Patch 8.1.1812
Problem:    Reading a truncated undo file hangs Vim.
Solution:   Check for reading EOF. (closes #4769)
Files:	    src/undo.c, src/testdir/test_undo.vim

Patch 8.1.1813
Problem:    ATTENTION prompt for a preview popup window.
Solution:   Close the popup window if aborting the buffer load.  Avoid getting
            the ATTENTION dialog.
Files:	    src/tag.c, src/ex_cmds.c, src/memline.c, src/vim.h,
            runtime/doc/windows.txt

Patch 8.1.1814
Problem:    A long title in a popup window overflows.
Solution:   Truncate the title. (closes #4770)
Files:	    src/testdir/test_popupwin.vim, src/popupwin.c,
            src/testdir/dumps/Test_popupwin_longtitle_1.dump,
            src/testdir/dumps/Test_popupwin_longtitle_2.dump

Patch 8.1.1815
Problem:    Duplicating info for internal functions.
Solution:   Use one table to list internal functions.
Files:	    src/evalfunc.c

Patch 8.1.1816
Problem:    Cannot use a user defined function as a method.
Solution:   Pass the base as the first argument to the user defined function
            after "->". (partly by FUJIWARA Takuya)
Files:	    src/eval.c, src/userfunc.c, src/testdir/test_user_func.vim,
            src/testdir/test_autoload.vim,
            src/testdir/sautest/autoload/foo.vim

Patch 8.1.1817
Problem:    Github contribution text is incomplete.
Solution:   Update the text.
Files:	    CONTRIBUTING.md

Patch 8.1.1818
Problem:    Unused variable.
Solution:   Remove the variable. (Mike Williams)
Files:	    src/sound.c

Patch 8.1.1819
Problem:    :pedit does not work with a popup preview window.
Solution:   Avoid aborting with an error. (fixes #4777)  Also double check
            that after prepare_tagpreview() the current window is not a
            popup window.
Files:	    src/ex_docmd.c, src/popupmenu.c, src/search.c, src/tag.c,
            src/testdir/test_popupwin.vim,
            src/testdir/dumps/Test_popupwin_previewpopup_6.dump,
            src/testdir/dumps/Test_popupwin_previewpopup_7.dump,
            src/testdir/dumps/Test_popupwin_previewpopup_8.dump

Patch 8.1.1820
Problem:    Using expr->FuncRef() does not work.
Solution:   Make FuncRef work as a method.
Files:	    src/eval.c, src/userfunc.c, src/testdir/test_method.vim

Patch 8.1.1821
Problem:    No test for wrong number of method arguments.
Solution:   Add a test.
Files:	    src/testdir/test_method.vim

Patch 8.1.1822
Problem:    Confusing error message when range is not allowed.
Solution:   With ADDR_NONE give e_norange.  Change e_invaddr to e_invrange for
            consistency.
Files:	    src/ex_docmd.c, src/globals.h, src/testdir/test_excmd.vim
