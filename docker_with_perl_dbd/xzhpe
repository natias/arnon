Solution:   Simplify the macros.  Expand inline.
Files:	    src/macros.h, src/beval.c, src/diff.c src/eval.c src/evalfunc.c
            src/ex_getln.c, src/filepath.c, src/findfile.c, src/getchar.c,
            src/highlight.c, src/ops.c, src/os_mswin.c, src/popupmenu.c,
            src/search.c, src/spell.c, src/spellsuggest.c, src/terminal.c

Patch 8.1.2121
Problem:    Mode is not updated when switching to terminal in Insert mode.
Solution:   Redraw the mode when entering a terminal window. (Jason Franklin)
Files:	    src/window.c, src/testdir/test_window_cmd.vim

Patch 8.1.2122 (after 8.1.2121)
Problem:    Cannot build without terminal feature.
Solution:   Add #ifdef.
Files:	    src/window.c

Patch 8.1.2123
Problem:    Parsing CSI sequence is messy.
Solution:   Generalize parsing a CSI sequence.
Files:	    src/term.c

Patch 8.1.2124
Problem:    Ruler is not updated if win_execute() moves cursor.
Solution:   Update the status line. (closes #5022)
Files:	    src/evalwindow.c, src/testdir/test_execute_func.vim

Patch 8.1.2125
Problem:    Fnamemodify() fails when repeating :e.
Solution:   Do not go before the tail. (Rob Pilling, closes #5024)
Files:	    src/filepath.c, src/testdir/test_fnamemodify.vim

Patch 8.1.2126
Problem:    Viminfo not sufficiently tested.
Solution:   Add more test cases.  Clean up comments. (Yegappan Lakshmanan,
            closes #5032)
Files:	    src/search.c, src/structs.h, src/testdir/test_viminfo.vim,
            src/viminfo.c

Patch 8.1.2127
Problem:    The indent.c file is a bit big.
Solution:   Move C-indent code to a new cindent.c file.  Move other
            indent-related code to indent.c. (Yegappan Lakshmanan,
            closes #5031)
Files:	    Filelist, src/Make_cyg_ming.mak, src/Make_morph.mak,
            src/Make_mvc.mak, src/Make_vms.mms, src/Makefile, src/README.md,
            src/change.c, src/cindent.c, src/edit.c, src/evalfunc.c,
            src/ex_cmds.c, src/globals.h, src/indent.c, src/misc1.c,
            src/ops.c, src/proto.h, src/proto/cindent.pro, src/proto/edit.pro,
            src/proto/ex_cmds.pro, src/proto/indent.pro, src/proto/misc1.pro,
            src/proto/ops.pro, src/userfunc.c

Patch 8.1.2128
Problem:    Renamed libvterm sources makes merging difficult.
Solution:   Rename back to the original name and only rename the .o files.
            Also clean the libvterm build artifacts. (James McCoy,
            closes #5027)
Files:	    src/libvterm/src/termmouse.c, src/libvterm/src/mouse.c,
	    src/libvterm/src/termscreen.c, src/libvterm/src/screen.c,
            src/Makefile, src/configure.ac, src/auto/configure,
            src/Make_cyg_ming.mak, src/Make_mvc.mak

Patch 8.1.2129
Problem:    Using hard coded executable path in test.
Solution:   Use v:progpath. Use $VIMRUNTIME instead of "runtime". (James
            McCoy, closes #5025)
Files:	    src/testdir/test49.vim, src/testdir/test_compiler.vim,
            src/testdir/test_spell.vim

Patch 8.1.2130 (after 8.1.2128)
Problem:    MSVC build fails.
Solution:   Add the source file name explicitly.
Files:	    src/Make_mvc.mak

Patch 8.1.2131 (after 8.1.2129)
Problem:    MSVC tests fail.
Solution:   Replace backslashes with slashes.
Files:	    src/testdir/test_compiler.vim, src/testdir/test_spell.vim

Patch 8.1.2132
Problem:    MS-Windows: screen mess when not recognizing insider build.
Solution:   Always move the cursor to the first column first. (Nobuhiro
            Takasaki, closes #5036)
Files:	    src/os_win32.c

Patch 8.1.2133
Problem:    Some tests fail when run as root.
Solution:   Add CheckNotRoot and use it. (James McCoy, closes #5020)
Files:	    src/testdir/check.vim, src/testdir/shared.vim,
            src/testdir/test_rename.vim, src/testdir/test_swap.vim,
            src/testdir/test_terminal.vim, src/testdir/test_viminfo.vim

Patch 8.1.2134
Problem:    Modifier keys are not always recognized.
Solution:   Handle key codes generated by xterm with modifyOtherKeys set.
            Add this to libvterm so we can debug it.
Files:	    src/term.c, src/getchar.c, src/libvterm/src/vterm_internal.h,
            src/libvterm/src/state.c, src/libvterm/src/keyboard.c,
            src/libvterm/include/vterm.h, src/globals.h, src/terminal.c

Patch 8.1.2135
Problem:    With modifyOtherKeys Alt-a does not work properly.
Solution:   Remove the ALT modifier.  Get multibyte after applying ALT.
Files:	    src/getchar.c

Patch 8.1.2136
Problem:    using freed memory with autocmd from fuzzer. (Dhiraj Mishra,
            Dominique Pelle)
Solution:   Avoid using "wp" after autocommands. (closes #5041)
Files:	    src/window.c, src/testdir/test_autocmd.vim

Patch 8.1.2137
Problem:    Parsing the termresponse is not tested.
Solution:   Add a first test. (related to #5042)
Files:	    src/testdir/test_termcodes.vim

Patch 8.1.2138
Problem:    Including the build number in the Win32 binary is confusing.
Solution:   Only use the patchlevel.
Files:	    src/vim.rc

Patch 8.1.2139
Problem:    The modifyOtherKeys codes are not tested.
Solution:   Add a test case.
Files:	    src/testdir/test_termcodes.vim

Patch 8.1.2140
Problem:    "gk" and "gj" do not work correctly in number column.
Solution:   Allow for a negative "curswant". (Zach Wegner, closes #4969)
Files:	    src/testdir/test_normal.vim, src/misc2.c, src/normal.c

Patch 8.1.2141
Problem:    :tselect has an extra hit-enter prompt.
Solution:   Do not set need_wait_return when only moving the cursor.
            (closes #5040)
Files:	    src/message.c, src/testdir/test_tagjump.vim,
            src/testdir/dumps/Test_tselect_1.dump

Patch 8.1.2142
Problem:    Some key mappings do not work with modifyOtherKeys.
Solution:   Remove the Shift modifier if it is already included in the key.
Files:	    src/term.c, src/testdir/test_termcodes.vim

Patch 8.1.2143
Problem:    Cannot see each command even when 'verbose' is set.
Solution:   List each command when 'verbose' is at least 16.
Files:	    src/ex_docmd.c src/testdir/test_tagjump.vim,
            src/testdir/test_cmdline.vim,
            src/testdir/dumps/Test_verbose_option_1.dump

Patch 8.1.2144
Problem:    Side effects when using t_ti to enable modifyOtherKeys.
Solution:   Add t_TI and t_TE.
Files:	    runtime/doc/term.txt, src/term.c, src/optiondefs.h, src/term.h,

Patch 8.1.2145
Problem:    Cannot map <C-H> when modifyOtherKeys is enabled.
Solution:   Add the <C-H> mapping twice, both with modifier and as 0x08.  Use
            only the first one when modifyOtherKeys has been detected.
Files:	    src/term.c, src/eval.c, src/getchar.c, src/globals.h,
            src/gui_mac.c, src/gui_w32.c, src/highlight.c, src/if_ole.cpp,
            src/main.c, src/map.c, src/menu.c, src/misc2.c, src/option.c,
            src/proto/misc2.pro, src/proto/term.pro,
            src/testdir/test_termcodes.vim, src/structs.h, src/terminal.c,
            src/usercmd.c, src/vim.h

Patch 8.1.2146 (after 8.1.2145)
Problem:    Build failure.
Solution:   Include omitted changed file.
Files:	    src/optionstr.c

Patch 8.1.2147
Problem:    Crash when allocating memory fails. (Zu-Ming Jiang)
Solution:   Check that 'spellcapcheck' is not NULL. (closes #5048)
Files:	    src/spell.c

Patch 8.1.2148
Problem:    No test for right click extending Visual area.
Solution:   Add a test. (Dominique Pelle, closes #5018)
Files:	    src/testdir/test_termcodes.vim

Patch 8.1.2149
Problem:    Crash when running out of memory very early.
Solution:   Do not use IObuff when it's NULL. (closes #5052)
Files:	    src/message.c

Patch 8.1.2150
Problem:    No test for 'ttymouse' set from xterm version response.
Solution:   Test the three possible values.
Files:	    src/testdir/test_termcodes.vim

Patch 8.1.2151
Problem:    State test is a bit flaky.
Solution:   Add to the list of flaky tests.
Files:	    src/testdir/runtest.vim

Patch 8.1.2152
Problem:    Problems navigating tags file on macOS Catalina.
Solution:   Use fseek instead of lseek. (John Lamb, fixes #5061)
Files:	    src/tag.c

Patch 8.1.2153
Problem:    Combining text property and syntax highlight is wrong. (Nick
            Jensen)
Solution:   Compute the syntax highlight attribute much earlier.
            (closes #5057)
Files:	    src/drawline.c, src/testdir/test_textprop.vim,
            src/testdir/dumps/Test_textprop_syn_1.dump

Patch 8.1.2154
Problem:    Quickfix window height wrong when there is a tabline. (Daniel
            Hahler)
Solution:   Take the tabline height into account. (closes #5058)
Files:	    src/quickfix.c, src/testdir/test_quickfix.vim

Patch 8.1.2155
Problem:    In a terminal window 'cursorlineopt' does not work properly.
Solution:   Check the 'cursorlineopt' value. (closes #5055)
Files:	    src/drawline.c, src/testdir/test_terminal.vim,
            src/testdir/dumps/Test_terminal_normal_1.dump,
            src/testdir/dumps/Test_terminal_normal_2.dump,
            src/testdir/dumps/Test_terminal_normal_3.dump

Patch 8.1.2156
Problem:    First character after Tab is not highlighted.
Solution:   Remember the syntax attribute for a column.
Files:	    src/drawline.c, src/testdir/test_syntax.vim,
            src/testdir/dumps/Test_syntax_c_01.dump

Patch 8.1.2157
Problem:    Libvterm source files missing from distribution.
Solution:   Rename source files. (closes #5065)
Files:	    Filelist

Patch 8.1.2158
Problem:    Terminal attributes missing in Terminal-normal mode.
Solution:   Use "syntax_attr".
Files:	    src/drawline.c, src/testdir/test_terminal.vim,
            src/testdir/dumps/Test_terminal_dumpload.dump

Patch 8.1.2159
Problem:    Some mappings are listed twice.
Solution:   Skip mappings duplicated for modifyOtherKeys. (closes #5064)
Files:	    src/map.c, src/testdir/test_mapping.vim

Patch 8.1.2160
Problem:    Cannot build with +syntax but without +terminal.
Solution:   Add #ifdef.
Files:	    src/drawline.c

Patch 8.1.2161
Problem:    Mapping test fails.
Solution:   Run the test separately.
Files:	    src/testdir/Make_all.mak, src/testdir/test_alot.vim

Patch 8.1.2162
Problem:    Popup resize test is flaky. (Christian Brabandt)
Solution:   Add the function to the list of flaky tests.
Files:	    src/testdir/runtest.vim

Patch 8.1.2163
Problem:    Cannot build with +spell but without +syntax.
Solution:   Add #ifdef. (John Marriott)
Files:	    src/drawline.c

Patch 8.1.2164
Problem:    Stuck when using "j" in a popupwin with popup_filter_menu if a
            line wraps.
Solution:   Check the cursor line is visible. (closes #4577)
Files:	    src/popupwin.c, src/testdir/test_popupwin.vim,
            src/testdir/dumps/Test_popupwin_wrap_1.dump,
            src/testdir/dumps/Test_popupwin_wrap_2.dump

Patch 8.1.2165
Problem:    Mapping test fails on Mac.
Solution:   Remove the default Mac mapping.
Files:	    src/testdir/test_mapping.vim

Patch 8.1.2166
Problem:    Rubyeval() not tested as a method.
Solution:   Change a test case.
Files:	    src/testdir/test_ruby.vim

Patch 8.1.2167
Problem:    Mapping test fails on MS-Windows.
Solution:   Remove all the existing Insert-mode mappings.
Files:	    src/testdir/test_mapping.vim

Patch 8.1.2168
Problem:    Heredoc assignment not skipped in if block.
Solution:   Check if "skip" is set. (closes #5063)
Files:	    src/evalvars.c, src/testdir/test_let.vim

Patch 8.1.2169
Problem:    Terminal flags are never reset.
Solution:   Reset the flags when setting 'term'.
Files:	    src/term.c, src/testdir/test_termcodes.vim

Patch 8.1.2170 (after 8.1.2169)
Problem:    Cannot build without the +termresponse feature.
Solution:   Add #ifdef.
Files:	    src/term.c

Patch 8.1.2171
Problem:    Mouse support not always available.
Solution:   Enable mouse support also in tiny version.  Do not define
            FEAT_MOUSE_XTERM on MS-Windows (didn't really work).
Files:	    src/feature.h, src/edit.c, src/evalfunc.c, src/ex_getln.c,
            src/getchar.c, src/message.c, src/misc1.c, src/mouse.c,
            src/move.c, src/normal.c, src/ops.c, src/option.c,
            src/optionstr.c, src/os_unix.c, src/os_win32.c, src/register.c,
            src/term.c, src/testing.c, src/window.c, src/globals.h,
            src/option.h, src/optiondefs.h, src/os_win32.h, src/vim.h,
            src/version.c

Patch 8.1.2172
Problem:    Spell highlight is wrong at start of the line.
Solution:   Fix setting the "v" variable. (closes #5078)
Files:	    src/drawline.c, src/testdir/test_spell.vim,
            src/testdir/dumps/Test_spell_1.dump

Patch 8.1.2173
Problem:    Searchit() has too many arguments.
Solution:   Move optional arguments to a struct.  Add the "wrapped" argument.
Files:	    src/search.c, src/proto/search.pro, src/structs.h, src/evalfunc.c,
            src/ex_docmd.c, src/gui.c, src/quickfix.c, src/spell.c, src/tag.c,
            src/ex_getln.c, src/insexpand.c, src/normal.c

Patch 8.1.2174
Problem:    Screen not recognized as supporting "sgr" mouse codes.
Solution:   Recognize screen 4.7. (Jordan Christiansen, closes #5042)
Files:	    src/term.c, src/testdir/test_termcodes.vim

Patch 8.1.2175
Problem:    Meson files are not recognized.
Solution:   Add the meson filetype. (Liam Beguin, Nirbheek Chauhan,
            closes #5056)  Also recognize hollywood.
Files:	    runtime/filetype.vim, src/testdir/test_filetype.vim

Patch 8.1.2176
Problem:    Syntax attributes not combined with Visual highlighting. (Arseny
            Nasokin)
Solution:   Combine the attributes. (closes #5083)
Files:	    src/drawline.c, src/testdir/test_syntax.vim,
            src/testdir/dumps/Test_syntax_c_01.dump

Patch 8.1.2177
Problem:    Dart files are not recognized.
Solution:   Add a filetype rule. (Eugene Ciurana, closes #5087)
Files:	    runtime/filetype.vim, src/testdir/test_filetype.vim

Patch 8.1.2178
Problem:    Accessing uninitialized memory in test.
Solution:   Check if there was a match before using the match position.
            (Dominique Pelle, closes #5088)
Files:	    src/search.c

Patch 8.1.2179
Problem:    Pressing "q" at the more prompt doesn't stop Python output. (Daniel
            Hahler)
Solution:   Check for got_int in writer(). (closes #5053)
            Also do this for Lua.
Files:	    src/if_py_both.h, src/if_lua.c

Patch 8.1.2180
Problem:    Error E303 is not useful when 'directory' is empty.
Solution:   Skip the error message. (Daniel Hahler, #5067)
Files:	    src/memline.c, src/testdir/test_recover.vim,
            runtime/doc/options.txt, runtime/doc/message.txt

Patch 8.1.2181
Problem:    Highlighting wrong when item follows tab.
Solution:   Don't use syntax attribute when n_extra is non-zero.
            (Christian Brabandt, closes #5076)
Files:	    src/drawline.c, src/feature.h,
            src/testdir/dumps/Test_syntax_c_01.dump

Patch 8.1.2182
Problem:    Test42 seen as binary by git diff.
Solution:   Add .gitattributes file.  Make explicit that 'cpo' does not
            contain 'S'. (Daniel Hahler, closes #5072)
Files:	    .gitattributes, Filelist, src/testdir/test42.in

Patch 8.1.2183
Problem:    Running a test is a bit verbose.
Solution:   Silence some messages. (Daniel Hahler, closes #5070)
Files:	    src/testdir/Makefile

Patch 8.1.2184
Problem:    Option context is not copied when splitting a window. (Daniel
            Hahler)
Solution:   Copy the option context, so that ":verbose set" works.
            (closes #5066)
Files:	    src/option.c, src/testdir/test_options.vim

Patch 8.1.2185 (after 8.1.2181)
Problem:    Syntax test fails.
Solution:   Add missing file patch.
Files:	    src/testdir/test_syntax.vim

Patch 8.1.2186 (after 8.1.2184)
Problem:    Cannot build without the +eval feature.
Solution:   Move line inside #ifdef.
Files:	    src/option.c

Patch 8.1.2187
Problem:    Error for bad regexp even though regexp is not used when writing
            a file. (Arseny Nasokin)
Solution:   Ignore regexp errors. (closes #5059)
Files:	    src/cmdexpand.c, src/ex_docmd.c, src/testdir/test_writefile.vim

Patch 8.1.2188 (after 8.1.2187)
Problem:    Build error for missing define.
Solution:   Add missing change.
Files:	    src/vim.h

Patch 8.1.2189
Problem:    Syntax highlighting wrong for tab.
Solution:   Don't clear syntax attribute n_extra is non-zero.
Files:	    src/drawline.c, src/testdir/test_syntax.vim,
            src/testdir/dumps/Test_syntax_c_01.dump

Patch 8.1.2190
Problem:    Syntax test fails on Mac.
Solution:   Limit the window size to 20 rows.
Files:	    src/testdir/test_syntax.vim,
            src/testdir/dumps/Test_syntax_c_01.dump

Patch 8.1.2191
Problem:    When using modifyOtherKeys CTRL-X mode may not work.
Solution:   Recognize a control character also in the form with a modifier.
Files:	    src/getchar.c

Patch 8.1.2192
Problem:    Cannot easily fill the info popup asynchronously.
Solution:   Add the "popuphidden" value to 'completeopt'. (closes #4924)
Files:	    src/popupmenu.c, src/proto/popupmenu.pro, src/popupwin.c,
            src/proto/popupwin.pro, src/vim.h, runtime/doc/options.txt,
            runtime/doc/insert.txt, src/ex_cmds.c, src/proto/ex_cmds.pro,
            src/optionstr.c, src/testdir/test_popupwin.vim,
            src/testdir/dumps/Test_popupwin_infopopup_hidden_1.dump,
            src/testdir/dumps/Test_popupwin_infopopup_hidden_2.dump,
            src/testdir/dumps/Test_popupwin_infopopup_hidden_3.dump

Patch 8.1.2193
Problem:    Popup_setoptions(popup_getoptions()) does not work.
Solution:   Also accept a list with three entries for "moved" and
            "mousemoved". (closes #5081)
Files:	    runtime/doc/popup.txt, src/popupwin.c,
            src/testdir/test_popupwin.vim

Patch 8.1.2194
Problem:    ModifyOtherKeys is not enabled by default.
Solution:   Add t_TI and t_TE to the builtin xterm termcap.
Files:	    runtime/doc/map.txt, src/term.c

Patch 8.1.2195
Problem:    Vim does not exit when closing a terminal window and it is the
            last window.
Solution:   Exit Vim if the closed terminal window is the last one.
            (closes #4539)
Files:	    runtime/doc/terminal.txt, src/terminal.c, src/ex_docmd.c,
            src/proto/ex_docmd.pro, src/testdir/test_terminal.vim

Patch 8.1.2196
Problem:    MS-Windows: running tests with MSVC lacks updates.
Solution:   Improve running individual tests on MS-Windows. (closes #4922)
Files:	    src/Make_mvc.mak, src/testdir/Make_dos.mak

Patch 8.1.2197
Problem:    ExitPre autocommand may cause accessing freed memory.
Solution:   Check the window pointer is still valid. (closes #5093)
Files:	    src/testdir/test_exit.vim, src/ex_docmd.c

Patch 8.1.2198
Problem:    Crash when using :center in autocommand.
Solution:   Bail out early for an empty line. (Dominique Pelle, closes #5095)
Files:	    src/ex_cmds.c, src/testdir/test_textformat.vim

Patch 8.1.2199
Problem:    Build failure when using normal features without GUI and EXITFREE
            defined.
Solution:   Add #ifdef. (Dominique Pelle, closes #5106)
Files:	    src/scriptfile.c

Patch 8.1.2200
Problem:    Crash when memory allocation fails.
Solution:   Check for NULL curwin and curbuf. (Christian Brabandt,
            closes #4839)
Files:	    src/getchar.c

Patch 8.1.2201
Problem:    Cannot build with dynamically linked Python 3.8.
Solution:   Implement py3__Py_DECREF() and py3__Py_XDECREF(). (Ken Takata,
            closes #4080)
Files:	    src/if_python3.c

Patch 8.1.2202
Problem:    MS-Windows: build failure with GUI and small features.
Solution:   Add #ifdef. (Michael Soyka, closes #5097)
Files:	    src/gui_w32.c

Patch 8.1.2203
Problem:    Running libvterm tests without the +terminal feature.
Solution:   Only add the libvterm test target when building libvterm.
Files:	    src/configure.ac, src/auto/configure, src/config.mk.in,
            src/Makefile

Patch 8.1.2204
Problem:    Crash on exit when closing terminals. (Corey Hickey)
Solution:   Actually wait for the job to stop. (closes #5100)
Files:	    src/terminal.c

Patch 8.1.2205
Problem:    Sign entry structure has confusing name.
Solution:   Rename signlist_T to sign_entry_T and prefix se_ to the fields.
Files:	    src/structs.h, src/netbeans.c, src/sign.c, src/globals.h,
            src/drawline.c

Patch 8.1.2206
Problem:    No test for fixed issue #3893.
Solution:   Add a test. (Christian Brabandt, #3893)
Files:	    src/testdir/test_display.vim,
            src/testdir/dumps/Test_winline_rnu.dump

Patch 8.1.2207
Problem:    "gn" doesn't work quite right. (Jaehwang Jerry Jung)
Solution:   Improve and simplify the search logic. (Christian Brabandt,
            closes #5103, closes #5075)
Files:	    src/search.c, src/testdir/test_gn.vim

Patch 8.1.2208
Problem:    Unix: Tabs in output might be expanded to spaces.
Solution:   Reset the XTABS flag. (closes #5108)
Files:	    src/os_unix.c

Patch 8.1.2209
Problem:    LF in escape codes may be expanded to CR-LF.
Solution:   Do not expand LF in escape codes to CR-LF. (closes #5107)
Files:	    src/term.c

Patch 8.1.2210
Problem:    Using negative offset for popup_create() does not work.
Solution:   Use -1 instead of zero. (closes #5111)
Files:	    src/popupwin.c, src/popupwin.vim, src/testdir/test_popupwin.vim,
            src/testdir/dumps/Test_popupwin_corners.dump

Patch 8.1.2211
Problem:    Listener callback "added" argument is not the total. (Andy
            Massimino)
Solution:   Compute the total. (closes #5105)
Files:	    src/change.c, src/testdir/test_listener.vim

Patch 8.1.2212
Problem:    Cannot see the selection type in :reg output. (Ayberk Aydın)
Solution:   Add c/l/b. (Christian Brabandt, closes #5110, closes #4546)
Files:	    runtime/doc/change.txt, src/register.c,
            src/testdir/test_registers.vim

Patch 8.1.2213
Problem:    Popup_textprop tests fail.
Solution:   Adjust the column and line positioning.
Files:	    src/popupwin.c

Patch 8.1.2214
Problem:    Too much is redrawn when 'cursorline' is set.
Solution:   Don't do a complete redraw. (closes #5079)
Files:	    src/main.c, src/change.c, src/drawscreen.c,
            src/testdir/dumps/Test_Xcursorline_13.dump,
            src/testdir/dumps/Test_Xcursorline_14.dump,
            src/testdir/dumps/Test_Xcursorline_15.dump,
            src/testdir/dumps/Test_Xcursorline_16.dump,
            src/testdir/dumps/Test_Xcursorline_17.dump,
            src/testdir/dumps/Test_Xcursorline_18.dump

Patch 8.1.2215
Problem:    Unreachable code in adjusting text prop columns.
Solution:   Remove the code. (Christian Brabandt)
Files:	    src/textprop.c

Patch 8.1.2216
Problem:    Text property in wrong place after :substitute.
Solution:   Pass the new column instead of the old one. (Christian Brabandt,
            closes #4427)
Files:	    src/ex_cmds.c, src/testdir/test_textprop.vim

Patch 8.1.2217
Problem:    Compiler warning for unused variable.
Solution:   Move variable inside #ifdef. (John Marriott)
Files:	    src/ex_cmds.c

Patch 8.1.2218
Problem:    "gN" is off by one in Visual mode.
Solution:   Check moving forward. (Christian Brabandt, #5075)
Files:	    src/search.c, src/testdir/test_gn.vim

Patch 8.1.2219
Problem:    No autocommand for open window with terminal.
Solution:   Add TerminalWinOpen. (Christian Brabandt)
Files:	    runtime/doc/autocmd.txt, src/autocmd.c, src/terminal.c,
            src/testdir/test_terminal.vim, src/vim.h

Patch 8.1.2220
Problem:    :cfile does not abort like other quickfix commands.
Solution:   Abort when desired. Add tests for aborting. (Yegappan Lakshmanan,
            closes #5121)
Files:	    src/quickfix.c, src/testdir/test_quickfix.vim

Patch 8.1.2221
Problem:    Cannot filter :disp output.
Solution:   Support filtering :disp output. (Andy Massimino, closes #5117)
Files:	    runtime/doc/various.txt, src/register.c,
            src/testdir/test_filter_cmd.vim

Patch 8.1.2222
Problem:    Accessing invalid memory. (Dominique Pelle)
Solution:   Reset highlight_match every time.  (closes #5125)
Files:	    src/ex_getln.c

Patch 8.1.2223
Problem:    Cannot see what buffer an ml_get error is for.
Solution:   Add the buffer number and name in the message
Files:	    src/memline.c

Patch 8.1.2224
Problem:    Cannot build Amiga version.
Solution:   Add dummy mch_setmouse(). (Ola Söder, closes #5126)
Files:	    src/os_amiga.c, src/proto/os_amiga.pro

Patch 8.1.2225
Problem:    The "last used" info of a buffer is under used.
Solution:   Add "lastused" to getbufinfo(). List buffers sorted by last-used
            field. (Andy Massimino, closes #4722)
Files:	    runtime/doc/eval.txt, runtime/doc/options.txt,
            runtime/doc/windows.txt, src/buffer.c, src/evalbuffer.c,
            src/ex_getln.c, src/misc1.c, src/option.c, src/option.h,
            src/proto/misc1.pro, src/proto/viminfo.pro,
            src/testdir/test_bufwintabinfo.vim, src/testdir/test_cmdline.vim,
            src/testdir/test_excmd.vim, src/undo.c, src/vim.h, src/viminfo.c

Patch 8.1.2226
Problem:    Cannot use system copy/paste in non-xterm terminals.
Solution:   Instead of setting 'mouse' to "a" set it to "nvi" in defaults.vim.
Files:	    runtime/defaults.vim, runtime/doc/term.txt,
            runtime/doc/options.txt

Patch 8.1.2227
Problem:    Layout wrong if 'lines' changes while cmdline window is open.
Solution:   Do not restore the window layout if 'lines' changed.
            (closes #5130)
Files:	    src/window.c, src/testdir/test_cmdline.vim,
            src/testdir/dumps/Test_cmdwin_restore_1.dump,
            src/testdir/dumps/Test_cmdwin_restore_2.dump,
            src/testdir/dumps/Test_cmdwin_restore_3.dump

Patch 8.1.2228
Problem:    screenpos() returns wrong values when 'number' is set. (Ben
            Jackson)
Solution:   Compare the column with the window width. (closes #5133)
Files:	    src/move.c, src/testdir/test_cursor_func.vim

Patch 8.1.2229
Problem:    Cannot color number column above/below cursor differently.
Solution:   Add LineNrAbove and LineNrBelow. (Shaun Brady, closes #624)
Files:	    runtime/doc/syntax.txt, runtime/doc/options.txt, src/optiondefs.h,
            src/drawline.c, src/vim.h, src/testdir/test_number.vim,
            src/testdir/dumps/Test_relnr_colors_1.dump,
            src/testdir/dumps/Test_relnr_colors_2.dump,
            src/testdir/dumps/Test_relnr_colors_3.dump,
            src/testdir/dumps/Test_relnr_colors_4.dump

Patch 8.1.2230
Problem:    MS-Windows: testing external commands can be improved.
Solution:   Adjust tests, remove duplicate test. (closes #4928)
Files:	    src/testdir/test_normal.vim, src/testdir/test_system.vim,
            src/testdir/test_terminal.vim, src/testdir/test_undo.vim

Patch 8.1.2231
Problem:    Not easy to move to the middle of a text line.
Solution:   Add the gM command. (Yasuhiro Matsumoto, closes #2070)
Files:	    runtime/doc/index.txt, runtime/doc/motion.txt,
            runtime/doc/quickref.txt, runtime/doc/usr_25.txt, src/normal.c,
            src/testdir/test_normal.vim

Patch 8.1.2232
Problem:    MS-Windows: compiler warning for int size.
Solution:   Add type cast. (Mike Williams)
Files:	    src/normal.c

Patch 8.1.2233
Problem:    Cannot get the Vim command line arguments.
Solution:   Add v:argv. (Dmitri Vereshchagin, closes #1322)
Files:	    runtime/doc/eval.txt, src/evalvars.c, src/vim.h,
            src/proto/evalvars.pro, src/main.c, src/testdir/test_startup.vim

Patch 8.1.2234
Problem:    get_short_pathname() fails depending on encoding.
Solution:   Use the wide version of the library function. (closes #5129)
Files:	    src/filepath.c, src/testdir/test_shortpathname.vim

Patch 8.1.2235
Problem:    "C" with 'virtualedit' set does not include multibyte char.
Solution:   Include the whole multibyte char. (Nobuhiro Takasaki,
            closes #5152)
Files:	    src/ops.c, src/testdir/test_virtualedit.vim

Patch 8.1.2236
Problem:    Ml_get error if pattern matches beyond last line.
Solution:   Adjust position if needed. (Christian Brabandt, closes #5139)
Files:	    src/ex_cmds.c, src/testdir/test_substitute.vim

Patch 8.1.2237
Problem:    Mode() result after using "r" depends on whether CURSOR_SHAPE is
            defined. (Christian Brabandt)
Solution:   Move the #ifdef to only skip ui_cursor_shape().
Files:	    src/normal.c

Patch 8.1.2238
Problem:    Error in docs tags goes unnoticed.
Solution:   Adjust tags build command. (Ken Takata, closes #5158)
Files:	    Filelist, .travis.yml, runtime/doc/Makefile,
            runtime/doc/doctags.vim

Patch 8.1.2239
Problem:    CI fails when running tests without building Vim.
Solution:   Skip creating doc tags if the execute does not exist.
Files:	    runtime/doc/Makefile

Patch 8.1.2240
Problem:    Popup window width changes when scrolling.
Solution:   Also adjust maxwidth when applying minwidth and there is a
            scrollbar.  Fix off-by-one error. (closes #5162)
Files:	    src/popupwin.c, src/testdir/test_popupwin.vim,
            src/testdir/dumps/Test_popupwin_scroll_11.dump,
            src/testdir/dumps/Test_popupwin_scroll_12.dump,
            src/testdir/dumps/Test_popupwin_previewpopup_4.dump,
            src/testdir/dumps/Test_popupwin_previewpopup_5.dump,
            src/testdir/dumps/Test_popupwin_previewpopup_7.dump,
            src/testdir/dumps/Test_popupwin_previewpopup_8.dump,

Patch 8.1.2241
Problem:    Match highlight does not combine with 'wincolor'.
Solution:   Apply 'wincolor' last on top of any other attribute. (closes #5159)
Files:	    src/drawline.c, src/testdir/test_popupwin.vim,
            src/testdir/dumps/Test_popupwin_matches.dump
            src/testdir/dumps/Test_popupwin_menu_01.dump
            src/testdir/dumps/Test_popupwin_menu_02.dump
            src/testdir/dumps/Test_popupwin_menu_04.dump

Patch 8.1.2242
Problem:    Creating docs tags uses user preferences. (Tony Mechelynck)
Solution:   Add "--clean".
Files:	    runtime/doc/Makefile

Patch 8.1.2243
Problem:    Typos in comments.
Solution:   Fix the typos. (Dominique Pelle, closes #5160)  Also adjust
            formatting a bit.
Files:	    src/autocmd.c, src/buffer.c, src/cindent.c, src/crypt.c,
            src/diff.c, src/getchar.c, src/globals.h, src/gui_gtk_x11.c,
            src/highlight.c, src/insexpand.c, src/macros.h, src/map.c,
            src/memline.c, src/message.c, src/option.c, src/os_unix.c,
            src/pty.c, src/quickfix.c, src/regexp_nfa.c, src/register.c,
            src/spellsuggest.c, src/structs.h, src/textprop.c, src/ui.c,
            src/undo.c, src/vim.h, src/viminfo.c

Patch 8.1.2244
Problem:    'wrapscan' is not used for "gn".
Solution:   Only reset 'wrapscan' for the first search round. (closes #5164)
Files:	    src/search.c, src/testdir/test_gn.vim

Patch 8.1.2245
Problem:    Third character of 'listchars' tab shows in wrong place when
            'breakindent' is set.
Solution:   Set c_final to NUL. (Naruhiko Nishino, closes #5165)
Files:	    src/drawline.c, src/testdir/test_breakindent.vim

Patch 8.1.2246
Problem:    Some tests are still in old style.
Solution:   Change a few tests to new style. (Yegappan Lakshmanan)
Files:	    src/testdir/Make_all.mak, src/testdir/test49.ok,
            src/testdir/test49.vim, src/testdir/test_trycatch.vim,
            src/testdir/test_vimscript.vim

Patch 8.1.2247
Problem:    "make vimtags" does not work in runtime/doc.
Solution:   Test existence with "which" instead of "test -x". (Ken Takata)
Files:	    runtime/doc/Makefile

Patch 8.1.2248
Problem:    CTRL-W dot does not work in a terminal when modifyOtherKeys is
            enabled.
Solution:   Use the modifier when needed.  Pass the modifier along with the
            key to avoid mistakes.
Files:	    src/terminal.c, src/proto/terminal.pro, src/mouse.c

Patch 8.1.2249
Problem:    "make vimtags" does not print any message.
Solution:   Add a message that the tags have been updated.
Files:	    runtime/doc/Makefile

Patch 8.1.2250
Problem:    CTRL-U and CTRL-D don't work in popup window.
Solution:   Initialize 'scroll'.  Add "lastline" in popup_getpos().
            (closes #5170)
Files:	    src/popupwin.c, src/testdir/test_popupwin.vim,
            runtime/doc/popup.txt

Patch 8.1.2251
Problem:    ":term command" may not work without a shell.
Solution:   Add the ++shell option to :term. (closes #3340)
Files:	    runtime/doc/terminal.txt, src/terminal.c,
            src/os_unix.c, src/proto/os_unix.pro,
            src/testdir/test_terminal.vim

Patch 8.1.2252
Problem:    Compiler warning for int size.
Solution:   Add type cast. (Mike Williams)
Files:	    src/filepath.c

Patch 8.1.2253
Problem:    Using "which" to check for an executable is not reliable.
Solution:   Use "command -v" instead.  Also exit with error code when
            generating tags has an error. (closes #5174)
Files:	    runtime/doc/Makefile

Patch 8.1.2254
Problem:    MS-Windows: mouse scroll wheel doesn't work in popup.
Solution:   Handle mouse wheel events separately. (closes #5138)
Files:	    src/gui_w32.c, src/gui.c, src/proto/gui.pro

Patch 8.1.2255
Problem:    ":term ++shell" does not work on MS-Windows.
Solution:   Add MS-Windows support.
Files:	    src/terminal.c, src/testdir/test_terminal.vim

Patch 8.1.2256 (after 8.1.2255)
Problem:    Test for ":term ++shell" fails on MS-Windows.
Solution:   Accept failure of "dir" executable.
Files:	    src/testdir/test_terminal.vim

Patch 8.1.2257
Problem:    MS-Windows GUI: scroll wheel always uses current window.
Solution:   Add the 'scrollfocus' option for MS-Windows.
Files:	    runtime/doc/options.txt, src/gui_w32.c, src/optiondefs.h,
            src/option.h

Patch 8.1.2258
Problem:    May get hit-enter prompt after entering a number. (Malcolm Rowe)
Solution:   Put back accidentally deleted lines. (closes #5176)
Files:	    src/misc1.c

Patch 8.1.2259
Problem:    Running tests may leave XfakeHOME behind.
Solution:   Source summarize.vim without using setup.vim. (closes #5177)
            Also fix that on MS-Windows the test log isn't echoed.
Files:	    src/testdir/Makefile, src/testdir/Make_dos.mak

Patch 8.1.2260
Problem:    Terminal test may fail on MS-Windows.
Solution:   Catch the situation that "term dir" fails with a CreateProcess
            error.
Files:	    src/testdir/test_terminal.vim

Patch 8.1.2261
Problem:    With modifyOtherKeys set 'noesckeys' doesn't work. (James McCoy)
Solution:   Disable modifyOtherKeys while in Insert mode when 'noesckeys' is
            set. (closes #5180)
Files:	    src/edit.c, src/testdir/test_edit.vim

Patch 8.1.2262
Problem:    Unpack assignment in function not recognized.
Solution:   Skip over "[a, b]". (closes #5051)
Files:	    src/userfunc.c, src/testdir/test_let.vim

Patch 8.1.2263
Problem:    'noesckeys' test fails in GUI.
Solution:   Skip the test in the GUI.
Files:	    src/testdir/test_edit.vim

Patch 8.1.2264
Problem:    There are two test files for :let.
Solution:   Merge the two files.
Files:	    src/testdir/test_assign.vim, src/testdir/test_let.vim,
            src/testdir/Make_all.mak, src/testdir/test_alot.vim

Patch 8.1.2265
Problem:    When popup with "botleft" does not fit it flips incorrectly.
Solution:   Only flip when there is more space on the other side.  Add the
            "posinvert" option to disable flipping and do it in both
            directions if enabled.  (closes #5151)
Files:	    src/popupwin.c, src/testdir/test_popupwin.vim, src/vim.h,
            src/testdir/dumps/Test_popupwin_nospace.dump

Patch 8.1.2266
Problem:    Position unknown for a mouse click in a popup window.
Solution:   Set v:mouse_col and v:mouse_lnum. (closes #5171)
Files:	    src/popupwin.c, src/testdir/test_popupwin.vim

Patch 8.1.2267
Problem:    Compiler warning for uninitialized variable. (Tony Mechelynck)
Solution:   Rearrange the code.
Files:	    src/buffer.c

Patch 8.1.2268
Problem:    Spell file flag zero is not recognized.
Solution:   Use -1 as an error value, so that zero can be used as a valid flag
            number.
Files:	    src/spellfile.c, src/testdir/test_spell.vim

Patch 8.1.2269
Problem:    Tags file with very long line stops using binary search.
Solution:   Reallocate the buffer if needed.
Files:	    src/tag.c, src/testdir/test_tagjump.vim

Patch 8.1.2270
Problem:    "gf" is not tested in Visual mode.
Solution:   Add Visual mode test and test errors. (Dominique Pelle,
            closes #5197)
Files:	    src/testdir/test_gf.vim

Patch 8.1.2271
Problem:    Build error if FEAT_TAG_BINS is not defined. (John Marriott)
Solution:   Add #ifdef.
Files:	    src/tag.c

Patch 8.1.2272
Problem:    Test may hang at more prompt.
Solution:   Reset 'more' after resetting 'compatible'. (Michael Soyka)
Files:	    src/testdir/test_vimscript.vim

Patch 8.1.2273
Problem:    Wrong default when "pos" is changed with popup_atcursor().
Solution:   Adjust the default line and col when "pos" is not the default
            value. (#5151)
Files:	    runtime/doc/popup.txt, src/structs.h, src/popupwin.c,
            src/proto/popupwin.pro, src/ex_cmds.c,
            src/testdir/test_popupwin.vim,
            src/testdir/dumps/Test_popupwin_atcursor_pos.dump

Patch 8.1.2274
Problem:    Newlines in 'balloonexpr' result only work in the GUI.
Solution:   Also recognize newlines in the terminal. (closes #5193)
Files:	    src/popupmenu.c, src/testdir/test_balloon.vim,
            src/testdir/dumps/Test_balloon_eval_term_01.dump,
            src/testdir/dumps/Test_balloon_eval_term_01a.dump,
            src/testdir/dumps/Test_balloon_eval_term_02.dump

Patch 8.1.2275
Problem:    Using "seesion" looks like a mistake.
Solution:   Use an underscore to make the function sort first.
Files:	    src/testdir/test_mksession.vim

Patch 8.1.2276
Problem:    MS-Windows: session test leaves files behind.
Solution:   Wipe out buffers before deleting the directory. (closes #5187)
Files:	    src/testdir/test_mksession.vim

Patch 8.1.2277
Problem:    Terminal window is not updated when info popup changes.
Solution:   Redraw windows when re-using an info popup. (closes #5192)
Files:	    src/ex_cmds.c

Patch 8.1.2278
Problem:    Using "cd" with "exe" may fail.
Solution:   Use chdir() instead.
Files:	    src/testdir/test_autochdir.vim, src/testdir/test_autocmd.vim,
            src/testdir/test_cd.vim, src/testdir/test_expand.vim,
            src/testdir/test_find_complete.vim, src/testdir/test_findfile.vim,
            src/testdir/test_getcwd.vim, src/testdir/test_shortpathname.vim

Patch 8.1.2279
Problem:    Computation of highlight attributes is too complicated.
Solution:   Simplify the attribute computation and make it more consistent.
            (closes #5190)  Fix that 'combine' set to zero doesn't work.
Files:	    src/drawline.c, src/testdir/test_textprop.vim,
            src/testdir/dumps/Test_textprop_01.dump

Patch 8.1.2280
Problem:    Crash when passing partial to substitute().
Solution:   Take extra arguments into account. (closes #5186)
Files:	    src/userfunc.c, src/structs.h, src/regexp.c, src/proto/regexp.pro,
            src/testdir/test_substitute.vim

Patch 8.1.2281
Problem:    'showbreak' cannot be set for one window.
Solution:   Make 'showbreak' global-local.
Files:	    src/optiondefs.h, src/option.c, src/option.h,
            src/proto/option.pro, src/structs.h, src/charset.c,
            src/drawline.c, src/edit.c, src/move.c, src/normal.c, src/ops.c,
            src/optionstr.c, src/testdir/test_highlight.vim,
            src/testdir/test_breakindent.vim, runtime/doc/options.txt

Patch 8.1.2282
Problem:    Crash when passing many arguments through a partial. (Andy
            Massimino)
Solution:   Check the number of arguments. (closes #5186)
Files:	    src/userfunc.c, src/proto/userfunc.pro, src/evalfunc.c,
            src/regexp.c, src/testdir/test_expr.vim,
            src/testdir/test_substitute.vim

