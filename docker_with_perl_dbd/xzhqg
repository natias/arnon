Problem:    Vim9: can use old style autoload function name.
Solution:   Give an error for old style autoload function name.
Files:      src/errors.h, src/userfunc.c, src/testdir/test_vim9_import.vim,
            src/testdir/test_vim9_func.vim, src/testdir/test_vim9_script.vim

Patch 8.2.4265 (after 8.2.4264)
Problem:    Autoload tests fails.
Solution:   Use export instead of name with #.
Files:      src/testdir/sautest/autoload/auto9.vim,
            src/testdir/test_autoload.vim, src/testdir/test_ins_complete.vim

Patch 8.2.4266
Problem:    Compiler warning for uninitialized variable.
Solution:   Initialize saved_did_emsg.
Files:      src/userfunc.c

Patch 8.2.4267
Problem:    Unused entry in keymap enum.
Solution:   Remove the entry.
Files:      src/keymap.h

Patch 8.2.4268
Problem:    CI log output is long.
Solution:   Group output in sections. (Ozaki Kiichi, closes #9670)
Files:      .github/workflows/ci.yml

Patch 8.2.4269
Problem:    Coverity warns for using a NULL pointer.
Solution:   Check for "name" to not be NULL.
Files:      src/userfunc.c

Patch 8.2.4270
Problem:    Generating nv_cmdidxs.h requires building Vim twice.
Solution:   Move the table into a separate file and use a separate executable
            to extract the command characters. (Ozaki Kiichi, closes #9669)
Files:      src/normal.c, src/nv_cmds.h, Filelist, runtime/doc/builtin.txt,
            runtime/doc/usr_41.txt, src/Make_cyg_ming.mak, src/Make_mvc.mak,
            src/Make_vms.mms, src/Makefile, src/create_nvcmdidxs.c,
            src/create_nvcmdidxs.vim, src/evalfunc.c, src/proto/normal.pro

Patch 8.2.4271
Problem:    MS-Windows: cannot build with Ruby 3.1.0.
Solution:   Adjust the DLL name and include directory. (Ken Takata,
            closes #9666)
Files:      src/Make_cyg_ming.mak, src/Make_mvc.mak

Patch 8.2.4272
Problem:    Vim9 expr test fails without the channel feature. (Dominique
            Pellé)
Solution:   Remove "g:" before "CheckFeature". (closes #9671)
Files:      src/testdir/test_vim9_expr.vim

Patch 8.2.4273
Problem:    The EBCDIC support is outdated.
Solution:   Remove the EBCDIC support.
Files:      src/ascii.h, src/charset.c, src/cindent.c, src/digraph.c,
            src/edit.c, src/eval.c, src/evalfunc.c, src/ex_cmds.c,
            src/feature.h, src/filepath.c, src/findfile.c, src/getchar.c,
            src/gui.c, src/gui_motif.c, src/hardcopy.c, src/help.c,
            src/macros.h, src/map.c, src/mark.c, src/misc2.c, src/normal.c,
            src/ops.c, src/option.c, src/option.h, src/optiondefs.h,
            src/os_unix.c, src/proto/evalfunc.pro, src/regexp.c,
            src/regexp_bt.c, src/regexp_nfa.c, src/register.c, src/screen.c,
            src/spell.c, src/strings.c, src/structs.h, src/term.c,
            src/version.c, src/viminfo.c, src/testdir/test_edit.vim,
            src/testdir/test_exec_while_if.vim, src/testdir/test_expr.vim,
            src/testdir/test_gf.vim, src/testdir/test_regexp_utf8.vim

Patch 8.2.4274
Problem:    Basic and form filetype detection is incomplete.
Solution:   Add a separate function for .frm files. (Doug Kearns, closes #9675)
Files:      runtime/autoload/dist/ft.vim, runtime/filetype.vim,
            src/testdir/test_filetype.vim

Patch 8.2.4275
Problem:    Cannot use an autoload function from a package under start.
Solution:   Also look in the "start" package directory. (Bjorn Linse,
            closes #7193)
Files:      src/scriptfile.c, src/testdir/test_packadd.vim

Patch 8.2.4276
Problem:    Separate test function for the GUI scrollbar.
Solution:   Use test_gui_event(). (Yegappan Lakshmanan, closes #9674)
Files:      runtime/doc/builtin.txt, runtime/doc/testing.txt,
            runtime/doc/usr_41.txt, src/evalfunc.c, src/testing.c,
            src/proto/testing.pro, src/testdir/test_gui.vim,
            src/testdir/test_vim9_builtin.vim

Patch 8.2.4277
Problem:    Vim9: an import does not shadow a command modifier.
Solution:   Do not accept a command modifier followed by a dot.
Files:      src/ex_docmd.c, src/testdir/test_vim9_import.vim

Patch 8.2.4278
Problem:    Build with Athena GUI fails. (Elimar Riesebieter)
Solution:   Add #ifdef.
Files:      src/testing.c

Patch 8.2.4279
Problem:    Vim9: cannot change item type with map() after range().
Solution:   Split the return type in current type and declared type.
            (closes #9665)
Files:      src/evalfunc.c, src/proto/evalfunc.pro, src/vim9instr.c,
            src/vim9type.c, src/proto/vim9type.pro,
            src/testdir/test_vim9_builtin.vim

Patch 8.2.4280 (after 8.2.4279)
Problem:    list-dict test crashes.
Solution:   Check declared type for add().
Files:      src/vim9expr.vim

Patch 8.2.4281
Problem:    Using freed memory with :lopen and :bwipe.
Solution:   Do not use a wiped out buffer.
Files:      src/buffer.c, src/testdir/test_quickfix.vim

Patch 8.2.4282
Problem:    Restricted mode requires the -Z command line option.
Solution:   Use restricted mode when $SHELL ends in "nologin" or "false".
            (closes #9681)
Files:      runtime/doc/starting.txt, src/option.c,
            src/testdir/test_restricted.vim

Patch 8.2.4283
Problem:    Using a variable for the return value is not needed.
Solution:   Return the value directly. (closes #9687)
Files:      src/ex_docmd.c, src/misc2.c

Patch 8.2.4284
Problem:    Old mac resources files are no longer used.
Solution:   Delete the unused files. (Ozaki Kiichi, closes #9688)
Files:      Filelist, src/Makefile, src/dehqx.py, src/infplist.xml,
            src/os_mac.rsr.hqx, src/os_mac_rsrc/app.icns,
            src/os_mac_rsrc/doc-txt.icns, src/os_mac_rsrc/doc.icns

Patch 8.2.4285
Problem:    Vim9: type of item in for loop not checked properly.
Solution:   Adjust the type checking. (closes #9683)
Files:      src/vim9compile.c, src/proto/vim9compile.pro, src/vim9cmds.c,
            src/testdir/test_vim9_script.vim

Patch 8.2.4286
Problem:    Vim9: strict type checking after copy() and deepcopy().
Solution:   Allow type to change after making a copy. (closes #9644)
Files:      src/eval.c, src/proto/eval.pro, src/dict.c, src/proto/dict.pro,
            src/list.c, src/proto/list.pro, src/evalfunc.c, src/vim9execute.c,
            src/vim9type.c, src/proto/vim9type.pro, src/evalvars.c,
            src/testdir/test_vim9_builtin.vim,
            src/testdir/test_vim9_assign.vim

Patch 8.2.4287
Problem:    Cannot assign empty list with any list type to variable with
            specific list type.
Solution:   Use unknown list type for empty list if the specified type is any.
Files:      src/vim9type.c, src/testdir/test_vim9_assign.vim,
            src/testdir/test_vim9_func.vim

Patch 8.2.4288
Problem:    Preprocessor indents are inconsistent.
Solution:   Fix preprocessor indents. (Ken Takata, closes #9691)
Files:      src/arglist.c, src/change.c, src/ex_cmds.c, src/gui.c,
            src/hashtab.c, src/indent.c, src/ops.c, src/os_win32.c

Patch 8.2.4289
Problem:    Warnings reported by MSVC.
Solution:   Rename variables and other fixes. (Ken Takata, closes #9689)
Files:      src/cmdexpand.c, src/drawscreen.c, src/filepath.c, src/getchar.c,
            src/menu.c, src/os_win32.c, src/version.c

Patch 8.2.4290
Problem:    MS-Windows: using type casts for timer IDs.
Solution:   Remove type casts and use the right type. (Ken Takata,
            closes #9690)  Remove old debug comments.  Rename variables and
            functions.
Files:      src/gui_w32.c

Patch 8.2.4291
Problem:    Error number used twice.
Solution:   Renumber the errors.
Files:      src/errors.h

Patch 8.2.4292 (after 8.2.4291)
Problem:    Test fails.
Solution:   Adjust the expected error number.
Files:      src/testdir/test_vim9_cmd.vim

Patch 8.2.4293
Problem:    Vim9: when copying a list it gets type list<any> even when the
            original list did not have a type.
Solution:   Only set the type when the original list has a type. (closes #9692)
Files:      src/list.c, src/testdir/test_vim9_expr.vim

Patch 8.2.4294
Problem:    MS-Windows: #ifdefs for Cygwin are too complicated.
Solution:   Simplify the conditions. (Ken Takata, closes #9693)
Files:      src/evalfunc.c, src/main.c, src/os_unix.c, src/os_win32.c,
            src/os_win32.h

Patch 8.2.4295
Problem:    Vim9: concatenating two lists may result in wrong type.
Solution:   Remove the type instead of using list<any>. (closes #9692)
Files:      src/list.c, src/testdir/test_vim9_expr.vim

Patch 8.2.4296
Problem:    Vim9: not all code covered by tests.
Solution:   Add a few more tests for corner cases.  Fix hang when single quote
            is missing.
Files:      src/vim9expr.c, src/testdir/test_vim9_assign.vim,
            src/testdir/test_vim9_cmd.vim, src/testdir/test_vim9_expr.vim

Patch 8.2.4297
Problem:    Vim9: not all code covered by tests.
Solution:   Add a couple more tests.
Files:      src/testdir/test_vim9_script.vim,
            src/testdir/test_vim9_disassemble.vim

Patch 8.2.4298
Problem:    Divide by zero with huge tabstop value.
Solution:   Reject tabstop value that overflows to zero.
Files:      src/indent.c, src/testdir/test_vartabs.vim

Patch 8.2.4299
Problem:    SafeState autocommand interferes with debugging.
Solution:   Do not trigger SafeState while debugging. (closes #9697)
Files:      src/main.c

Patch 8.2.4300 (after 8.2.4299)
Problem:    Cannot build tiny version. (Tony Mechelynck)
Solution:   Add #ifdef.
Files:      src/main.c

Patch 8.2.4301
Problem:    Vim9: type error for copy of dict.
Solution:   Do not use dict<any> but no type. (closes #9696)
Files:      src/dict.c, src/testdir/test_vim9_builtin.vim

Patch 8.2.4302
Problem:    Vim9: return type of getline() is too strict.
Solution:   Make the declared type list<any>.  Also do this for other
            functions returning a list of a specific type.
Files:      src/evalfunc.c, src/testdir/test_vim9_builtin.vim

Patch 8.2.4303
Problem:    A few messages should not be translated.
Solution:   Remove _(). (Dominique Pellé, closes #9702)
Files:      src/syntax.c

Patch 8.2.4304
Problem:    Vim9: slice() makes a copy but doesn't change the type.
Solution:   Change the declared type like copy(). (closes #9696)
Files:      src/evalfunc.c, src/testdir/test_vim9_builtin.vim

Patch 8.2.4305
Problem:    Tex filetype detection fails.
Solution:   Check value to be positive. (closes #9704)
Files:      runtime/autoload/dist/ft.vim, src/testdir/test_filetype.vim

Patch 8.2.4306
Problem:    No test for fixed perl filetype check.
Solution:   Add a test. Sort test functions.
Files:      src/testdir/test_filetype.vim

Patch 8.2.4307
Problem:    A few more messages should not be translated.
Solution:   Remove _().
Files:      src/syntax.c

Patch 8.2.4308
Problem:    Vim9: cannot list autoload function.
Solution:   Don't give an error for using # when listing a function.
            (closes #9703)
Files:      src/userfunc.c, src/testdir/test_vim9_import.vim

Patch 8.2.4309
Problem:    Vim9: crash when using a partial in the wrong context.
Solution:   Don't use an NULL outer pointer. (closes #9706)
Files:      src/vim9execute.c, src/testdir/test_vim9_func.vim

Patch 8.2.4310
Problem:    Vim9: constant list and dict get a declaration type other than
            "any".
Solution:   A constant list and dict have a declared member type "any".
            (closes #9701)
Files:      src/vim9instr.c, src/vim9type.c, src/proto/vim9type.pro,
            src/testdir/test_vim9_builtin.vim

Patch 8.2.4311
Problem:    Vim9: changing script variable type not caught at compile time.
Solution:   Set the declared type.
Files:      src/vim9instr.c, src/testdir/test_vim9_assign.vim

Patch 8.2.4312
Problem:    No error for using :vim9script in a :def function.
Solution:   Give an error when compiling.
Files:      src/vim9compile.c, src/testdir/test_vim9_script.vim

Patch 8.2.4313
Problem:    Vim9: cannot change type of list after making a slice.
Solution:   Adjust the declared member type. (closes #9696)
Files:      src/vim9expr.c, src/testdir/test_vim9_builtin.vim

Patch 8.2.4314 (after 8.2.4312)
Problem:    Test fails where lines are skipped.
Solution:   Only give an error when not skipping commands.
Files:      src/vim9compile.c, src/testdir/test_vim9_script.vim

Patch 8.2.4315
Problem:    Put in Visual mode not fully tested.
Solution:   Add a few more test cases. (closes #9708)
Files:      src/testdir/test_visual.vim

Patch 8.2.4316
Problem:    __CYGWIN32__ is not defined on 64 bit systems.
Solution:   Update #ifdefs. (Ken Takata, closes #9709)
Files:      src/main.c, src/os_unix.c, src/pty.c, src/vim.h

Patch 8.2.4317
Problem:    MS-Windows: Vim exits when Python 3 initialisation fails.
Solution:   Hook into the exit() function to recover from the failure.
            (Ken Takata, closes #9710)
Files:      runtime/doc/if_pyth.txt, src/if_python3.c, src/os_win32.c,
            src/errors.h, src/proto/os_win32.pro

Patch 8.2.4318
Problem:    Various comment and indent mistakes, returning wrong zero.
Solution:   Fix the mistakes.  Return NULL instead of FAIL.
Files:      src/clientserver.c, src/eval.c, src/evalvars.c, src/vim9cmds.c,
            src/window.c

Patch 8.2.4319
Problem:    :put does not work properly in compiled function. (John Beckett)
Solution:   Adjust the direction when using line zero.
Files:      src/vim9execute.c, src/testdir/test_vim9_cmd.vim

Patch 8.2.4320
Problem:    Athena and Motif: when maximized scrollbar position is wrong.
Solution:   Implement the scrollbar padding functions. (closes #9712)
Files:      src/gui_athena.c, src/gui_motif.c

Patch 8.2.4321
Problem:    Vim9: crash when using a funcref to a closure.
Solution:   Copy pt_outer to the new partial. (closes #9714)
Files:      src/evalfunc.c, src/testdir/test_vim9_func.vim

Patch 8.2.4322
Problem:    Vim9: crash when using funcref with closure.
Solution:   Keep a reference to the funcref that has the outer context.
            (closes #9716)
Files:      src/evalfunc.c, src/structs.h, src/eval.c, src/vim9execute.c,
            src/testdir/test_vim9_func.vim

Patch 8.2.4323
Problem:    Vim9: nested function name can start with "_".
Solution:   Use same rule for function name for nested functions.
            (closes #9713)
Files:      src/vim9compile.c, src/testdir/test_vim9_func.vim

Patch 8.2.4324
Problem:    Vim9: script-local function name can start with "_".
Solution:   Check for leading capital after "s:".  Correct error message.
Files:      src/userfunc.c, src/errors.h, src/vim9compile.c,
            src/testdir/test_vim9_func.vim

Patch 8.2.4325
Problem:    'wildmenu' only shows few matches.
Solution:   Add the "pum" option: use a popup menu to show the matches.
            (Yegappan Lakshmanan et al., closes #9707)
Files:      runtime/doc/options.txt, src/vim.h, src/cmdexpand.c,
            src/drawscreen.c, src/evalfunc.c, src/ex_getln.c, src/option.h,
            src/optionstr.c, src/popupmenu.c, src/proto/cmdexpand.pro,
            src/testdir/test_cmdline.vim,
            src/testdir/dumps/Test_wildmenu_pum_01.dump,
            src/testdir/dumps/Test_wildmenu_pum_02.dump,
            src/testdir/dumps/Test_wildmenu_pum_03.dump,
            src/testdir/dumps/Test_wildmenu_pum_04.dump,
            src/testdir/dumps/Test_wildmenu_pum_05.dump,
            src/testdir/dumps/Test_wildmenu_pum_06.dump,
            src/testdir/dumps/Test_wildmenu_pum_07.dump,
            src/testdir/dumps/Test_wildmenu_pum_08.dump,
            src/testdir/dumps/Test_wildmenu_pum_09.dump,
            src/testdir/dumps/Test_wildmenu_pum_10.dump,
            src/testdir/dumps/Test_wildmenu_pum_11.dump,
            src/testdir/dumps/Test_wildmenu_pum_12.dump,
            src/testdir/dumps/Test_wildmenu_pum_13.dump,
            src/testdir/dumps/Test_wildmenu_pum_14.dump,
            src/testdir/dumps/Test_wildmenu_pum_15.dump,
            src/testdir/dumps/Test_wildmenu_pum_16.dump,
            src/testdir/dumps/Test_wildmenu_pum_17.dump,
            src/testdir/dumps/Test_wildmenu_pum_18.dump,
            src/testdir/dumps/Test_wildmenu_pum_19.dump,
            src/testdir/dumps/Test_wildmenu_pum_20.dump,
            src/testdir/dumps/Test_wildmenu_pum_21.dump,
            src/testdir/dumps/Test_wildmenu_pum_22.dump,
            src/testdir/dumps/Test_wildmenu_pum_23.dump,
            src/testdir/dumps/Test_wildmenu_pum_24.dump,
            src/testdir/dumps/Test_wildmenu_pum_25.dump,
            src/testdir/dumps/Test_wildmenu_pum_26.dump,
            src/testdir/dumps/Test_wildmenu_pum_27.dump,
            src/testdir/dumps/Test_wildmenu_pum_28.dump,
            src/testdir/dumps/Test_wildmenu_pum_29.dump

Patch 8.2.4326
Problem:    "o" and "O" copying comment not sufficiently tested.
Solution:   Add a test case. (closes #9718)
Files:      src/testdir/test_textformat.vim

Patch 8.2.4327
Problem:    May end up with no current buffer.
Solution:   When deleting the current buffer to not pick a quickfix buffer as
            the new current buffer.
Files:      src/buffer.c, src/testdir/test_quickfix.vim

Patch 8.2.4328
Problem:    Command line complete matches cleared when typing character.
            (Dominique Pellé)
Solution:   Only remove a popup menu if there is one.
Files:      src/ex_getln.c, src/testdir/test_cmdline.vim,
            src/testdir/dumps/Test_wildmenu_pum_30.dump,
            src/testdir/dumps/Test_wildmenu_pum_31.dump

Patch 8.2.4329
Problem:    No support for end line number and column in 'errorformat'.
Solution:   Add %e and %k. (closes #9624)
Files:      runtime/doc/quickfix.txt, src/quickfix.c,
            src/testdir/test_quickfix.vim

Patch 8.2.4330
Problem:    Vim9: no error if script imports itself.
Solution:   Give an error when a script imports itself.
Files:      src/vim9script.c, src/errors.h, src/testdir/test_vim9_import.vim

Patch 8.2.4331
Problem:    Vim9: no test for existing script variable in block.
Solution:   Add a test.
Files:      src/testdir/test_vim9_func.vim

Patch 8.2.4332
Problem:    Vim9: incomplete test for existing script variable in block.
Solution:   Add a couple more tests.  Fix uncovered problem.
Files:      src/userfunc.c, src/vim9compile.c, src/proto/vim9compile.pro,
            src/vim9script.c, src/vim9expr.c, src/testdir/test_vim9_func.vim

Patch 8.2.4333
Problem:    cstack not always passed to where it is needed.
Solution:   Pass cstack through functions.
Files:      src/eval.c, src/vim9expr.c, src/vim9script.c,
            src/proto/vim9script.pro, src/vim9compile.c,
            src/proto/vim9compile.pro

Patch 8.2.4334
Problem:    Command line popup menu not positioned correctly.
Solution:   Also use vim_strsize() on the existing text. (Naruhiko Nishino,
            closes #9727)
Files:      src/cmdexpand.c, src/testdir/test_cmdline.vim,
            src/testdir/dumps/Test_wildmenu_pum_32.dump

Patch 8.2.4335
Problem:    No autocommand event triggered before changing directory. (Ronnie
            Magatti)
Solution:   Add DirChangedPre. (closes #9721)
Files:      runtime/doc/autocmd.txt, src/ex_docmd.c, src/proto/ex_docmd.pro,
            src/vim.h, src/autocmd.c, src/misc2.c,
            src/testdir/test_autocmd.vim

Patch 8.2.4336
Problem:    Using :filter for :scriptnames does not work. (Ben Jackson)
Solution:   Call message_filtered(). (closes #9720)
Files:      src/scriptfile.c, src/testdir/test_filter_cmd.vim

Patch 8.2.4337
Problem:    Part of condition is always true.
Solution:   Remove that part of the condition. (closes #9729)
Files:      src/filepath.c

Patch 8.2.4338
Problem:    An error from an expression mapping messes up the display.
Solution:   When the expression results in an empty string return K_IGNORE.
            In cmdline mode redraw the command line. (closes #9726)
Files:      src/getchar.c, src/testdir/test_mapping.vim,
            src/testdir/dumps/Test_map_expr_2.dump,
            src/testdir/dumps/Test_map_expr_3.dump,
            src/testdir/dumps/Test_map_expr_4.dump

Patch 8.2.4339
Problem:    CTRL-A does not work properly with the cmdline popup menu.
Solution:   Fix issues with CTRL-A.  Add more tests for the cmdline popup
            menu.  Remove TermWait() before VeriryScreenDump().  Refactor the
            cmdline popup code. (Yegappan Lakshmanan, closes #9735)
Files:      src/cmdexpand.c, src/ex_getln.c, src/popupmenu.c,
            src/testdir/screendump.vim, src/testdir/test_bufline.vim,
            src/testdir/test_cmdline.vim, src/testdir/test_conceal.vim,
            src/testdir/test_cursorline.vim, src/testdir/test_diffmode.vim,
            src/testdir/test_display.vim, src/testdir/test_highlight.vim,
            src/testdir/test_match.vim, src/testdir/test_popup.vim,
            src/testdir/test_search_stat.vim, src/testdir/test_terminal.vim,
            src/testdir/test_textprop.vim,
            src/testdir/dumps/Test_wildmenu_pum_33.dump,
            src/testdir/dumps/Test_wildmenu_pum_34.dump,
            src/testdir/dumps/Test_wildmenu_pum_35.dump,
            src/testdir/dumps/Test_wildmenu_pum_36.dump,
            src/testdir/dumps/Test_wildmenu_pum_37.dump

Patch 8.2.4340
Problem:    Amiga: mch_can_exe() is not implemented.
Solution:   Implement mch_can_exe() for Amiga OS 4. (Ola Söder, closes #9731)
Files:      src/os_amiga.c

Patch 8.2.4341
Problem:    Command line not redrawn when finishing popup menu and the screen
            has scrolled up.
Solution:   Redraw the command line after updating the screen. (closes #9722)
Files:      src/cmdexpand.c, src/testdir/test_cmdline.vim,
            src/testdir/dumps/Test_wildmenu_pum_38.dump

Patch 8.2.4342
Problem:    CI will soon switch to other windows version.
Solution:   Use "windows-2019" instead of "windows-latest". (Ozaki Kiichi,
            closes #9740)
Files:      .github/workflows/ci.yml

Patch 8.2.4343
Problem:    When reloading not all properties are detected.
Solution:   Add the "edit" value to v:fcs_choice. (Rob Pilling, closes #9579)
Files:      runtime/doc/editing.txt, runtime/doc/eval.txt, src/fileio.c,
            src/proto/fileio.pro, src/message.c, src/spellfile.c,
            src/testdir/test_filechanged.vim

Patch 8.2.4344
Problem:    Amiga: header file included twice.
Solution:   Remove #include. (Ola Söder, closes #9733)
Files:      src/memfile.c

Patch 8.2.4345
Problem:    <amatch> is expanded like a file name for DirChangedPre.
Solution:   Do not expand <amatch>. (closes #9742)  Also for the User event.
Files:      src/autocmd.c, src/testdir/test_autocmd.vim

Patch 8.2.4346
Problem:    A custom statusline may cause Esc to work like Enter on the
            command line when the popup menu is displayed.
Solution:   Save and restore KeyTyped. (closes #9749)
Files:      src/drawscreen.c, src/testdir/test_cmdline.vim,
            src/testdir/dumps/Test_wildmenu_pum_39.dump

Patch 8.2.4347
Problem:    In some build setups UNUSED is not defined.
Solution:   Change the logic of how UNUSED is defined. (Ola Söder,
            closes #9734)
Files:      src/vim.h

Patch 8.2.4348
Problem:    "legacy exe cmd" does not do what one would expect.
Solution:   Apply the "legacy" and "vim9script" command modifiers to the
            argument of ":execute".
Files:      runtime/doc/vim9.txt, src/globals.h, src/eval.c, src/ex_docmd.c,
            src/testdir/test_vim9_cmd.vim

Patch 8.2.4349
Problem:    FileChangedShell test fails on MS-Windows.
Solution:   Skip the test on MS-Windows.
Files:      src/testdir/test_filechanged.vim

Patch 8.2.4350
Problem:    FEAT_GUI_ENABLED defined but never used.
Solution:   Remove the #define. (Ola Söder, closes #9732)
Files:      src/vim.h

Patch 8.2.4351
Problem:    No coverage is measured on MS-Windows CI.
Solution:   Enable coverage on MS-Windows. (Ozaki Kiichi, closes #9750)
Files:      .github/workflows/ci.yml

Patch 8.2.4352
Problem:    ReScript files are not recognized.
Solution:   Add the *.res and *.resi patterns. (Ananda Umamil, closes #9752)
Files:      runtime/filetype.vim, src/testdir/test_filetype.vim

Patch 8.2.4353
Problem:    CI does not use the latest Lua and Python.
Solution:   Use Lua 5.4.2 and Python 3.10. (closes #9744)
Files:      .github/workflows/ci.yml

Patch 8.2.4354
Problem:    Dynamic loading of libsodium not handled properly.
Solution:   Fix has() and :version. Show an error message when loading fails.
            Fix memory leaks. (Ken Takata, closes #9754)
Files:      src/crypt.c, src/evalfunc.c, src/gui_dwrite.cpp, src/if_cscope.c,
            src/os_win32.c, src/proto/crypt.pro, src/proto/os_win32.pro,
            src/version.c

Patch 8.2.4355
Problem:    Unnecessary call to check_colorcolumn().
Solution:   Remove the call. (Sean Dewar, closes #9748)
Files:      src/option.c, src/window.c

Patch 8.2.4356
Problem:    Command line completion functions are very long.
Solution:   Refactor into multiple functions. (Yegappan Lakshmanan,
            closes #9753)
Files:      src/cmdexpand.c

Patch 8.2.4357 (after 8.2.4348)
Problem:    sticky command modifiers are too sticky.
Solution:   Do not apply command modifiers to a sourced script. (closes #9751)
Files:      src/scriptfile.c, src/testdir/test_vim9_cmd.vim

Patch 8.2.4358
Problem:    Vim9: line number of exception is not set.
Solution:   Set the line number before throwing an exception. (closes #9755)
Files:      src/vim9execute.c, src/testdir/test_vim9_script.vim

Patch 8.2.4359
Problem:    crash when repeatedly using :retab.
Solution:   Bail out when the line is getting too long.
Files:      src/indent.c, src/testdir/test_retab.vim

Patch 8.2.4360
Problem:    Vim9: allowing use of "s:" leads to inconsistencies.
Solution:   Disallow using "s:" in Vim9 script at the script level.
Files:      src/userfunc.c, src/proto/userfunc.pro, src/errors.h,
            src/vim9compile.c, src/eval.c, src/testdir/vim9.vim,
            src/testdir/test_vim9_assign.vim,
            src/testdir/test_vim9_builtin.vim, src/testdir/test_vim9_cmd.vim,
            src/testdir/test_vim9_disassemble.vim,
            src/testdir/test_vim9_expr.vim, src/testdir/test_vim9_func.vim,
            src/testdir/test_vim9_import.vim, src/testdir/test_vim9_script.vim

Patch 8.2.4361 (after 8.2.4360)
Problem:    Vim9: some tests fail.
Solution:   Fix the tests, mostly by removing "s:".
Files:      src/testdir/test_expr.vim, src/testdir/test_functions.vim,
            src/testdir/test_ins_complete.vim, src/testdir/test_normal.vim,
            src/testdir/test_tagfunc.vim

Patch 8.2.4362
Problem:    :retab may allocate too much memory.
Solution:   Bail out when allocating more than MAXCOL bytes.
Files:      src/indent.c

Patch 8.2.4363
Problem:    MS-Windows: running out of memory for a very long line.
Solution:   Use a 32 bit value for MAXCOL also when ints are 64 bits.
Files:      src/vim.h

Patch 8.2.4364
Problem:    MS-Windows: still running out of memory for a very long line.
Solution:   Check for negative length.
Files:      src/indent.c

Patch 8.2.4365 (after 8.2.4348)
Problem:    sticky command modifiers are too sticky.
Solution:   Do not apply command modifiers to a called function. (closes #9751)
Files:      src/userfunc.c, src/testdir/test_vim9_cmd.vim

Patch 8.2.4366
Problem:    Not enough tests for command line completion.
Solution:   Add a few more tests. (Yegappan Lakshmanan, closes #9760)
Files:      src/cmdexpand.c, src/testdir/test_cmdline.vim,
            src/testdir/test_usercommands.vim

Patch 8.2.4367
Problem:    Calling in_vim9script() multiple times.
Solution:   Call it once and keep the result.
Files:      src/userfunc.c, src/eval.c

Patch 8.2.4368
Problem:    Amiga: a few compiler warnings.
Solution:   Adjust #ifdefs. Add "UNUSED". (Ola Söder, closes #9756,
            closes #9757)
Files:      src/term.c, src/os_amiga.c

Patch 8.2.4369
Problem:    Redundant #ifdef argument.
Solution:   Remove unused MSWIN. (Ola Söder, closes #9758)
Files:      src/feature.h

Patch 8.2.4370
Problem:    MS-Windows: libsodium.dll not included with the installer.
Solution:   Add the file to the installer if it exists. (Christian Brabandt,
            closes #9762)
Files:      nsis/gvim.nsi

Patch 8.2.4371
Problem:    Vim9: can create a script variable from a legacy function.
Solution:   Disallow creating a script variable from a function.
Files:      src/evalvars.c, src/errors.h, src/testdir/test_vim9_script.vim

Patch 8.2.4372
Problem:    Filetype detection from file contents is in legacy script.
Solution:   Use a compiled function for filetype detection.
Files:      runtime/scripts.vim, runtime/autoload/dist/script.vim

Patch 8.2.4373
Problem:    Expression test fails.
Solution:   Make the test work with latest Vim9 syntax.
Files:      src/testdir/test_expr.vim

Patch 8.2.4374
Problem:    Unreachable code.
Solution:   Remove outdated code lines.
Files:      src/vim9compile.c

Patch 8.2.4375
Problem:    ctx_imports is not used.
Solution:   Delete ctx_imports.  Add missing dependency.
Files:      src/vim9.h, src/vim9compile.c, src/proto/vim9compile.pro,
            src/eval.c, src/evalfunc.c, src/evalvars.c, src/userfunc.c,
            src/vim9expr.c, src/vim9script.c, src/Makefile

Patch 8.2.4376
Problem:    Not enough tests for command line completion.
Solution:   Add a few more tests. (Yegappan Lakshmanan, closes #9771)
Files:      src/testdir/test_cmdline.vim, src/testdir/test_usercommands.vim

Patch 8.2.4377
Problem:    CI steps for Windows are a bit unorganized.
Solution:   Organize CI test steps on Windows. (Ozaki Kiichi, closes #9764)
Files:      .github/workflows/ci.yml

Patch 8.2.4378
Problem:    Incsearch highlight broken when calling searchcount() in 'tabLine'
            function. (Mirko Palmer)
Solution:   Save and restore the incsearch state. (Christian Brabandt,
            closes #9763, closes #9633)
Files:      src/search.c, src/testdir/test_search_stat.vim,
            src/testdir/dumps/Test_searchstat_inc_1.dump,
            src/testdir/dumps/Test_searchstat_inc_2.dump,
            src/testdir/dumps/Test_searchstat_inc_3.dump

Patch 8.2.4379
Problem:    An empty change is reported to a listener.
Solution:   Do not report an empty change. (closes #9768)  Remove unused
            return value.
Files:      src/undo.c, src/change.c, src/testdir/test_listener.vim

Patch 8.2.4380
Problem:    Small differences between Chinese translation files.
Solution:   Add rule for converting UTF-8 to gb2312. (closes #9773)
Files:      src/po/Makefile, src/po/Make_all.mak

Patch 8.2.4381 (after 8.2.4380)
Problem:    Translation file listed twice.
Solution:   Remove one entry.
Files:      src/po/Make_all.mak

Patch 8.2.4382 (after 8.2.4346)
Problem:    A custom 'tabline' may cause Esc to work like Enter on the
            command line when the popup menu is displayed.
Solution:   Save and restore KeyTyped. (closes #9776)
Files:      src/drawscreen.c, src/screen.c, src/testdir/test_cmdline.vim,
            src/testdir/dumps/Test_wildmenu_pum_40.dump

Patch 8.2.4383
Problem:    Vim9: unused code lines.
Solution:   Rely on either "cctx" or "cstack" to not be NULL.
Files:      src/vim9compile.c

Patch 8.2.4384
Problem:    Vim9: error message not tested, some code not tested.
Solution:   Add a couple of test cases.  Give an error for a command modifier
            without a command.
Files:      src/errors.h, src/vim9compile.c, src/ex_docmd.c,
            src/testdir/test_vim9_assign.vim, src/testdir/test_vim9_cmd.vim

Patch 8.2.4385 (after 8.2.4384)
Problem:    Cannot build tiny version.
Solution:   Adjust #ifdefs.
Files:      src/errors.h

Patch 8.2.4386 (after 8.2.4384)
Problem:    Still cannot build tiny version.
Solution:   Adjust #ifdefs.
Files:      src/ex_docmd.c

Patch 8.2.4387
Problem:    Command line completion doesn't always work properly.
Solution:   Adjust triggering after a "|".  Add more tests. (Yegappan
            Lakshmanan, closes #9779)
Files:      src/cmdexpand.c, src/testdir/test_cmdline.vim

Patch 8.2.4388
Problem:    Dead code in op_insert().
Solution:   Remove condition and else block. (closes #9782)
Files:      src/ops.c

Patch 8.2.4389
Problem:    screenpos() does not handle a position in a closed fold.
Solution:   Check if the position is inside a closed fold. (closes #9778)
Files:      src/move.c, src/testdir/test_cursor_func.vim

Patch 8.2.4390
Problem:    Vim9: list from declaration with inferred type does not set the
            type on the value.
Solution:   When inferring the type in a variable declaration also set the
            type of the list or dictionary. (closes #9705)  Do not set the
            type when the member is "any".
Files:      src/vim9compile.c, src/testdir/test_vim9_assign.vim,
            src/testdir/test_vim9_builtin.vim,
            src/testdir/test_vim9_disassemble.vim

Patch 8.2.4391
Problem:    Command line executed when typing Esc in the GUI.
Solution:   Move saving/restoring KeyTyped to build_stl_str_hl().
            (closes #9783)
Files:      src/buffer.c, src/screen.c

Patch 8.2.4392 (after 8.2.4002)
Problem:    MS-Windows with VIMDLL: Escaping CSI is wrong.
Solution:   Put back #ifdef. (Ken Takata, closes #9769)
Files:      src/getchar.c

Patch 8.2.4393
Problem:    Possible number overflow with nested folds.
Solution:   Avoid a negative line number.
Files:      src/fold.c

Patch 8.2.4394 (after 8.2.4392)
Problem:    UTF8 select mode test fails on MS-Windows.
Solution:   Revert the #ifdef change.
Files:      src/getchar.c

Patch 8.2.4395
Problem:    Some code lines not covered by tests.
Solution:   Add a few more test cases.  Fix getting more than one error for
            invalid assignment.
Files:      src/evalvars.c, src/errors.h, src/vim9compile.c,
            src/testdir/test_vim9_assign.vim, src/testdir/test_vim9_cmd.vim,
            src/testdir/test_vim9_func.vim

Patch 8.2.4396 (after 8.2.4395)
Problem:    Python3 test fails.
Solution:   Remove "let".
Files:      src/testdir/test_vim9_func.vim

Patch 8.2.4397
Problem:    Crash when using many composing characters in error message.
Solution:   Use mb_cptr2char_adv() instead of mb_ptr2char_adv().
Files:      src/testing.c, src/testdir/test_assert.vim

Patch 8.2.4398
Problem:    Some command completion functions are too long.
Solution:   Refactor code into separate functions.  Add a few more tests.
            (Yegappan Lakshmanan, closes #9785)
Files:      src/cmdexpand.c, src/ex_getln.c, src/usercmd.c,
            src/proto/usercmd.pro, src/testdir/test_cmdline.vim

Patch 8.2.4399
Problem:    Crash after ml_get error.
Solution:   When returning "???" flush the line and set ml_line_lnum.
Files:      src/memline.c

Patch 8.2.4400 (after 8.2.4394)
Problem:    MS-Windows: cannot use the mouse in the console with VIMDLL.
Solution:   use add_char2buf() instead of fix_input_buffer(). (closes #9784,
            closes #9769)
Files:      src/getchar.c

Patch 8.2.4401
Problem:    Map listing does not clear the rest of the command line.
Solution:   Call msg_clear_eos(). (closes #5623, closes #5962)
Files:      src/map.c, src/testdir/test_mapping.vim,
            src/testdir/dumps/Test_map_list_1.dump

Patch 8.2.4402
Problem:    Missing parenthesis may cause unexpected problems.
Solution:   Add more parenthesis is macros. (closes #9788)
Files:      src/autocmd.c, src/charset.c, src/drawline.c, src/drawscreen.c,
            src/evalfunc.c, src/fileio.c, src/fold.c, src/getchar.c,
            src/highlight.c, src/memline.c, src/normal.c, src/quickfix.c,
            src/regexp.c, src/search.c, src/sha256.c, src/spell.c,
            src/spellfile.c, src/spellsuggest.c, src/syntax.c, src/window.c

Patch 8.2.4403
Problem:    ml_get error with nested folds and deleting lines.
Solution:   Correct the last line number before calling hasFoldingWin().
Files:      src/change.c

Patch 8.2.4404
Problem:    Vim9: some code not covered by tests.
Solution:   Add a few specific test cases.
Files:      src/vim9execute.c, src/testdir/test_vim9_func.vim,
            src/testdir/test_vim9_import.vim

Patch 8.2.4405
Problem:    Compiler warning for unused variable without the +folding feature.
            (Tony Mechelynck)
Solution:   Add #ifdef.
Files:      src/change.c

Patch 8.2.4406
Problem:    Expand functions use confusing argument names.
Solution:   Rename "file" to "match".  Refactor some completion code.  Add a
            few more tests. (Yegappan Lakshmanan, closes #9790)
Files:      src/cmdexpand.c, src/testdir/test_usercommands.vim

Patch 8.2.4407
Problem:    Vim9: some code not covered by tests.
Solution:   Add more tests.  Avoid giving two errors.  Remove dead code.
Files:      src/vim9execute.c, src/testdir/test_vim9_assign.vim,
            src/testdir/test_vim9_cmd.vim, src/testdir/test_vim9_func.vim

Patch 8.2.4408
Problem:    Vim9: some code not covered by tests.
Solution:   Add a few more tests.  Correct error message.  Allow unlet on dict
            with a number key.
Files:      src/vim9execute.c, src/errors.h, src/testdir/test_vim9_assign.vim

Patch 8.2.4409
Problem:    Vim9: some code not covered by tests.
Solution:   Add a few more tests.  Fix reported line number.
Files:      src/vim9execute.c, src/testdir/test_vim9_assign.vim

Patch 8.2.4410
Problem:    Vim9: some code not covered by tests.
Solution:   Add a few more tests. Remove dead code.
Files:      src/vim9execute.c, src/testdir/test_vim9_assign.vim,
            src/testdir/test_vim9_cmd.vim, src/testdir/test_vim9_expr.vim,
            src/testdir/test_vim9_script.vim

Patch 8.2.4411
Problem:    Bicep files are not recognized.
Solution:   Match *.bicep files. (Dundar Goc, closes #9791)
Files:      runtime/filetype.vim, src/testdir/test_filetype.vim

Patch 8.2.4412
Problem:    Translation cleanup script does not remove empty lines at end.
Solution:   Remove empty lines at the end. (Ken Takata, closes #9794)
Files:      src/po/cleanup.vim

Patch 8.2.4413
Problem:    Vim9: Coverity warns for using NULL pointer.
Solution:   Give an internal error when funcref function can't be found.
Files:      src/vim9execute.c

Patch 8.2.4414
Problem:    Solidity files are not recognized.
Solution:   Add the *.sol pattern. (Dundar Goc, closes #9792)
Files:      runtime/filetype.vim, src/testdir/test_filetype.vim

Patch 8.2.4415
Problem:    Function argument name conflicts with C++ keyword.
Solution:   Rename the argument.
Files:      src/usercmd.c, src/proto/usercmd.pro

Patch 8.2.4416
Problem:    Vim9: using a script-local function requires using "s:" when
            setting 'completefunc'.
Solution:   Do not require "s:" in Vim9 script. (closes #9796)
Files:      runtime/doc/options.txt, src/userfunc.c,
            src/testdir/test_ins_complete.vim

Patch 8.2.4417 (after 8.2.4416)
Problem:    Using NULL pointer.
Solution:   Set offset after checking for NULL pointer.
Files:      src/userfunc.c

Patch 8.2.4418
Problem:    Crash when using special multi-byte character.
Solution:   Don't use isalpha() for an arbitrary character.
Files:      src/charset.c, src/proto/charset.pro, src/filepath.c,
            src/testdir/test_autochdir.vim

Patch 8.2.4419
Problem:    Illegal memory access when using exactly 20 highlights.
Solution:   Add one more item in the array. (Brandon Richardson,
            closes #9800)
Files:      src/buffer.c, src/testdir/test_tabline.vim

Patch 8.2.4420
Problem:    Menu translations are inconsistent.
Solution:   Add a Makefile to convert between encodings. (Ada (Haowen) Yu,
            closes #9801)
Files:      runtime/lang/Makefile, runtime/lang/menu_af_af.latin1.vim,
            runtime/lang/menu_ca_es.latin1.vim,
            runtime/lang/menu_chinese_gb.936.vim,
            runtime/lang/menu_chinese_taiwan.950.vim,
            runtime/lang/menu_cs_cz.iso_8859-2.vim,
            runtime/lang/menu_cs_cz.utf-8.vim,
            runtime/lang/menu_czech_czech_republic.1250.vim,
            runtime/lang/menu_czech_czech_republic.ascii.vim,
            runtime/lang/menu_da.utf-8.vim,
            runtime/lang/menu_de_de.latin1.vim,
            runtime/lang/menu_eo.utf-8.vim,
            runtime/lang/menu_es_es.latin1.vim,
            runtime/lang/menu_fi_fi.latin1.vim,
            runtime/lang/menu_fr_fr.latin1.vim,
            runtime/lang/menu_hu_hu.iso_8859-2.vim,
            runtime/lang/menu_hu_hu.utf-8.vim,
            runtime/lang/menu_is_is.latin1.vim,
            runtime/lang/menu_it_it.latin1.vim,
            runtime/lang/menu_ja_jp.euc-jp.vim,
            runtime/lang/menu_ja_jp.utf-8.vim,
            runtime/lang/menu_japanese_japan.932.vim,
            runtime/lang/menu_ko_kr.euckr.vim,
            runtime/lang/menu_ko_kr.utf-8.vim,
            runtime/lang/menu_nl_nl.latin1.vim,
            runtime/lang/menu_no_no.latin1.vim,
            runtime/lang/menu_pl_pl.iso_8859-2.vim,
            runtime/lang/menu_pl_pl.utf-8.vim,
            runtime/lang/menu_polish_poland.1250.vim,
