Files:	    src/if_py_both.h

Patch 8.1.1362
Problem:    Code and data in tests can be hard to read.
Solution:   Use the new heredoc style. (Yegappan Lakshmanan, closes #4400)
Files:	    src/testdir/test_autocmd.vim, src/testdir/test_balloon.vim,
            src/testdir/test_bufline.vim, src/testdir/test_cindent.vim,
            src/testdir/test_conceal.vim, src/testdir/test_exit.vim,
            src/testdir/test_fold.vim, src/testdir/test_goto.vim,
            src/testdir/test_join.vim, src/testdir/test_mksession_utf8.vim,
            src/testdir/test_normal.vim, src/testdir/test_profile.vim,
            src/testdir/test_quickfix.vim, src/testdir/test_startup.vim,
            src/testdir/test_terminal.vim, src/testdir/test_xxd.vim

Patch 8.1.1363
Problem:    ":vert options" does not make a vertical split.
Solution:   Pass the right modifiers in $OPTWIN_CMD. (Ken Takata,
            closes #4401)
Files:	    src/ex_cmds2.c, src/testdir/test_options.vim

Patch 8.1.1364
Problem:    Design for popup window support needs more details.
Solution:   Add details about using a window and buffer.  Rename popup_show()
            to popup_create() and add popup_show() and popup_hide().
Files:	    runtime/doc/popup.txt

Patch 8.1.1365
Problem:    Source command doesn't check for the sandbox. (Armin Razmjou)
Solution:   Check for the sandbox when sourcing a file.
Files:	    src/getchar.c, src/testdir/test_source.vim

Patch 8.1.1366
Problem:    Using expressions in a modeline is unsafe.
Solution:   Disallow using expressions in a modeline, unless the
            'modelineexpr' option is set.  Update help, add more tests.
Files:	    runtime/doc/options.txt, src/option.c, src/option.h,
            src/testdir/test_modeline.vim, src/testdir/test49.in

Patch 8.1.1367 (after 8.1.1366)
Problem:    can set 'modelineexpr' in modeline.
Solution:   Add P_SECURE flag.
Files:	    src/option.c, src/testdir/test_modeline.vim

Patch 8.1.1368 (after 8.1.1366)
Problem:    Modeline test fails with python but without pythonhome.
Solution:   Correct test argument.
Files:	    src/testdir/test_modeline.vim

Patch 8.1.1369
Problem:    Get E484 when using system() during GUI startup.
Solution:   Check "gui.starting". (Ken Takata)
Files:	    src/os_win32.c

Patch 8.1.1370
Problem:    Not using the new github feature for donations.
Solution:   Add a Sponsor button. (closes #4417)
Files:	    .github/FUNDING.yml

Patch 8.1.1371
Problem:    Cannot recover from a swap file.
Solution:   Do not expand environment variables in the swap file name.
            Do not check the extension when we already know a file is a swap
            file.  (Ken Takata, closes #4415, closes #4369)
Files:	    src/buffer.c, src/ex_cmds.c, src/ex_cmds2.c, src/ex_docmd.c,
            src/gui.c, src/if_cscope.c, src/main.c, src/memline.c,
            src/misc1.c, src/proto/memline.pro, src/proto/misc1.pro,
            src/search.c, src/spell.c, src/spellfile.c, src/tag.c,
            src/testdir/test_swap.vim, src/vim.h

Patch 8.1.1372
Problem:    When evaluating 'statusline' the current window is unknown.
            (Daniel Hahler)
Solution:   Set "g:actual_curwin" for %{} items.  Set "g:statusline_winid"
            when evaluating %!. (closes #4406, closes #3299)
Files:	    src/buffer.c, runtime/doc/options.txt,
            src/testdir/test_statusline.vim

Patch 8.1.1373
Problem:    "[p" in Visual mode puts in wrong line.
Solution:   Call nv_put() instead of duplicating the functionality.
            (closes #4408)
Files:	    src/normal.c, src/testdir/test_put.vim

Patch 8.1.1374
Problem:    Check for file changed triggers too often.
Solution:   Don't use "b_p_ar" when it is negative.
Files:	    src/fileio.c

Patch 8.1.1375
Problem:    Without "TS" in 'shortmess' get a hit-enter prompt often.
Solution:   Always truncate the search message.  Also avoid putting it in the
            message history. (closes #4413)
Files:	    src/search.c, src/main.c, src/testdir/test_search_stat.vim

Patch 8.1.1376
Problem:    Warnings for size_t/int mixups.
Solution:   Change types, add type casts. (Mike Williams)
Files:	    src/search.c, src/textprop.c

Patch 8.1.1377
Problem:    MS-Windows GUI uses wrong shell command for bash. (Robert Bogomip)
Solution:   Check that 'shellcmdflag' is "/c". (Ken Takata, closes #4418)
Files:	    src/os_win32.c

Patch 8.1.1378
Problem:    Delete() can not handle a file name that looks like a pattern.
Solution:   Use readdir() instead of appending "/*" and expanding wildcards.
            (Ken Takata, closes #4424, closes #696)
Files:	    src/testdir/test_functions.vim, src/evalfunc.c, src/fileio.c,
            src/proto/fileio.pro

Patch 8.1.1379 (after 8.1.1374)
Problem:    Filechanged test hangs.
Solution:   Do not check 'autoread'.
Files:	    src/fileio.c, src/testdir/test_filechanged.vim

Patch 8.1.1380
Problem:    MS-Windows building VIMDLL with MSVC: SUBSYSTEM is not set.
Solution:   Invert condition. (Ken Takata, closes #4422)
Files:	    src/Make_mvc.mak

Patch 8.1.1381
Problem:    MS-Windows: missing build dependency.
Solution:   Make gui_dwrite.cpp depend on gui_dwrite.h. (Ken Takata,
            closes #4423)
Files:	    src/Make_cyg_ming.mak, src/Make_mvc.mak

Patch 8.1.1382
Problem:    Error when editing test file.
Solution:   Remove part of modeline.
Files:	    src/testdir/test_vimscript.vim, src/testdir/test49.vim,
            src/testdir/test49.in

Patch 8.1.1383
Problem:    Warning for size_t/int mixup.
Solution:   Change type. (Mike Williams)
Files:	    src/search.c

Patch 8.1.1384
Problem:    Using "int" for alloc() often results in compiler warnings.
Solution:   Use "size_t" and remove type casts.  Remove alloc_check(), Vim
            only works with 32 bit ints anyway.
Files:	    src/misc2.c, src/proto/misc2.pro, src/change.c, src/ex_cmds.c,
            src/netbeans.c, src/autocmd.c, src/buffer.c, src/change.c,
            src/channel.c, src/charset.c, src/debugger.c, src/dict.c,
            src/diff.c, src/digraph.c, src/edit.c, src/eval.c, src/evalfunc.c,
            src/ex_cmds.c, src/ex_cmds2.c, src/ex_docmd.c, src/ex_eval.c,
            src/ex_getln.c, src/fileio.c, src/findfile.c, src/fold.c,
            src/getchar.c, src/gui.c, src/gui_at_fs.c, src/gui_gtk.c,
            src/gui_gtk_x11.c, src/gui_motif.c, src/gui_w32.c, src/hashtab.c,
            src/if_cscope.c, src/if_perlsfio.c, src/if_python3.c,
            src/if_xcmdsrv.c, src/indent.c, src/insexpand.c, src/main.c,
            src/mbyte.c, src/memfile.c, src/memline.c, src/menu.c,
            src/message.c, src/misc1.c, src/misc2.c, src/netbeans.c,
            src/ops.c, src/option.c, src/os_amiga.c, src/os_mswin.c,
            src/os_unix.c, src/os_vms.c, src/os_win32.c, src/quickfix.c,
            src/regexp.c, src/screen.c, src/spell.c, src/spellfile.c,
            src/syntax.c, src/term.c, src/undo.c, src/usercmd.c,
            src/userfunc.c, src/version.c, src/winclip.c

Patch 8.1.1385
Problem:    Signed/unsigned compiler warning.
Solution:   Use STRLEN() instead of strlen().
Files:	    src/fileio.c

Patch 8.1.1386
Problem:    Unnecessary type casts for lalloc().
Solution:   Remove type casts.  Change lalloc(size, TRUE) to alloc(size).
Files:	    src/buffer.c, src/change.c, src/channel.c, src/diff.c, src/edit.c,
            src/eval.c, src/ex_cmds.c, src/ex_getln.c, src/fileio.c,
            src/getchar.c, src/gui_mac.c, src/insexpand.c, src/gui_w32.c,
            src/gui_x11.c, src/menu.c, src/netbeans.c, src/ops.c,
            src/os_mswin.c, src/os_amiga.c, src/os_qnx.c, src/os_unix.c,
            src/os_win32.c, src/popupmnu.c, src/quickfix.c, src/regexp.c,
            src/regexp_nfa.c, src/screen.c, src/search.c, src/sign.c,
            src/spell.c, src/spellfile.c, src/syntax.c, src/tag.c,
            src/terminal.c, src/textprop.c, src/ui.c, src/undo.c,
            src/userfunc.c, src/winclip.c, src/window.c

Patch 8.1.1387
Problem:    Calling prop_add() in an empty buffer doesn't work. (Dominique
            Pelle)
Solution:   Open the memline before adding a text property. (closes #4412)
Files:	    src/textprop.c, src/testdir/test_textprop.vim

Patch 8.1.1388
Problem:    Errors when calling prop_remove() for an unloaded buffer.
Solution:   Bail out when the buffer is not loaded.  Add a few more tests for
            failing when the buffer number is invalid.
Files:	    src/textprop.c, src/testdir/test_textprop.vim

Patch 8.1.1389
Problem:    Changes are not flushed when end and start overlap. (Paul Jolly)
Solution:   When end of a previous changes overlaps with start of a new
            change, first flush listeners.
Files:	    src/change.c, src/testdir/test_listener.vim

Patch 8.1.1390
Problem:    Search stats are off when using count or offset.
Solution:   Recompute the stats when needed. (Masato Nishihata, closes #4410)
Files:	    src/testdir/test_search_stat.vim, src/search.c

Patch 8.1.1391
Problem:    No popup window support.
Solution:   Add initial code for popup windows.  Add the 'wincolor' option.
Files:	    Filelist, runtime/doc/popup.txt, runtime/doc/options.txt,
            src/Make_cyg_ming.mak, src/Make_mvc.mak, src/Make_vms.mms,
            src/Makefile, src/autocmd.c, src/buffer.c, src/ex_cmds.h,
            src/ex_cmdidxs.h, src/proto/buffer.pro, src/eval.c src/evalfunc.c
            src/feature.h, src/globals.h, src/option.c, src/option.h,
            src/popupwin.c, src/proto.h, src/proto/popupwin.pro,
            src/proto/window.pro, src/screen.c, src/structs.h, src/terminal.c,
            src/testdir/Make_all.mak, src/testdir/dumps/Test_popupwin_01.dump,
            src/testdir/test_popupwin.vim, src/vim.h, src/window.c

Patch 8.1.1392 (after 8.1.1391)
Problem:    Build failure in tiny version.
Solution:   Define ex_popupclear to ex_ni if not implemented.  Add UNUSED.
Files:	    src/ex_docmd.c, src/window.c

Patch 8.1.1393
Problem:    Unnecessary type casts.
Solution:   Remove type casts from alloc() and lalloc() calls. (Mike Williams)
Files:	    src/channel.c, src/crypt.c, src/dict.c, src/dosinst.c,
            src/evalfunc.c, src/ex_cmds.c, src/ex_cmds2.c, src/ex_docmd.c,
            src/ex_getln.c, src/fileio.c, src/findfile.c, src/if_ole.cpp,
            src/if_py_both.h, src/list.c, src/message.c, src/misc1.c,
            src/misc2.c, src/ops.c, src/os_vms.c, src/os_win32.c,
            src/quickfix.c, src/regexp_nfa.c, src/screen.c, src/search.c,
            src/sign.c, src/syntax.c, src/tag.c, src/term.c, src/terminal.c,
            src/textprop.c

Patch 8.1.1394
Problem:    Not restoring t_F2 in registers test.
Solution:   Assign to &t_F2 instead of t_F2. (Andy Massimino, closes #4434)
Files:	    src/testdir/test_registers.vim

Patch 8.1.1395
Problem:    Saving for undo may access invalid memory. (Dominique Pelle)
Solution:   Set ml_line_len also when returning a constant string.
Files:	    src/memline.c, src/testdir/test_textprop.vim

Patch 8.1.1396
Problem:    'wincolor' does not apply to lines below the buffer.
Solution:   Also apply 'wincolor' to the "~" lines and the number column.
Files:	    src/screen.c, src/testdir/test_highlight.vim,
            src/testdir/dumps/Test_wincolor_01.dump

Patch 8.1.1397
Problem:    Build fails in tiny version.
Solution:   Always define hl_combine_attr().
Files:	    src/syntax.c

Patch 8.1.1398
Problem:    Duplicate line in MSVC build file.
Solution:   Remove the line. (Ken Takata, closes #4436)
Files:	    src/Make_mvc.mak

Patch 8.1.1399
Problem:    Popup windows not adjusted when switching tabs.
Solution:   Save and restore first_tab_popupwin. Fix closing a tabpage.
Files:	    src/window.c, src/popupwin.c, src/proto/popupwin.pro,
            src/testdir/test_popupwin.vim,
            src/testdir/dumps/Test_popupwin_02.dump,
            src/testdir/dumps/Test_popupwin_03.dump,
            src/testdir/dumps/Test_popupwin_04.dump

Patch 8.1.1400
Problem:    Using global pointer for tab-local popups is clumsy.
Solution:   Use the pointer in tabpage_T.
Files:	    src/popupwin.c, src/globals.h, src/eval.c, src/screen.c,
            src/window.c

Patch 8.1.1401
Problem:    Misspelled mkspellmem as makespellmem.
Solution:   Drop duplicate help entry, fix test. (Naruhiko Nishino, Yasuhiro
            Matsumoto, closes #4437)
Files:	    runtime/doc/options.txt, src/testdir/test_modeline.vim

Patch 8.1.1402
Problem:    "timer" option of popup windows not supported.
Solution:   Implement the "timer" option. (Yasuhiro Matsumoto, closes #4439)
Files:	    src/structs.h, src/testdir/test_popupwin.vim, src/popupwin.c,
            src/window.c, runtime/doc/popup.txt

Patch 8.1.1403
Problem:    Cannot build without the timer feature.
Solution:   Add #ifdef.
Files:	    src/structs.h, src/window.c, src/popupwin.c,
            src/testdir/test_popupwin.vim

Patch 8.1.1404
Problem:    Cannot change the patch level when building with NSIS.
Solution:   Use $PATCHLEVEL if defined. (Christian Brabandt)
Files:	    nsis/gvim.nsi

Patch 8.1.1405
Problem:    "highlight" option of popup windows not supported.
Solution:   Implement the "highlight" option.
Files:	    src/option.c, src/proto/option.pro, src/diff.c src/popupwin.c,
            runtime/doc/popup.txt, src/testdir/test_popupwin.vim,
            src/testdir/dumps/Test_popupwin_01.dump,
            src/testdir/dumps/Test_popupwin_03.dump

Patch 8.1.1406
Problem:    popup_hide() and popup_show() not implemented yet.
Solution:   Implement the functions.
Files:	    src/popupwin.c, src/proto/popupwin.pro, src/evalfunc.c,
            src/structs.h, runtime/doc/popup.txt, src/screen.c, src/vim.h,
            src/testdir/test_popupwin.vim

Patch 8.1.1407
Problem:    Popup_create() does not support text properties.
Solution:   Support the third form of the text argument.
Files:	    src/textprop.c, src/proto/textprop.pro, src/popupwin.c,
            src/testdir/test_popupwin.vim, src/screen.c,
            src/testdir/dumps/Test_popupwin_02.dump,
            src/testdir/dumps/Test_popupwin_03.dump,
            src/testdir/dumps/Test_popupwin_04.dump,
            runtime/doc/popup.txt

Patch 8.1.1408
Problem:    PFL_HIDDEN conflicts with system header file. (Ken Takata)
Solution:   Rename to POPF_HIDDEN.
Files:	    src/popupwin.c, src/screen.c, src/vim.h

Patch 8.1.1409
Problem:    Coverity warns for using uninitialized memory.
Solution:   Add a condition to clearing the growarray.
Files:	    src/json.c

Patch 8.1.1410
Problem:    Popup_move() is not implemented yet.
Solution:   Implement it. (Yasuhiro Matsumoto, closes #4441)  Improve the
            positioning and resizing.
Files:	    runtime/doc/popup.txt, src/evalfunc.c, src/popupwin.c,
            src/screen.c, src/structs.h, src/proto/popupwin.pro,
            src/testdir/test_popupwin.vim,
            src/testdir/dumps/Test_popupwin_05.dump

Patch 8.1.1411
Problem:    Coverity warns for divide by zero.
Solution:   Make sure width is larger than zero.
Files:	    src/charset.c

Patch 8.1.1412
Problem:    Test 30 is old style.
Solution:   Turn it into a new style test. (Yegappan Lakshmanan, closes #4440)
Files:	    src/Makefile, src/testdir/Make_all.mak, src/testdir/Make_vms.mms,
            src/testdir/test30.in, src/testdir/test30.ok,
            src/testdir/test_fileformat.vim

Patch 8.1.1413
Problem:    Error when the drive of the swap file was disconnected.
Solution:   Try closing and re-opening the swap file. (partly by Joe Orost,
            closes #4378)
Files:	    src/memfile.c, src/structs.h, src/testdir/test_startup.vim

Patch 8.1.1414
Problem:    Alloc() returning "char_u *" causes a lot of type casts.
Solution:   Have it return "void *". (Mike Williams)  Define ALLOC_ONE() to
            check the simple allocations.
Files:	    src/autocmd.c, src/blob.c, src/blowfish.c, src/buffer.c,
            src/change.c, src/channel.c, src/crypt.c, src/crypt_zip.c,
            src/dict.c, src/diff.c, src/eval.c, src/evalfunc.c, src/ex_cmds.c,
            src/ex_cmds2.c, src/ex_docmd.c, src/ex_eval.c, src/ex_getln.c,
            src/fileio.c, src/findfile.c, src/getchar.c, src/gui_gtk.c,
            src/gui_gtk_x11.c, src/gui_mac.c, src/gui_motif.c,
            src/gui_photon.c, src/gui_w32.c, src/gui_x11.c, src/hardcopy.c,
            src/hashtab.c, src/if_cscope.c, src/if_mzsch.c, src/if_perlsfio.c,
            src/if_py_both.h, src/if_python3.c, src/if_xcmdsrv.c,
            src/insexpand.c, src/list.c, src/mark.c, src/mbyte.c,
            src/memfile.c, src/memfile_test.c, src/memline.c, src/message.c,
            src/misc2.c, src/netbeans.c, src/normal.c, src/ops.c,
            src/option.c, src/os_amiga.c, src/os_mac_conv.c, src/os_mswin.c,
            src/os_unix.c, src/os_vms.c, src/os_win32.c, src/popupmnu.c,
            src/proto/misc2.pro, src/quickfix.c, src/regexp.c,
            src/regexp_nfa.c, src/screen.c, src/search.c, src/sign.c,
            src/spell.c, src/spellfile.c, src/syntax.c, src/tag.c, src/term.c,
            src/terminal.c, src/textprop.c, src/ui.c, src/undo.c,
            src/userfunc.c, src/version.c, src/winclip.c, src/window.c,
            src/vim.h, src/testdir/test_cscope.vim

Patch 8.1.1415 (after 8.1.1414)
Problem:    Build error in MS-Windows GUI.
Solution:   Fix the LALLOC_MULT() argument.
Files:	    src/gui_w32.c

Patch 8.1.1416
Problem:    Popup_getposition() not implemented yet.
Solution:   Implement it. (Yasuhiro Matsumoto, closes #4449)
Files:	    runtime/doc/popup.txt, src/evalfunc.c, src/popupwin.c,
            src/proto/popupwin.pro, src/testdir/test_popupwin.vim

Patch 8.1.1417
Problem:    MS-Windows: resolve() does not resolve all components of the path.
            (David Briscoe)
Solution:   Do not bail out for a reparse point. (Yasuhiro Matsumoto,
            closes #4211, closes #4447)
Files:	    src/os_mswin.c, src/testdir/test_functions.vim

Patch 8.1.1418
Problem:    Win_execute() is not implemented yet.
Solution:   Implement it.
Files:	    src/evalfunc.c, src/popupwin.c, src/testdir/test_execute_func.vim,
            runtime/doc/popup.txt, runtime/doc/eval.txt

Patch 8.1.1419
Problem:    Listener callbacks may be called recursively.
Solution:   Set "updating_screen" while listener callbacks are invoked.
Files:	    src/change.c, src/screen.c, src/proto/screen.pro, src/ui.c

Patch 8.1.1420
Problem:    Popup window size only uses first line length.
Solution:   Use the longest line. (Ben Jackson, closes #4451)  Also deal with
            wrapping lines.
Files:	    src/popupwin.c, src/testdir/test_popupwin.vim

Patch 8.1.1421
Problem:    Drawing "~" line in popup window.
Solution:   Just draw text in the last line of the popup window.
Files:	    src/screen.c, src/structs.h, src/popupwin.c,
            src/proto/popupwin.pro, src/testdir/test_popupwin.vim,
            src/testdir/dumps/Test_popupwin_05.dump,
            src/testdir/dumps/Test_popupwin_06.dump

Patch 8.1.1422
Problem:    Popup_getoptions() not implemented yet.
Solution:   Implement it. (closes #4452)
Files:	    runtime/doc/popup.txt, src/evalfunc.c, src/popupwin.c,
            src/proto/popupwin.pro, src/testdir/test_popupwin.vim

Patch 8.1.1423
Problem:    Popup windows use options from current window and buffer.
Solution:   Clear all local options when creating a popup window.
Files:	    src/popupwin.c, src/option.c, src/proto/option.pro,
            src/testdir/test_popupwin.vim

Patch 8.1.1424
Problem:    Crash when popup menu is deleted while waiting for char.
Solution:   Bail out when pum_array was cleared.
Files:	    src/popupmnu.c

Patch 8.1.1425
Problem:    Win_execute() does not set window pointers properly.
Solution:   Use switch_win_noblock().  Also execute autocommands in a popup
            window.
Files:	    src/window.c, src/proto/window.pro, src/evalfunc.c, src/autocmd.c

Patch 8.1.1426
Problem:    No test for syntax highlight in popup window.
Solution:   Add a screenshot test.  Update associated documentation. Avoid
            'buftype' being reset by setbufvar().
Files:	    runtime/doc/eval.txt, src/testdir/test_popupwin.vim,
            src/testdir/dumps/Test_popupwin_10.dump,
            src/testdir/dumps/Test_popupwin_11.dump

Patch 8.1.1427 (after 8.1.1426)
Problem:    Popup window screenshot test fails.
Solution:   Add missing change to popup window code.
Files:	    src/popupwin.c

Patch 8.1.1428
Problem:    Popup_atcursor() not implemented yet.
Solution:   Implement it. (Yasuhiro Matsumoto, closes #4456)
Files:	    runtime/doc/popup.txt, src/evalfunc.c, src/popupwin.c,
            src/proto/popupwin.pro, src/testdir/test_popupwin.vim

Patch 8.1.1429
Problem:    "pos" option of popup window not supported yet.
Solution:   Implement the option. Rename popup_getposition() to
            popup_getpos().
Files:	    src/structs.h, src/popupwin.c, src/proto/popupwin.pro,
            runtime/doc/popup.txt

Patch 8.1.1430
Problem:    Popup window option "wrap" not supported.
Solution:   Implement it.
Files:	    src/popupwin.c, src/testdir/test_popupwin.vim,
            src/testdir/dumps/Test_popupwin_wrap.dump,
            src/testdir/dumps/Test_popupwin_nowrap.dump

Patch 8.1.1431
Problem:    Popup window listed as "Scratch".
Solution:   List them as "Popup".
Files:	    src/buffer.c, src/popupwin.c, src/testdir/test_popupwin.vim,
            runtime/doc/popup.txt, runtime/doc/windows.txt

Patch 8.1.1432 (after 8.1.1429)
Problem:    Can't build with eval feature.
Solution:   Add missing rename.
Files:	    src/evalfunc.c

Patch 8.1.1433
Problem:    Win_execute() may leave popup window focused, eventually leading
            to a crash. (Bjorn Linse)
Solution:   When previous window was closed, go to the first window.
Files:	    src/window.c, src/testdir/test_popupwin.vim

Patch 8.1.1434
Problem:    Test 3 is old style.
Solution:   Turn into a new style test. (Yegappan Lakshmanan, closes #4460)
Files:	    src/Makefile, src/testdir/Make_all.mak, src/testdir/Make_vms.mms,
            src/testdir/test3.in, src/testdir/test3.ok,
            src/testdir/test_cindent.vim

Patch 8.1.1435
Problem:    Memory usage test is a bit too flaky.
Solution:   Adjust the tolerances a bit. (Christian Brabandt)
Files:	    src/testdir/test_memory_usage.vim

Patch 8.1.1436
Problem:    Writefile test fails when run under /tmp.
Solution:   Adjust 'backupskip'. (Kenta Sato, closes #4462)
Files:	    src/testdir/test_writefile.vim

Patch 8.1.1437
Problem:    Code to handle callbacks is duplicated.
Solution:   Add callback_T and functions to deal with it.
Files:	    src/structs.h, src/evalfunc.c, src/proto/evalfunc.pro,
            src/change.c, src/channel.c, src/proto/channel.pro, src/buffer.c,
            src/userfunc.c, src/proto/userfunc.pro, src/eval.c,
            src/ex_cmds2.c, src/popupwin.c

Patch 8.1.1438
Problem:    Some commands cause trouble in a popup window.
Solution:   Add NOT_IN_POPUP_WINDOW.
Files:	    src/macros.h, src/popupwin.c, src/proto/popupwin.pro,
            src/ex_docmd.c, src/ex_cmds2.c, src/window.c,
            src/testdir/test_popupwin.vim

Patch 8.1.1439
Problem:    Json_encode() is very slow for large results.
Solution:   In the growarray use a growth of at least 50%. (Ken Takata,
            closes #4461)
Files:	    src/misc2.c

Patch 8.1.1440
Problem:    Win_execute() test fails.
Solution:   Adjust the expected error number.  Move to popup test.
Files:	    src/testdir/test_execute_func.vim, src/testdir/test_popupwin.vim

Patch 8.1.1441
Problem:    Popup window filter not yet implemented.
Solution:   Implement the popup filter.
Files:	    src/structs.h, runtime/doc/popup.txt, src/popupwin.c,
            src/proto/popupwin.pro, src/window.c, src/getchar.c, src/screen.c,
            src/misc2.c, src/proto/misc2.pro, src/vim.h,
            src/testdir/test_popupwin.vim

Patch 8.1.1442
Problem:    Popup windows not considered when the Vim window is resized.
            (Ben Jackson)
Solution:   Reallocate the w_lines structure. (closes #4467)
Files:	    src/screen.c

Patch 8.1.1443
Problem:    Popup window padding and border not implemented yet.
Solution:   Implement padding and border.  Add core position and size to
            popup_getpos().
Files:	    src/structs.h, src/popupwin.c, src/screen.c,
            src/testdir/test_popupwin.vim,
            src/testdir/dumps/Test_popupwin_20.dump, runtime/doc/popup.txt

Patch 8.1.1444
Problem:    Not using double line characters for popup border.
Solution:   Use double line characters if using utf-8.
Files:	    src/screen.c, src/testdir/test_popupwin.vim,
            src/testdir/dumps/Test_popupwin_21.dump

Patch 8.1.1445
Problem:    Popup window border highlight not implemented yet.
Solution:   Implement the "borderhighlight" option.
Files:	    src/structs.h, src/popupwin.c, src/window.c, src/screen.c,
            src/testdir/test_popupwin.vim, runtime/doc/popup.txt,
            src/testdir/dumps/Test_popupwin_22.dump

Patch 8.1.1446
Problem:    Popup window callback not implemented yet.
Solution:   Implement the callback.
Files:	    runtime/doc/popup.txt, src/popupwin.c, src/structs.h,
            src/evalfunc.c, src/window.c, src/testdir/test_popupwin.vim

Patch 8.1.1447
Problem:    Not allowed to create an empty popup.
Solution:   Remove restriction that there is some text. (closes #4470)
Files:	    src/popupwin.c, src/testdir/test_popupwin.vim

Patch 8.1.1448
Problem:    Statusline is sometimes drawn on top of popup.
Solution:   Redraw popups after the statusline. (Naruhiko Nishino,
            closes #4468)
Files:	    src/screen.c, src/testdir/test_popupwin.vim,
            src/testdir/dumps/Test_popupwin_behind.dump

Patch 8.1.1449
Problem:    Popup text truncated at end of screen.
Solution:   Move popup left if needed.  Add the "fixed" property to disable
            that. (Ben Jackson, closes #4466)
Files:	    runtime/doc/popup.txt, src/popupwin.c, src/structs.h,
            src/testdir/test_popupwin.vim

Patch 8.1.1450
Problem:    Popup window positioning wrong when using padding or borders.
Solution:   Fix computing the position.
Files:	    src/popupwin.c, src/testdir/test_popupwin.vim,
            src/testdir/dumps/Test_popupwin_corners.dump

Patch 8.1.1451
Problem:    CTRL-L does not clear screen with a popup window.
Solution:   Do not change the type to NOT_VALID.  Redraw all windows.
            (closes #4471)
Files:	    src/screen.c

Patch 8.1.1452
Problem:    Line and col property of popup windows not properly checked.
Solution:   Check for "+" or "-" sign.
Files:	    src/popupwin.c, src/dict.c, src/proto/dict.pro,
            src/window.c, src/testdir/test_popupwin.vim

Patch 8.1.1453
Problem:    Popup window "moved" property not implemented yet.
Solution:   Implement it.
Files:	    src/main.c, src/edit.c, src/gui.c, src/globals.h, src/structs.h,
            src/screen.c, src/popupwin.c, src/proto/popupwin.pro,
            src/testdir/test_popupwin.vim, runtime/doc/popup.txt

Patch 8.1.1454
Problem:    Build failure without the conceal feature.
Solution:   Remove #ifdef.
Files:	    src/autocmd.c

Patch 8.1.1455
Problem:    Popup_atcursor() not completely implemented.
Solution:   Add the default for the "moved" property.
Files:	    src/popupwin.c, src/normal.c, src/vim.h,
            src/testdir/test_popupwin.vim

Patch 8.1.1456
Problem:    WinBar not redrawn after scrolling one line.
Solution:   Exclude the winbar height when deciding what to redraw.
            (closes #4473)
Files:	    src/screen.c, src/testdir/test_winbar.vim

Patch 8.1.1457
Problem:    Cannot reuse a buffer when loading a screen dump.
Solution:   Add the "bufnr" option.
Files:	    runtime/doc/eval.txt, src/structs.h, src/channel.c,
            src/terminal.c, src/testdir/test_terminal.vim

Patch 8.1.1458
Problem:    Crash when using gtags. (issue #4102)
Solution:   Check for negative row or col in screen_puts_len(). (Christian
            Brabandt)
Files:	    src/screen.c

Patch 8.1.1459
Problem:    Popup window border looks bad when 'ambiwidth' is "double".
            (Yasuhiro Matsumoto)
Solution:   Only use line drawing characters when 'ambiwidth' is "single".
            (Ken Takata, closes #4477)
Files:	    src/screen.c

Patch 8.1.1460
Problem:    Popup window border characters may be wrong.
Solution:   Reset the border characters for each popup.  Correct use of
            'ambiwidth'.
Files:	    src/screen.c

Patch 8.1.1461
Problem:    Tests do not run or are not reliable on some systems.
Solution:   Use "findstr" instead of "grep" on MS-Windows. Clear
            PROMPT_COMMAND in the terminal test. Delete temp file. Wait for
            output after executing a debug command. (Yegappan Lakshmanan,
            closes #4479)
Files:	    src/testdir/test_debugger.vim, src/testdir/test_environ.vim,
            src/testdir/test_filetype.vim, src/testdir/test_source.vim,
            src/testdir/test_terminal.vim

Patch 8.1.1462
Problem:    MS-Windows: using special character requires quoting.
Solution:   Add quotes. (Ken Takata)
Files:	    src/testdir/test_environ.vim

Patch 8.1.1463
Problem:    Gcc warns for uninitialized variable.
Solution:   Put usage inside "if".  (Ken Takata)
Files:	    src/textprop.c

Patch 8.1.1464
Problem:    Only 4-digit rgb termresponse is recognized.
Solution:   Also recognize 2-digit rgb response. (closes #4486)
Files:	    src/term.c, src/test_termcodes.vim

Patch 8.1.1465
Problem:    Allocating wrong amount of memory. (Yegappan Lakshmanan)
Solution:   Use sizeof() for right type of struct.
Files:	    src/memfile_test.c

Patch 8.1.1466
Problem:    Not updating priority on existing sign.
Solution:   Set the sign priority.  Add a test. (Yegappan Lakshmanan)
Files:	    src/sign.c, src/testdir/test_signs.vim, runtime/doc/eval.txt,
            runtime/doc/sign.txt

Patch 8.1.1467 (after 8.1.1465)
Problem:    Cscope test fails.
Solution:   Update expected text.
Files:	    src/testdir/test_cscope.vim

Patch 8.1.1468
Problem:    The generated desktop files may be invalid.
Solution:   Check validity with desktop-file-validate. (Christian Brabandt,
            Will Thompson, closes #4480)
Files:	    src/po/Makefile

Patch 8.1.1469
Problem:    No test for checking the cursor style response.
Solution:   Add a simple test.  Also include the missing part of 8.1.1464.
Files:	    src/term.c, src/testdir/test_termcodes.vim

Patch 8.1.1470
Problem:    New Unicode character U+32FF missing from double-width table.
Solution:   Add the character.
Files:	    src/mbyte.c

Patch 8.1.1471
Problem:    'background' not correctly set for 2-digit rgb termresponse.
Solution:   Adjust what digit to use. (closes #4495)
Files:	    src/term.c, src/testdir/test_termcodes.vim

Patch 8.1.1472
Problem:    Add_termcap_entry() is not tested.
Solution:   Add a simple test.
Files:	    src/testdir/test_termcodes.vim

Patch 8.1.1473
Problem:    New resolve() implementation causes problem for plugins.
Solution:   Only resolve a reparse point after checking it is needed. (Ken
            Takata, closes #4492)
Files:	    src/os_mswin.c, src/testdir/test_functions.vim

Patch 8.1.1474
Problem:    'ttybuiltin' is not tested.
Solution:   At least test that it doesn't break things.
Files:	    src/testdir/test_termcodes.vim

Patch 8.1.1475
Problem:    Search string not displayed when 'rightleft' is set.
Solution:   Clear the right part of the old text. (closes #4488, closes #4489)
Files:	    src/search.c, src/testdir/test_search.vim

Patch 8.1.1476
Problem:    No statistics displayed after running tests.
Solution:   Summarize the test results. (Christian Brabandt, closes #4391)
            Also make it possible to report a skipped file.
Files:	    src/Makefile, src/testdir/Makefile, src/testdir/summarize.vim,
            src/testdir/runtest.vim, src/testdir/test_arabic.vim,
            src/testdir/test_autochdir.vim, src/testdir/test_balloon.vim

Patch 8.1.1477
Problem:    Test summary fails in the tiny version.
Solution:   set 'nocompatible'.
Files:	    Filelist, src/testdir/summarize.vim

Patch 8.1.1478
Problem:    Still an error when running tests with the tiny version.
Solution:   Do not try reading test.log
Files:	    src/testdir/Makefile, src/testdir/summarize.vim

Patch 8.1.1479
Problem:    Change included for debugging only.
Solution:   Restore the REDIR_TEST_TO_NULL line.
Files:	    src/testdir/Makefile

Patch 8.1.1480
Problem:    Desktop file check doesn't run on CI.
Solution:   Install the desktop-file-utils packages. (Christian Brabandt,
            closes #4498)
Files:	    .travis.yml

Patch 8.1.1481
Problem:    Length for two-digit rgb termresponse is off by one.
Solution:   Adjust the length. (closes #4494)
Files:	    src/term.c

Patch 8.1.1482
Problem:    No test for wincol() depending on the 'number' option.
Solution:   Add a couple of tests. (Christian Brabandt, closes #4500)
Files:	    src/testdir/test_gui.vim

Patch 8.1.1483
Problem:    Skipped tests are not properly listed.
Solution:   Throw a "Skipped" exception instead of using ":finish" or ":return".
Files:	    src/testdir/test_breakindent.vim, src/testdir/test_cdo.vim,
            src/testdir/test_channel.vim, src/testdir/test_clientserver.vim,
            src/testdir/test_balloon.vim, src/testdir/test_conceal.vim,
            src/testdir/test_debugger.vim, src/testdir/test_diffmode.vim,
            src/testdir/test_fold.vim, src/testdir/test_highlight.vim,
            src/testdir/test_popup.vim, src/testdir/test_popupwin.vim,
            src/testdir/test_search.vim, src/testdir/test_startup.vim,
            src/testdir/test_startup_utf8.vim, src/testdir/test_syntax.vim,
            src/testdir/test_tabpage.vim, src/testdir/test_termencoding.vim,
            src/testdir/test_terminal.vim, src/testdir/test_textprop.vim,
            src/testdir/test_timers.vim

Patch 8.1.1484
Problem:    Some tests are slow.
Solution:   Add timing to the test messages.  Fix double free when quitting in
            VimLeavePre autocmd.
Files:	    src/testdir/runtest.vim, src/eval.c

Patch 8.1.1485
Problem:    Double free when garbage_collect() is used in autocommand.
Solution:   Have garbage collection also set the copyID in funccal_stack.
Files:	    src/eval.c, src/userfunc.c

Patch 8.1.1486
Problem:    A listener change is merged even when it adds a line. (Paul Jolly)
Solution:   Do not merge a change that adds or removes a line. (closes #4490)
Files:	    src/change.c, src/testdir/test_listener.vim

Patch 8.1.1487
Problem:    Older msgfmt cannot generate proper .desktop file.
Solution:   Add a configure check to not use this msgfmt version. (Ken Takata)
Files:	    src/configure.ac, src/auto/configure

Patch 8.1.1488
Problem:    Summary of tests has incorrect failed count.
Solution:   Add to the failed count instead of setting it. (Christian Brabandt)
Files:	    src/testdir/summarize.vim

Patch 8.1.1489
Problem:    Sign order wrong when priority was changed.
Solution:   Reorder signs when priority is changed. (Yegappan Lakshmanan,
            closes #4502)
Files:	    src/quickfix.c, src/sign.c, src/testdir/test_signs.vim

Patch 8.1.1490
Problem:    When a single test fails the exit code is not set. (Daniel Hahler)
Solution:   Add an exit command. (closes #4506)
Files:	    src/testdir/Makefile

Patch 8.1.1491
Problem:    When skipping over code after an exception was thrown expression
            evaluation is aborted after a function call. (Ingo Karkat)
Solution:   Do not fail if not executing the expression. (closes #4507)
Files:	    src/eval.c, src/testdir/test_eval_stuff.vim

Patch 8.1.1492
Problem:    MS-Windows: when "!" is in 'guioptions' ":!start" fails.
Solution:   Do not use a terminal window when the shell command begins with
            "!start". (Yasuhiro Matsumoto, closes #4504)
Files:	    src/misc2.c, src/os_win32.c

Patch 8.1.1493
Problem:    Redrawing with popups is slow and causes flicker.
Solution:   Avoid clearing and redrawing using a zindex mask.
Files:	    src/globals.h, src/screen.c, src/proto/screen.pro, src/popupwin.c,
            src/popupmnu.c

Patch 8.1.1494 (after 8.1.1493)
Problem:    Build failure.
Solution:   Add missing changes.
Files:	    src/structs.h

Patch 8.1.1495 (after 8.1.1494)
Problem:    Memory access error.
Solution:   Use the correct size for clearing the popup mask.
Files:	    src/screen.c

Patch 8.1.1496
Problem:    Popup window height is not recomputed.
Solution:   Recompute the height when needed.
Files:	    src/popupwin.c, src/testdir/dumps/Test_popupwin_06.dump

Patch 8.1.1497
Problem:    Accessing memory beyond allocated space.
Solution:   Check column before accessing popup mask.
Files:	    src/screen.c

Patch 8.1.1498
Problem:    ":write" increments b:changedtick even though nothing changed.
            (Daniel Hahler)
Solution:   Only increment b:changedtick if the modified flag is reset.
Files:	    src/change.c, src/proto/change.pro, runtime/doc/eval.txt,
            src/buffer.c, src/ex_cmds2.c, src/fileio.c, src/memline.c,
            src/undo.c

Patch 8.1.1499
Problem:    Ruler not updated after popup window was removed.
Solution:   use popup_mask in screen_puts().
Files:	    src/screen.c, src/testdir/test_popupwin.vim,
            src/testdir/dumps/Test_popupwin_07.dump,
            src/testdir/dumps/Test_popupwin_08.dump

Patch 8.1.1500
Problem:    Wrong shell command when building with VIMDLL and "!" in
            'guioptions'.
Solution:   Add check for GUI in use. (Ken Takata)
Files:	    src/misc2.c

Patch 8.1.1501
Problem:    New behavior of b:changedtick not tested.
Solution:   Add a few test cases. (Daniel Hahler)
Files:	    src/testdir/test_changedtick.vim

Patch 8.1.1502
Problem:    Cannot play any sound.
Solution:   Use libcanberra if available.  Add sound functions.
Files:	    src/configure.ac, src/auto/configure, src/config.h.in,
            src/Makefile, src/sound.c, src/proto/sound.pro, src/proto.h,
            src/evalfunc.c, src/feature.h, runtime/doc/eval.txt, Filelist,
            src/version.c, src/testdir/test_sound.vim, src/testdir/silent.wav,
            src/testdir/Make_all.mak, .travis.yml

Patch 8.1.1503
Problem:    Sound test fails on Travis.
Solution:   Set AUDIODEV to "null".
Files:	    .travis.yml

Patch 8.1.1504
Problem:    Sound test still fails on Travis.
Solution:   Add more lines to the install section.
Files:	    .travis.yml

Patch 8.1.1505
Problem:    Running "make clean" twice gives errors.
Solution:   Add "-f" to "rm". (closes #4516)
Files:	    src/testdir/Makefile

Patch 8.1.1506
Problem:    Syntax error in Travis config.
Solution:   Set AUDIODEV in another section.
Files:	    .travis.yml

Patch 8.1.1507
Problem:    Sound test still fails on Travis.
Solution:   Try another dummy sound approach.
Files:	    .travis.yml

Patch 8.1.1508
Problem:    Sound keeps failing on Travis.
Solution:   Throw a skipped exception in the test.
Files:	    src/testdir/test_sound.vim

Patch 8.1.1509
Problem:    Cmdline_row can become negative, causing a crash.
Solution:   Make sure cmdline_row does not become negative. (closes #4102)
Files:	    src/misc1.c

Patch 8.1.1510
Problem:    A plugin cannot easily expand a command like done internally.
Solution:   Add the expandcmd() function. (Yegappan Lakshmanan, closes #4514)
Files:	    runtime/doc/eval.txt, runtime/doc/usr_41.txt, src/evalfunc.c,
            src/testdir/test_expand.vim

Patch 8.1.1511
Problem:    Matches in a popup window are not displayed properly.
Solution:   Do display matches in a popup window. (closes #4517)
Files:	    src/screen.c, src/testdir/test_popupwin.vim,
            src/testdir/dumps/Test_popupwin_matches.dump

Patch 8.1.1512
Problem:    ch_evalexpr() hangs when used recursively. (Paul Jolly)
Solution:   Change ch_block_id from a single number to a list of IDs to wait
            on.
Files:	    src/channel.c, src/structs.h

Patch 8.1.1513
Problem:    All popup functionality is in functions, except :popupclear.
Solution:   Add popup_clear() for consistency.  Also rename sound_stopall() to
            sound_clear().
Files:	    src/ex_cmds.h, src/ex_cmdidxs.h, src/evalfunc.c, src/popupwin.c,
            src/proto/popupwin.pro, src/sound.c, src/proto/sound.pro,
            src/testdir/test_popupwin.vim src/testdir/test_sound.vim,
            runtime/doc/eval.txt runtime/doc/popup.txt

Patch 8.1.1514 (after 8.1.1492)
Problem:    MS-Windows: wrong shell command with ! in 'guioptions'.
Solution:   Do not check for ! in 'guioptions' when applying 'shellxquote'.
            (Yasuhiro Matsumoto, closes #4519)
Files:	    src/misc2.c

Patch 8.1.1515
Problem:    Memory leak reported for sound when build with EXITFREE.
Solution:   Free sound stuff when exiting.
Files:	    src/misc2.c

Patch 8.1.1516
Problem:    Time reported for a test measured wrong.
Solution:   Move the computation to the end of RunTheTest(). (Ozaki Kiichi,
            closes #4520)
Files:	    src/testdir/runtest.vim

Patch 8.1.1517
Problem:    When a popup changes all windows are redrawn.
Solution:   Only update the lines that were affected.  Add a file for
            profiling popup windows efficiency.
Files:	    src/screen.c, src/proto/screen.pro, src/ui.c, src/popupwin.c,
