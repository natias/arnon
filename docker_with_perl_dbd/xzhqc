Files:      src/popupmenu.c, src/popupwin.c, src/proto/popupmenu.pro,
            src/screen.c, src/testdir/test_popupwin.vim,
            src/testdir/dumps/Test_popupwin_popupmenu_masking_1.dump,
            src/testdir/dumps/Test_popupwin_popupmenu_masking_2.dump

Patch 8.2.3615
Problem:    When re-formatting with an indent expression the first line of a
            paragraph may get the wrong indent. (Martin F. Krafft)
Solution:   Apply the correct indenting function for the first line.
            (Christian Brabandt, closes #9150, closes #9056)
Files:      src/textformat.c, src/testdir/test_indent.vim

Patch 8.2.3616
Problem:    Arglist test does not clear the argument list consistently.
Solution:   Call Reset_arglist(). (Shougo Matsushita, closes #9154)
Files:      src/testdir/test_arglist.vim

Patch 8.2.3617
Problem:    ":verbose pwd" does not mention 'autochdir' was applied.
Solution:   Remember the last chdir was done by 'autochdir'.  (issue #9142)
Files:      src/globals.h, src/buffer.c, src/ex_docmd.c, src/window.c,
            src/main.c, src/netbeans.c, src/os_win32.c,
            src/testdir/test_autochdir.vim

Patch 8.2.3618
Problem:    getcwd() is unclear about how 'autochdir' is used.
Solution:   Update the help for getcwd().  Without any arguments always return
            the actual current directory. (closes #9142)
Files:      runtime/doc/eval.txt, src/filepath.c, src/testdir/test_cd.vim

Patch 8.2.3619
Problem:    Cannot use a lambda for 'operatorfunc'.
Solution:   Support using a lambda or partial. (Yegappan Lakshmanan,
            closes #8775)
Files:      runtime/doc/map.txt, runtime/doc/options.txt, src/ops.c,
            src/option.c, src/optionstr.c, src/proto/ops.pro,
            src/proto/option.pro, src/quickfix.c, src/testdir/test_normal.vim

Patch 8.2.3620
Problem:    Memory leak reported in libtlib.
Solution:   Call del_curterm() when cleaning up memory.  Rename term.h to
            termdefs.h to avoid a name clash.
Files:      src/term.c, src/proto/term.pro, src/alloc.c, src/configure.ac,
            src/auto/configure, src/config.h.in, src/Makefile,
            src/Make_cyg_ming.mak, src/Make_mvc.mak, src/Make_vms.mms,
            src/term.h, src/termdefs.h

Patch 8.2.3621 (after 8.2.3620)
Problem:    Build failure.
Solution:   Add missing change.
Files:      src/vim.h

Patch 8.2.3622
Problem:    "verbose pwd" shows confusing info when :lcd does not change
            directory.
Solution:   Clear last_chdir_reason also when the directory does not change.
            (closes #9160)
Files:      src/ex_docmd.c, src/testdir/test_autochdir.vim

Patch 8.2.3623
Problem:    "$*" is expanded to "nonomatch".
Solution:   Only add "set nonomatch" when using a csh-like shell. (Christian
            Brabandt, closes #9159, closes #9153)
Files:      src/os_unix.c, src/testdir/test_expand.vim

Patch 8.2.3624
Problem:    When renaming a terminal buffer the status text is not updated.
Solution:   Clear the cached status text when renaming a terminal buffer.
            (closes #9162)
Files:      src/buffer.c, src/terminal.c, src/proto/terminal.pro,
            src/testdir/test_terminal.vim

Patch 8.2.3625
Problem:    Illegal memory access when C-indenting.
Solution:   Also set the cursor column.
Files:      src/cindent.c, src/testdir/test_cindent.vim

Patch 8.2.3626
Problem:    "au!" and "au! event" cannot be followed by another command as
            documented.
Solution:   When a bar is found set nextcmd.
Files:      src/autocmd.c, src/testdir/test_autocmd.vim

Patch 8.2.3627
Problem:    difficult to know where the text starts in a window. (Sergey
            Vlasov)
Solution:   Add the "textoff" entry in the result of getwininfo().
            (closes #9163)
Files:      runtime/doc/eval.txt, src/evalwindow.c,
            src/testdir/test_bufwintabinfo.vim

Patch 8.2.3628
Problem:    Looking up terminal colors is a bit slow.
Solution:   Cache the terminal colors. (closes #9130, closes #9058)
Files:      src/highlight.c, src/libvterm/include/vterm.h, src/option.c,
            src/optionstr.c, src/popupwin.c, src/proto/terminal.pro,
            src/structs.h, src/terminal.c, src/window.c,
            src/testdir/test_terminal3.vim,
            src/testdir/dumps/Test_terminal_color_MyTermCol.dump,
            src/testdir/dumps/Test_terminal_color_MyTermCol_over_Terminal.dump,
            src/testdir/dumps/Test_terminal_color_MyWinCol.dump,
            src/testdir/dumps/Test_terminal_color_MyWinCol_over_group.dump,
            src/testdir/dumps/Test_terminal_color_Terminal.dump,
            src/testdir/dumps/Test_terminal_color_gui_MyTermCol.dump,
            src/testdir/dumps/Test_terminal_color_gui_MyWinCol.dump,
            src/testdir/dumps/Test_terminal_color_gui_Terminal.dump,
            src/testdir/dumps/Test_terminal_color_gui_transp_MyTermCol.dump,
            src/testdir/dumps/Test_terminal_color_gui_transp_MyWinCol.dump,
            src/testdir/dumps/Test_terminal_color_gui_transp_Terminal.dump,
            src/testdir/dumps/Test_terminal_color_transp_MyTermCol.dump,
            src/testdir/dumps/Test_terminal_color_transp_MyWinCol.dump,
            src/testdir/dumps/Test_terminal_color_transp_Terminal.dump,
            src/testdir/dumps/Test_terminal_popup_MyPopupHlCol.dump,
            src/testdir/dumps/Test_terminal_popup_MyTermCol_over_Terminal.dump,
            src/testdir/dumps/Test_terminal_popup_MyWinCol.dump,
            src/testdir/dumps/Test_terminal_popup_MyWinCol_over_group.dump,
            src/testdir/dumps/Test_terminal_popup_gui_MyPopupHlCol.dump,
            src/testdir/dumps/Test_terminal_popup_gui_MyTermCol.dump,
            src/testdir/dumps/Test_terminal_popup_gui_MyWinCol.dump,
            src/testdir/dumps/Test_terminal_popup_gui_Terminal.dump,
            src/testdir/dumps/Test_terminal_popup_gui_transp_MyPopupHlCol.dump,
            src/testdir/dumps/Test_terminal_popup_gui_transp_MyTermCol.dump,
            src/testdir/dumps/Test_terminal_popup_gui_transp_MyWinCol.dump,
            src/testdir/dumps/Test_terminal_popup_gui_transp_Terminal.dump,
            src/testdir/dumps/Test_terminal_popup_transp_MyPopupHlCol.dump,
            src/testdir/dumps/Test_terminal_popup_transp_MyTermCol.dump,
            src/testdir/dumps/Test_terminal_popup_transp_MyWinCol.dump,
            src/testdir/dumps/Test_terminal_popup_transp_Terminal.dump,
            src/testdir/dumps/Test_terminal_wincolor_split_MyWinCol.dump,
            src/testdir/dumps/Test_terminal_wincolor_split_MyWinCol2.dump

Patch 8.2.3629
Problem:    Command completion in cmdline window uses global user commands,
            not local commands for the window where it was opened from.
Solution:   Use local commands. (closes #9168)
Files:      src/ex_getln.c, src/proto/ex_getln.pro, src/evalvars.c,
            src/usercmd.c, src/testdir/test_ins_complete.vim

Patch 8.2.3630
Problem:    Printf() with %S does not handle multi-byte correctly.
Solution:   Count cells instead of bytes. (closes #9169, closes #7486)
Files:      src/strings.c, src/testdir/test_expr.vim

Patch 8.2.3631
Problem:    "syntax enable" does not work properly in Vim9 context.
Solution:   Also handle Vim9 context. (closes #9161)
Files:      src/syntax.c, src/testdir/test_vim9_cmd.vim

Patch 8.2.3632
Problem:    GTK3: undercurl does not get removed properly.
Solution:   Set the cairo cursor first. (closes #9170)
Files:      src/gui_gtk_x11.c

Patch 8.2.3633
Problem:    Vim9: line number of lambda is off by one.
Solution:   Add one to the line number. (closes #9083)
Files:      src/userfunc.c, src/testdir/test_vim9_func.vim

Patch 8.2.3634
Problem:    Error for already defined function uses wrong line number.
Solution:   Set SOURCING_LNUM before giving the error message. (closes #9085)
Files:      src/userfunc.c, src/testdir/test_vim9_func.vim

Patch 8.2.3635
Problem:    GTK: composing underline does not show.
Solution:   Include composing character in pango call. A few more
            optimizations for ligatures.  (Dusan Popovic, closes #9171,
            closes #9147)
Files:      src/gui_gtk_x11.c

Patch 8.2.3636
Problem:    Coverity warns for unreachable code.
Solution:   Remove unreachable else block.
Files:      src/gui_gtk_x11.c

Patch 8.2.3637
Problem:    Typos in test files.
Solution:   Correct the typos. (Dominique Pellé, closes #9175)
Files:      src/testdir/runtest.vim, src/testdir/test_debugger.vim,
            src/testdir/test_diffmode.vim, src/testdir/test_edit.vim,
            src/testdir/test_excmd.vim, src/testdir/test_flatten.vim,
            src/testdir/test_ins_complete.vim, src/testdir/test_normal.vim,
            src/testdir/test_options.vim, src/testdir/test_python2.vim,
            src/testdir/test_python3.vim, src/testdir/test_quickfix.vim,
            src/testdir/test_recover.vim, src/testdir/test_spellfile.vim,
            src/testdir/test_syntax.vim, src/testdir/test_termcodes.vim,
            src/testdir/test_textobjects.vim, src/testdir/test_trycatch.vim,
            src/testdir/test_vim9_script.vim, src/testdir/test_viminfo.vim

Patch 8.2.3638
Problem:    getcompletion() always passes zero as position to custom
            completion function.
Solution:   Pass the pattern length. (closes #9173)
Files:      src/cmdexpand.c, src/testdir/test_cmdline.vim

Patch 8.2.3639 (after 8.2.2922)
Problem:    Line commented out accidentally.
Solution:   Uncomment. (Volodymyr Kot, closes #9172)
Files:      src/main.c

Patch 8.2.3640
Problem:    Freeze when calling term_wait() in a close callback.
Solution:   Set a "closing" flag to tell term_wait() to return. (closes #9152)
Files:      src/channel.c, src/terminal.c, src/proto/terminal.pro,
            src/testdir/test_terminal.vim

Patch 8.2.3641
Problem:    Xxd code has duplicate expressions.
Solution:   Refactor to avoid duplication. (closes #9185)
Files:      src/xxd/xxd.c

Patch 8.2.3642
Problem:    List of distributed files is outdated.
Solution:   Rename term.h to termdefs.h.
Files:      Filelist

Patch 8.2.3643
Problem:    Header for source file is outdated.
Solution:   Make the header more accurate. (closes #9186)
Files:      src/map.c, src/getchar.c

Patch 8.2.3644
Problem:    Count for 'operatorfunc' in Visual mode is not redone.
Solution:   Add the count to the redo buffer. (closes #9174)
Files:      src/normal.c, src/proto/normal.pro, src/ops.c,
            src/testdir/test_normal.vim

Patch 8.2.3645
Problem:    Vim9: The "no effect" error is not given for all registers.
Solution:   Include any character following '@'. (closes #8779)
Files:      src/ex_eval.c, src/testdir/test_vim9_cmd.vim

Patch 8.2.3646
Problem:    Using <sfile> in a function gives an unexpected result.
Solution:   Give an error in a Vim9 function. (issue #9189)
Files:      src/scriptfile.c, src/errors.h, src/testdir/test_vim9_builtin.vim

Patch 8.2.3647
Problem:    GTK: when using ligatures the cursor is drawn wrong.
Solution:   Clear more characters when ligatures are used. (Dusan Popovic,
            closes #9190)
Files:      src/gui.c

Patch 8.2.3648
Problem:    "verbose pwd" is incorrect after dropping files on Vim.
Solution:   Set the chdir reason to "drop".
Files:      src/gui.c

Patch 8.2.3649
Problem:    Vim9: error for variable declared in while loop.
Solution:   Do not keep the first variable. (closes #9191)
Files:      src/ex_eval.c, src/testdir/test_vim9_script.vim

Patch 8.2.3650
Problem:    Vim9: for loop variable can be a list member.
Solution:   Check for valid variable name. (closes #9179)
Files:      src/vim9compile.c, src/dict.c, src/eval.c, src/evalvars.c,
            src/proto/evalvars.pro, src/testdir/test_vim9_script.vim

Patch 8.2.3651
Problem:    Vim9: no error for :lock or :unlock with unknown variable.
Solution:   Give an error. (closes #9188)
Files:      src/evalvars.c, src/errors.h, src/testdir/test_vim9_cmd.vim

Patch 8.2.3652
Problem:    Can only get text properties one line at a time.
Solution:   Add options to prop_list() to use a range of lines and filter by
            types. (Yegappan Lakshmanan, closes #9138)
Files:      runtime/doc/textprop.txt, src/textprop.c,
            src/testdir/test_textprop.vim

Patch 8.2.3653
Problem:    Terminal ANSI colors may be wrong.
Solution:   Initialize the color type. (closes #9198, closes #9197)
Files:      src/terminal.c

Patch 8.2.3654
Problem:    GTK: a touch-drag does not update the selection.
Solution:   Add GDK_BUTTON1_MASK to the state. (Chris Dalton, close #9196,
            closes #9194)
Files:      src/gui_gtk_x11.c

Patch 8.2.3655
Problem:    Compiler warning for using size_t for int.
Solution:   Add a type cast. (Mike Williams, closes #9199)
Files:      src/vim9compile.c

Patch 8.2.3656
Problem:    Vim9: no error for an environment variable by itself.
Solution:   Give a "without effect" error. (closes #9166)
Files:      src/ex_eval.c, src/testdir/test_vim9_cmd.vim

Patch 8.2.3657
Problem:    Vim9: debug text misses one line of return statement.
Solution:   Add a line when not at a debug instruction. (closes #9137)
Files:      src/vim9execute.c, src/testdir/test_debugger.vim

Patch 8.2.3658
Problem:    Duplicate code in xxd.
Solution:   Merge duplicated code. Add more tests. (closes #9192)
Files:      src/xxd/xxd.c, src/testdir/test_xxd.vim

Patch 8.2.3659
Problem:    Integer overflow with large line number.
Solution:   Check for overflow. (closes #9202)
Files:      src/errors.h, src/ex_docmd.c, src/testdir/test_excmd.vim
            src/normal.c, src/testdir/test_normal.vim

Patch 8.2.3660 (after 8.2.3659)
Problem:    Overflow check uses wrong number.
Solution:   Divide by ten.
Files:      src/normal.c

Patch 8.2.3661 (after 8.2.3659)
Problem:    Test for put with large count fails.
Solution:   Adjust the counts in the test.
Files:      src/testdir/test_put.vim

Patch 8.2.3662
Problem:    Illegal memory access if malloc() fails.
Solution:   Check 'foldmethod' is not empty. (closes #9207)
Files:      src/fold.c

Patch 8.2.3663
Problem:    Using %S in printf() does not work correctly.
Solution:   Fix the problem and add more tests. (closes #9208)
Files:      src/strings.c, src/testdir/test_expr.vim

Patch 8.2.3664
Problem:    Cannot adjust sign highlighting for 'cursorline'.
Solution:   Add CursorLineSign and CursorLineFold highlight groups.
            (Gregory Anders, closes #9201)
Files:      runtime/doc/sign.txt, runtime/doc/syntax.txt, src/drawline.c,
            src/highlight.c, src/optiondefs.h, src/popupwin.c,
            src/proto/sign.pro, src/sign.c, src/structs.h, src/vim.h,
            src/testdir/test_signs.vim

Patch 8.2.3665
Problem:    Cannot use a lambda for 'tagfunc'.
Solution:   Use 'tagfunc' like 'opfunc'. (Yegappan Lakshmanan, closes #9204)
Files:      runtime/doc/options.txt, src/buffer.c, src/option.c,
            src/optionstr.c, src/proto/tag.pro, src/structs.h, src/tag.c,
            src/testdir/test_tagfunc.vim

Patch 8.2.3666
Problem:    Libvterm is outdated.
Solution:   Include patches from revision 769 to revision 789.
Files:      Filelist, src/libvterm/Makefile, src/libvterm/doc/seqs.txt,
            src/libvterm/include/vterm.h, src/libvterm/src/mouse.c,
            src/libvterm/src/parser.c, src/libvterm/src/state.c,
            src/libvterm/src/vterm.c, src/libvterm/src/vterm_internal.h,
            src/libvterm/t/02parser.test, src/libvterm/t/17state_mouse.test,
            src/libvterm/t/29state_fallback.test,
            src/libvterm/t/40state_selection.test, src/libvterm/t/harness.c,
            src/libvterm/t/run-test.pl, src/libvterm/vterm.pc.in,
            src/terminal.c

Patch 8.2.3667
Problem:    Building libvterm fails with MSVC.
Solution:   Don't use C99 construct.
Files:      src/libvterm/src/state.c

Patch 8.2.3668
Problem:    Messages may be corrupted.
Solution:   Use another buffer instead of IObuff. (Yegappan Lakshmanan,
            closes #9195)
Files:      src/highlight.c, src/testdir/test_highlight.vim

Patch 8.2.3669
Problem:    Buffer overflow with long help argument.
Solution:   Use snprintf().
Files:      src/help.c, src/testdir/test_help.vim

Patch 8.2.3670
Problem:    Error checks repeated several times.
Solution:   Move the checks to functions. (closes #9213)
Files:      src/xxd/xxd.c

Patch 8.2.3671
Problem:    Restarting Insert mode in prompt buffer too often when a callback
            switches windows and comes back. (Sean Dewar)
Solution:   Do not set "restart_edit" when already in Insert mode.
            (closes #9212)
Files:      src/window.c, src/testdir/test_prompt_buffer.vim

Patch 8.2.3672 (after 8.2.3670)
Problem:    Build failure with unsigned char.
Solution:   Use int instead of char.
Files:      src/xxd/xxd.c

Patch 8.2.3673
Problem:    Crash when allocating signal stack fails.
Solution:   Only using sourcing info when available. (closes #9215)
Files:      src/globals.h, src/message.c

Patch 8.2.3674
Problem:    When ml_get_buf() fails it messes up IObuff.
Solution:   Return a local pointer. (closes #9214)
Files:      src/memline.c

Patch 8.2.3675
Problem:    Using freed memory when vim_strsave() fails.
Solution:   Clear "last_sourcing_name".  Check for msg_source() called
            recursively. (closes #8217)
Files:      src/message.c

Patch 8.2.3676
Problem:    Unused runtime file.
Solution:   Remove rgb.txt.
Files:      runtime/rgb.txt

Patch 8.2.3677
Problem:    After a put the '] mark is on the last byte of a multi-byte
            character.
Solution:   Move it to the first byte. (closes #9047)
Files:      src/register.c, src/testdir/test_put.vim

Patch 8.2.3678 (after 8.2.3677)
Problem:    Illegal memory access.
Solution:   Ignore changed indent when computing byte offset.
Files:      src/register.c

Patch 8.2.3679
Problem:    objc file detected as Octave. (Antony Lee)
Solution:   Detect objc by preprocessor lines. (Doug Kearns, closes #9223,
            closes #9220)
Files:      runtime/autoload/dist/ft.vim, src/testdir/test_filetype.vim

Patch 8.2.3680
Problem:    Repeated code in xxd.
Solution:   Change exit_on_ferror() to getc_or_die(). (closes #9226)
Files:      src/xxd/xxd.c

Patch 8.2.3681
Problem:    Cannot drag popup window after click on a status line. (Sergey
            Vlasov)
Solution:   Reset on_status_line. (closes #9221)
Files:      src/mouse.c, src/testdir/test_popupwin.vim,
            src/testdir/dumps/Test_popupwin_drag_04.dump

Patch 8.2.3682
Problem:    Vim9: assigning to a script variable drops the required type.
Solution:   Lookup the type of the variable and use it. (closes #9219)
Files:      src/evalvars.c, src/vim9script.c, src/proto/vim9script.pro,
            src/testdir/test_vim9_assign.vim

Patch 8.2.3683
Problem:    Vim9: cannot use `=expr` in :...do commands.
Solution:   Add EX_EXPAND to the commands. (closes #9232)
Files:      src/ex_cmds.h, src/testdir/test_vim9_cmd.vim

Patch 8.2.3684
Problem:    Blockwise insert does not handle autoindent properly.
Solution:   Adjust text column for indent. (closes #9229)
Files:      src/ops.c, src/testdir/test_blockedit.vim

Patch 8.2.3685
Problem:    Visual Studio project files are not recognized.
Solution:   Use the xml file type. (Doug Kearns)
Files:      runtime/filetype.vim, src/testdir/test_filetype.vim

Patch 8.2.3686
Problem:    Filetype detection often mixes up Forth and F#.
Solution:   Add a function to inspect the file contents. (Doug Kearns)
Files:      runtime/autoload/dist/ft.vim, runtime/doc/filetype.txt,
            runtime/doc/syntax.txt, runtime/filetype.vim, runtime/scripts.vim,
            src/testdir/test_filetype.vim

Patch 8.2.3687
Problem:    Blockwise insert does not handle autoindent properly when tab is
            inserted.
Solution:   Adjust text column for indent before computing column.
            (closes #9229)
Files:      src/ops.c, src/testdir/test_blockedit.vim

Patch 8.2.3688
Problem:    The window title is not updated when dragging the scrollbar.
Solution:   Call maketitle(). (Christian Brabandt, closes #9238, closes #5383)
Files:      src/gui.c

Patch 8.2.3689
Problem:    ex_let_one() is too long.
Solution:   Split into multiple functions.
Files:      src/evalvars.c

Patch 8.2.3690
Problem:    Vim9: "filter #pat# cmd" does not work.
Solution:   Do not see #pat# as a comment.
Files:      src/ex_docmd.c, src/testdir/test_vim9_cmd.vim

Patch 8.2.3691
Problem:    Build failure with small features.
Solution:   Add #ifdef. (Dominique Pellé)
Files:      src/gui.c

Patch 8.2.3692
Problem:    Vim9: cannot use :func inside a :def function.
Solution:   Make it work.
Files:      src/vim9compile.c, src/vim9.h, src/vim9execute.c, src/errors.h,
            src/structs.h, src/userfunc.c, src/testdir/test_vim9_func.vim

Patch 8.2.3693
Problem:    Coverity warns for possibly using a NULL pointer.
Solution:   Check for NULL and give an error.
Files:      src/vim9execute.c, src/errors.h

Patch 8.2.3694
Problem:    Cannot use quotes in the count of an Ex command.
Solution:   Add getdigits_quoted().  Give an error when misplacing a quote in
            a range. (closes #9240)
Files:      src/ex_docmd.c, src/charset.c, src/proto/charset.pro,
            src/testdir/test_usercommands.vim

Patch 8.2.3695
Problem:    Confusing error for missing key.
Solution:   Use the actual key for the error. (closes #9241)
Files:      src/eval.c, src/testdir/test_listdict.vim

Patch 8.2.3696
Problem:    Vim9: error for invalid assignment when skipping.
Solution:   Do not check white space when skipping. (closes #9243)
Files:      src/evalvars.c, src/testdir/test_vim9_assign.vim

Patch 8.2.3697
Problem:    Cannot drag a popup without a border.
Solution:   Add the "dragall" option. (closes #9218)
Files:      runtime/doc/popup.txt, src/mouse.c, src/popupwin.c, src/vim.h,
            src/testdir/test_popupwin.vim,
            src/testdir/dumps/Test_popupwin_drag_05.dump,
            src/testdir/dumps/Test_popupwin_drag_06.dump

Patch 8.2.3698
Problem:    Match highlighting continues over breakindent.
Solution:   Stop before the end column. (closes #9242)
Files:      src/match.c, src/proto/match.pro, src/drawline.c,
            src/testdir/test_match.vim,
            src/testdir/dumps/Test_match_linebreak.dump

Patch 8.2.3699
Problem:    The +title feature adds a lot of #ifdef but little code.
Solution:   Graduate the +title feature.
Files:      src/feature.h, src/alloc.c, src/arglist.c, src/autocmd.c,
            src/buffer.c, src/bufwrite.c, src/change.c, src/drawscreen.c,
            src/evalfunc.c, src/ex_cmds.c, src/ex_docmd.c, src/gui.c,
            src/gui_gtk_x11.c, src/if_xcmdsrv.c, src/locale.c, src/main.c,
            src/misc2.c, src/netbeans.c, src/option.c, src/optionstr.c,
            src/os_amiga.c, src/os_mswin.c, src/os_unix.c, src/os_win32.c,
            src/regexp.c, src/term.c, src/ui.c, src/version.c, src/window.c,
            src/globals.h, src/option.h, src/optiondefs.h,
            runtime/doc/options.txt, runtime/doc/various.txt

Patch 8.2.3700
Problem:    Text property highlighting continues over breakindent.
Solution:   Stop before the end column. (closes #9242)
Files:      src/drawline.c, src/testdir/test_textprop.vim,
            src/testdir/dumps/Test_prop_linebreak.dump

Patch 8.2.3701
Problem:    Vim9: invalid LHS is not possible.
Solution:   Remove unreachable error message.
Files:      src/vim9compile.c

Patch 8.2.3702
Problem:    First key in dict is seen as curly expression and fails.
Solution:   Ignore failure of curly expression. (closes #9247)
Files:      src/typval.c, src/dict.c, src/testdir/test_listdict.vim

Patch 8.2.3703 (after 8.2.3686)
Problem:    Most people call F# "fsharp" and not "fs".
Solution:   Rename filetype "fs" to "fsharp".
Files:      runtime/autoload/dist/ft.vim, runtime/filetype.vim,
            src/testdir/test_filetype.vim

Patch 8.2.3704
Problem:    Vim9: cannot use a list declaration in a :def function.
Solution:   Make it work.
Files:      runtime/doc/vim9.txt, src/vim9compile.c, src/errors.h,
            src/testdir/test_vim9_assign.vim

Patch 8.2.3705
Problem:    Cannot pass a lambda name to function() or funcref(). (Yegappan
            Lakshmanan)
Solution:   Handle a lambda name differently.
Files:      src/userfunc.c, src/proto/userfunc.pro, src/evalfunc.c,
            src/testdir/test_expr.vim

Patch 8.2.3706 (after 8.2.3700)
Problem:    Text property highlighting is used on Tab.
Solution:   Only set in_linebreak when not on a Tab. (closes #9242)
Files:      src/drawline.c, src/testdir/test_textprop.vim,
            src/testdir/dumps/Test_prop_after_tab.dump

Patch 8.2.3707
Problem:    Vim9: constant expression of elseif not recognized.
Solution:   Set instruction count before generating the expression.
Files:      src/vim9compile.c, src/testdir/test_vim9_disassemble.vim

Patch 8.2.3708 (after 8.2.3707)
Problem:    Vim9: test fails with different error.
Solution:   Correct the error number.
Files:      src/testdir/test_vim9_cmd.vim

Patch 8.2.3709
Problem:    Vim9: backtick expression expanded when not desired.
Solution:   Only expand a backtick expression for commands that expand their
            argument.  Remove a few outdated TODO comments.
Files:      src/vim9compile.c, src/testdir/test_vim9_cmd.vim

Patch 8.2.3710
Problem:    Vim9: backtick expression expanded for :global.
Solution:   Check the following command.
Files:      runtime/doc/vim9.txt, src/vim9compile.c,
            src/testdir/test_vim9_cmd.vim

Patch 8.2.3711
Problem:    Vim9: memory leak when compiling :elseif fails.
Solution:   Cleanup ppconst.
Files:      src/vim9compile.c, src/testdir/test_vim9_cmd.vim

Patch 8.2.3712
Problem:    Cannot use Vim9 lambda for 'tagfunc'.
Solution:   Make it work, add more tests. (Yegappan Lakshmanan, closes #9250)
Files:      runtime/doc/options.txt, src/insexpand.c, src/option.c,
            src/testdir/test_tagfunc.vim

Patch 8.2.3713
Problem:    MS-Windows: No error message if vimgrep pattern is not matching.
Solution:   Give an error message. (Christian Brabandt, closes #9245,
            closes #8762)
Files:      src/quickfix.c, src/testdir/test_quickfix.vim

Patch 8.2.3714
Problem:    Some unused assignments and ugly code in xxd.
Solution:   Leave out assignments.  Use marcro for fprintf(). (closes #9246)
Files:      src/xxd/xxd.c

Patch 8.2.3715
Problem:    Vim9: valgrind reports spurious problems for a test.
Solution:   Move the test to the set that is known to fail.
Files:      src/testdir/test_vim9_builtin.vim, src/testdir/test_vim9_fails.vim

Patch 8.2.3716
Problem:    Vim9: range without a command is not compiled.
Solution:   Add the ISN_EXECRANGE byte code.
Files:      src/ex_docmd.c, src/proto/ex_docmd.pro, src/vim9compile.c,
            src/vim9execute.c, src/vim9.h,
            src/testdir/test_vim9_disassemble.vim

Patch 8.2.3717
Problem:    Vim9: error for constant list size is only given at runtime.
Solution:   Give the error at compile time if possible.
Files:      src/vim9compile.c, src/testdir/test_vim9_assign.vim,
            src/testdir/test_vim9_script.vim,
            src/testdir/test_vim9_disassemble.vim

Patch 8.2.3718
Problem:    Compiler warns for unused variable without the +textprop feature.
            (John Marriott)
Solution:   Adjust #ifdefs.
Files:      src/drawline.c

Patch 8.2.3719
Problem:    MS-Windows: test sometimes runs into existing swap file.
Solution:   Use a different file name.
Files:      src/testdir/test_buffer.vim

Patch 8.2.3720
Problem:    Vim9: Internal error when invoking closure in legacy context.
Solution:   Give a more appropriate error message. (closes #9251)
Files:      src/errors.h, src/vim9execute.c, src/testdir/test_vim9_func.vim

Patch 8.2.3721
Problem:    Using memory freed by losing the clipboard selection. (Dominique
            Pellé)
Solution:   Check y_array is still valid after calling changed_lines().
            (closes #9253)
Files:      src/errors.h, src/register.c

Patch 8.2.3722
Problem:    Amiga: superfluous messages for freeing lots of yanked text.
Solution:   Assume that the machine isn't that slow these days.
Files:      src/register.c

Patch 8.2.3723
Problem:    When using 'linebreak' a text property starts too early.
Solution:   Decrement "bcol" when looking for property start. (closes #9242)
Files:      src/drawline.c, src/testdir/test_textprop.vim,
            src/testdir/dumps/Test_prop_after_linebreak.dump

Patch 8.2.3724
Problem:    Build error for missing error message in small build.
Solution:   Correct #ifdef.
Files:      src/errors.h

Patch 8.2.3725
Problem:    Cannot use a lambda for 'completefunc' and 'omnifunc'.
Solution:   Implement lambda support. (Yegappan Lakshmanan, closes #9257)
Files:      runtime/doc/options.txt, src/buffer.c, src/insexpand.c,
            src/option.c, src/optionstr.c, src/proto/insexpand.pro,
            src/proto/tag.pro, src/proto/userfunc.pro, src/structs.h,
            src/tag.c, src/userfunc.c, src/testdir/test_ins_complete.vim,
            src/testdir/test_tagfunc.vim

Patch 8.2.3726
Problem:    README file in a config directory gets wrong filetype.
Solution:   Match README before patterns that match everything in a directory.
Files:      runtime/filetype.vim, src/testdir/test_filetype.vim

Patch 8.2.3727
Problem:    In a gnome terminal keys are recognized as mouse events.
Solution:   Only recognize DEC mouse events when four numbers are following.
            (closes #9256)
Files:      src/term.c, src/testdir/test_termcodes.vim

Patch 8.2.3728
Problem:    Internal error when passing range() to list2blob().
Solution:   Materialize the list first. (closes #9262)
Files:      src/blob.c, src/testdir/test_blob.vim

Patch 8.2.3729
Problem:    No support for squirrels.
Solution:   Recognize nuts. (closes #9259)
Files:      runtime/filetype.vim, src/testdir/test_filetype.vim

Patch 8.2.3730
Problem:    "/etc/Muttrc.d/README" gets filetype muttrc.
Solution:   Move the Muttrc.d pattern down, add exception for *.rc files.
Files:      runtime/filetype.vim, src/testdir/test_filetype.vim

Patch 8.2.3731
Problem:    "set! termcap" shows codes in one column, but not keys.
Solution:   Also use one column for keys. (closes #9258)
Files:      src/option.c, src/term.c, src/proto/term.pro,
            src/testdir/test_set.vim

Patch 8.2.3732 (after 8.2.3731)
Problem:    "set! termcap" test fails.
Solution:   Account for keys without a t_xx entry.
Files:      src/testdir/test_set.vim

Patch 8.2.3733
Problem:    Vim9: using "legacy" before range does not work.
Solution:   Skip over range before parsing command. (closes #9270)
Files:      src/vim9compile.c, src/usercmd.c, src/testdir/test_vim9_cmd.vim

Patch 8.2.3734
Problem:    Vim9: crash when no pattern match found.
Solution:   Check for error.
Files:      src/vim9execute.c

Patch 8.2.3735
Problem:    Cannot use a lambda for 'imactivatefunc'.
Solution:   Add lambda support for 'imactivatefunc' and 'imstatusfunc'.
            (Yegappan Lakshmanan, closes #9275)
Files:      runtime/doc/options.txt, src/alloc.c, src/gui_xim.c,
            src/optionstr.c, src/proto/gui_xim.pro,
            src/testdir/test_iminsert.vim, src/testdir/test_ins_complete.vim

Patch 8.2.3736
Problem:    Test fails without the channel feature. (Dominique Pellé)
Solution:   Source the check.vim script. (closes #9277)
Files:      src/testdir/test_vim9_fails.vim

Patch 8.2.3737
Problem:    Test fails without the 'autochdir' option.
Solution:   Check that the option is available. (Dominique Pellé, closes #9272)
Files:      src/testdir/test_cd.vim

Patch 8.2.3738
Problem:    Screen is cleared when a FocusLost autocommand triggers.
Solution:   Do not redraw when at the hit-enter or more prompt. (closes #9274)
Files:      src/misc1.c

Patch 8.2.3739
Problem:    In wrong directory when using win_execute() with 'acd' set.
Solution:   Restore the directory when returning to the window. (closes #9276)
Files:      src/window.c, src/testdir/test_autochdir.vim

Patch 8.2.3740
Problem:    Memory left allocated on exit when using Tcl.
Solution:   Call Tcl_Finalize().
Files:      src/if_tcl.c, src/proto/if_tcl.pro, src/alloc.c

Patch 8.2.3741
Problem:    Using freed memory in open command.
Solution:   Make a copy of the current line.
Files:      src/ex_docmd.c, src/testdir/test_ex_mode.vim

Patch 8.2.3742
Problem:    Dec mouse test fails without gnome terminfo entry.
Solution:   Check if there is a gnome entry. Also fix 'acd' test on
            MS-Windows. (Ozaki Kiichi, closes #9282)
Files:      src/testdir/test_termcodes.vim, src/testdir/test_autochdir.vim

Patch 8.2.3743
Problem:    ":sign" can add a highlight group without a name.
Solution:   Give an error if the group name is missing. (closes #9280)
Files:      src/sign.c, src/errors.h, src/testdir/test_signs.vim

Patch 8.2.3744
Problem:    E854 is not tested; some spelling suggestions are not tested.
Solution:   Add a couple of tests. (Dominique Pellé, closes #9279)
Files:      src/testdir/test_options.vim, src/testdir/test_spell.vim

Patch 8.2.3745
Problem:    Autochdir test fails without the +channel feature.
Solution:   Remove the ch_logfile() call. (Dominique Pellé, closes #9281)
Files:      src/testdir/test_autochdir.vim

Patch 8.2.3746
Problem:    Cannot disassemble function starting with "debug" or "profile".
Solution:   Check for white space following. (closes #9273)
Files:      src/vim9execute.c, src/testdir/test_vim9_script.vim

Patch 8.2.3747 (after 8.2.3743)
Problem:    Cannot remove highlight from an existing sign. (James McCoy)
Solution:   Only reject empty argument for a new sign.
Files:      src/sign.c, src/testdir/test_signs.vim

Patch 8.2.3748 (after 8.2.3747)
Problem:    Giving an error for an empty sign argument breaks a plugin.
Solution:   Do not give an error.
Files:      src/sign.c, src/errors.h, src/testdir/test_signs.vim

Patch 8.2.3749
Problem:    Error messages are everywhere.
Solution:   Move more error messages to errors.h and adjust the names.
Files:      src/errors.h, src/regexp_bt.c, src/regexp.c, src/regexp_nfa.c,
            src/globals.h, src/memfile.c, src/tag.c, src/getchar.c,
            src/bufwrite.c, src/cmdexpand.c

Patch 8.2.3750
Problem:    Error messages are everywhere.
Solution:   Move more error messages to errors.h and adjust the names.
Files:      src/globals.h, src/errors.h, src/blob.c, src/buffer.c,
            src/channel.c, src/ex_docmd.c, src/job.c, src/list.c, src/mark.c,
            src/misc1.c, src/os_unix.c, src/popupwin.c, src/register.c,
            src/session.c, src/spellfile.c, src/term.c, src/userfunc.c

Patch 8.2.3751
Problem:    Cannot assign a lambda to an option that takes a function.
Solution:   Automatically convert the lambda to a string. (Yegappan
            Lakshmanan, closes #9286)
Files:      runtime/doc/options.txt, src/eval.c, src/proto/eval.pro,
            src/evalvars.c, src/if_mzsch.c, src/if_ruby.c, src/if_tcl.c,
            src/option.c, src/option.h, src/optiondefs.h,
            src/proto/option.pro, src/spell.c, src/typval.c,
            src/vim9compile.c, src/testdir/test_iminsert.vim,
            src/testdir/test_ins_complete.vim, src/testdir/test_tagfunc.vim

Patch 8.2.3752
Problem:    Build error when using Photon GUI.
Solution:   Adjust #ifdef. (closes #9288)
Files:      src/beval.c

Patch 8.2.3753
Problem:    Vim9: function unreferenced while called is never deleted.
Solution:   Delete a function when no longer referenced.
Files:      src/vim9execute.c, src/userfunc.c, src/proto/userfunc.pro

Patch 8.2.3754 (after 8.2.3615)
Problem:    Undesired changing of the indent of the first formatted line.
Solution:   Do not indent the first formatted line.
Files:      src/textformat.c, src/testdir/test_indent.vim

Patch 8.2.3755
Problem:    Coverity warns for using a buffer in another scope.
Solution:   Declare the buffer in a common scope.
Files:      src/evalvars.c

Patch 8.2.3756
Problem:    might crash when callback is not valid.
Solution:   Check for valid callback. (Yegappan Lakshmanan, closes #9293)
Files:      src/insexpand.c, src/option.c, src/tag.c, src/job.c,
            src/userfunc.c, src/testdir/test_iminsert.vim,
            src/testdir/test_ins_complete.vim, src/testdir/test_tagfunc.vim

Patch 8.2.3757
Problem:    An overlong highlight group name is silently truncated.
Solution:   Give an error if the name is too long. (closes #9289)
Files:      src/errors.h, src/highlight.c, src/testdir/test_highlight.vim

Patch 8.2.3758
Problem:    Options that take a function insufficiently tested.
Solution:   Add additional tests and enhance existing tests. (Yegappan
            Lakshmanan, closes #9298)
Files:      src/testdir/test_ins_complete.vim, src/testdir/test_normal.vim,
            src/testdir/test_tagfunc.vim

Patch 8.2.3759
Problem:    Quickfix buffer becomes hidden while still in a window.
Solution:   Check if the closed window is the last window showing the quickfix
            buffer. (Yegappan Lakshmanan, closes #9303, closes #9300)
Files:      src/quickfix.c, src/testdir/test_quickfix.vim, src/window.c

Patch 8.2.3760
Problem:    Not automatically handling gnome terminal mouse like xterm.
Solution:   Default 'ttymouse' to "xterm" and recognize Focus events.
            (issue #9296)
Files:      src/os_unix.c

Patch 8.2.3761
Problem:    Focus change is not passed on to a terminal window.
Solution:   If the current window is a terminal and focus events are enabled
            send a focus event escape sequence to the terminal.
Files:      src/ui.c, src/terminal.c, src/proto/terminal.pro,
            src/testdir/test_terminal.vim,
            src/testdir/dumps/Test_terminal_focus_1.dump,
            src/testdir/dumps/Test_terminal_focus_2.dump

Patch 8.2.3762
Problem:    If the quickfix buffer is wiped out getqflist() still returns its
            number.
Solution:   Use zero if the buffer is no longer present. (Yegappan Lakshmanan,
            closes #9306)
Files:      src/quickfix.c, src/testdir/test_quickfix.vim

Patch 8.2.3763
Problem:    When editing the command line a FocusLost callback may cause the
            screen to scroll up.
Solution:   Do not redraw at the last line but at the same place where the
            command line was before. (closes #9295)
Files:      src/ex_getln.c, src/ui.c, src/beval.c, src/channel.c,
            src/drawscreen.c, src/proto/drawscreen.pro, src/job.c,
            src/popupwin.c, src/sound.c, src/terminal.c, src/time.c,
            src/testdir/test_terminal.vim,
            src/testdir/dumps/Test_terminal_focus_1.dump,
            src/testdir/dumps/Test_terminal_focus_2.dump,
            src/testdir/dumps/Test_terminal_focus_3.dump

Patch 8.2.3764
Problem:    Cannot see any text when window was made zero lines or zero
            columns.
Solution:   Ensure there is at least one line and column. (fixes #9307)
Files:      src/window.c, src/proto/window.pro, src/normal.c, src/edit.c,
            src/testdir/test_window_cmd.vim

Patch 8.2.3765
Problem:    Vim9: cannot use a lambda for 'opfunc' and others.
Solution:   Convert the lambda to a string.
Files:      src/vim9compile.c, src/vim9.h, src/vim9execute.c,
            src/testdir/test_vim9_func.vim,
            src/testdir/test_vim9_disassemble.vim

Patch 8.2.3766
Problem:    Converting a funcref to a string leaves out "g:", causing the
            meaning of the name depending on the context.
Solution:   Prepend "g:" for a global function.
Files:      src/eval.c, src/testdir/test_functions.vim

Patch 8.2.3767 (after 8.2.3766)
Problem:    Crash when using NULL partial.
Solution:   Check for NULL.
Files:      src/eval.c

Patch 8.2.3768
Problem:    timer_info() has the wrong repeat value in a timer callback.
            (Sergey Vlasov)
Solution:   Do not add one to the repeat value when in the callback.
            (closes #9294)
Files:      src/time.c, src/testdir/test_timers.vim

Patch 8.2.3769
Problem:    Zig files are not recognized.
Solution:   Add *.zig. (Gregory Anders, closes #9313)
Files:      runtime/filetype.vim, src/testdir/test_filetype.vim

Patch 8.2.3770
Problem:    New compiler warnings from clang-12 and clang-13.
Solution:   Adjust CI and suppress some warnings. (Ozaki Kiichi, closes #9314)
Files:      .github/workflows/ci.yml, ci/config.mk.clang-12.sed,
            src/os_unix.c, src/spellfile.c

Patch 8.2.3771
Problem:    Vim9: accessing freed memory when checking type.
Solution:   Make a copy of a function type.
Files:      src/structs.h, src/evalvars.c, src/vim9script.c,
            src/testdir/test_vim9_func.vim

Patch 8.2.3772
Problem:    Timer info test fails on slow machine.
Solution:   Use WaitForAssert().
Files:      src/testdir/test_timers.vim

Patch 8.2.3773
Problem:    Wrong window size when a modeline changes 'columns' and there is
            more than one tabpage. (Michael Soyka)
Solution:   Adjust the frames of all tabpages. (closes #9315)
Files:      src/window.c

Patch 8.2.3774 (after 8.2.3773)
Problem:    Test for command line height fails.
Solution:   Use another way to handle window size change.
Files:      src/structs.h, src/window.c

Patch 8.2.3775
Problem:    Vim9: lambda compiled without outer context when debugging.
Solution:   When compiling a lambda for debugging also compile it without.
            (closes #9302)
Files:      src/vim9compile.c, src/testdir/test_vim9_script.vim
