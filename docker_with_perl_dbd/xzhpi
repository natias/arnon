Problem:    No check for a following command when calling a function fails.
Solution:   Also check for a following command when inside a try block.
            (closes #5642)
Files:      src/userfunc.c, src/testdir/test_user_func.vim

Patch 8.2.0268 (after 8.2.0267)
Problem:    Trycatch test fails.
Solution:   When calling function fails only check for following command, do
            not give another error.
Files:      src/userfunc.c

Patch 8.2.0269
Problem:    Vim9: operator after list index does not work. (Yasuhiro
            Matsumoto)
Solution:   After indexing a list change the type to the list member type.
            (closes #5651)
Files:      src/vim9compile.c, src/testdir/test_vim9_expr.vim

Patch 8.2.0270
Problem:    Some code not covered by tests.
Solution:   Add test cases. (Yegappan Lakshmanan, closes #5649)
Files:      src/testdir/test_autocmd.vim, src/testdir/test_buffer.vim,
            src/testdir/test_edit.vim, src/testdir/test_ex_mode.vim,
            src/testdir/test_excmd.vim, src/testdir/test_expand.vim,
            src/testdir/test_filetype.vim, src/testdir/test_findfile.vim,
            src/testdir/test_join.vim, src/testdir/test_move.vim,
            src/testdir/test_normal.vim, src/testdir/test_registers.vim,
            src/testdir/test_source.vim, src/testdir/test_tabpage.vim,
            src/testdir/test_tagjump.vim, src/testdir/test_vimscript.vim,
            src/testdir/test_visual.vim, src/testdir/test_window_cmd.vim,
            src/testdir/test_writefile.vim

Patch 8.2.0271
Problem:    The "num64" feature is available everywhere and building without
            it causes problems.
Solution:   Graduate the "num64" feature. (James McCoy, closes #5650)
Files:      src/evalfunc.c, src/feature.h, src/message.c, src/structs.h,
            src/testdir/test_expr.vim, src/testdir/test_largefile.vim,
            src/testdir/test_sort.vim, src/testdir/test_vimscript.vim,
            src/version.c

Patch 8.2.0272
Problem:    ":helptags ALL" gives error for directories without write
            permission. (MatÄ›j Cepl)
Solution:   Ignore errors for ":helptags ALL". (Ken Takata, closes #5026,
            closes #5652)
Files:      src/ex_cmds.c, src/testdir/test_help.vim

Patch 8.2.0273
Problem:    MS-Windows uninstall may delete wrong batch file.
Solution:   Add specific marker in the generated batch file. (Ken Takata,
            closes #5654)
Files:      src/Make_mvc.mak, src/dosinst.c, src/dosinst.h, src/uninstall.c

Patch 8.2.0274
Problem:    Hang with combination of feedkeys(), Ex mode and :global.
            (Yegappan Lakshmanan)
Solution:   Add the pending_exmode_active flag.
Files:      src/ex_docmd.c, src/globals.h, src/getchar.c,
            src/testdir/test_ex_mode.vim

Patch 8.2.0275
Problem:    Some Ex code not covered by tests.
Solution:   Add test cases. (Yegappan Lakshmanan, closes #5659)
Files:      src/testdir/test_arglist.vim, src/testdir/test_autocmd.vim,
            src/testdir/test_excmd.vim, src/testdir/test_quickfix.vim,
            src/testdir/test_search.vim, src/testdir/test_swap.vim,
            src/testdir/test_window_cmd.vim

Patch 8.2.0276
Problem:    Vim9: not allowing space before ")" in function call is too
            restrictive. (Ben Jackson)
Solution:   Skip space before the ")".  Adjust other space checks.
Files:      src/vim9compile.c, src/testdir/test_vim9_expr.vim

Patch 8.2.0277
Problem:    Vim9: not all instructions covered by tests.
Solution:   Add more test cases.
Files:      src/testdir/test_vim9_disassemble.vim

Patch 8.2.0278
Problem:    Channel test is flaky on Mac.
Solution:   Reset variable before sending message.
Files:      src/testdir/test_channel.vim

Patch 8.2.0279
Problem:    Vim9: no test for deleted :def function.
Solution:   Add a test.  Clear uf_cleared flag when redefining a function.
Files:      src/userfunc.c, src/testdir/test_vim9_script.vim

Patch 8.2.0280
Problem:    Vim9: throw in :def function not caught higher up.
Solution:   Set "need_rethrow".
Files:      src/vim9execute.c, src/testdir/test_vim9_script.vim

Patch 8.2.0281
Problem:    Two placed signs in the same line are not combined.  E.g. in the
            terminal debugger a breakpoint and the PC cannot be both be
            displayed.
Solution:   Combine the sign column and line highlight attributes.
Files:      src/sign.c, src/testdir/test_signs.vim,
            src/testdir/dumps/Test_sign_cursor_3.dump,
            src/testdir/dumps/Test_sign_cursor_4.dump

Patch 8.2.0282
Problem:    Vim9: setting number option not tested.
Solution:   Add more tests.   Fix assigning to global variable.
Files:      src/testdir/test_vim9_expr.vim, src/testdir/test_vim9_script.vim,
            src/vim9execute.c

Patch 8.2.0283
Problem:    Vim9: failing to load script var not tested.
Solution:   Add more tests.   Fix using s: in old script.
Files:      src/testdir/test_vim9_expr.vim, src/vim9compile.c,
            src/testdir/test_vim9_script.vim

Patch 8.2.0284
Problem:    Vim9: assignment test fails.
Solution:   Avoid duplicating "s:".
Files:      src/vim9compile.c

Patch 8.2.0285
Problem:    Unused error message. Cannot create s:var.
Solution:   Remove the error message. Make assignment to s:var work.
Files:      src/vim9compile.c, src/vim9execute.c,
            src/testdir/test_vim9_script.vim

Patch 8.2.0286
Problem:    Cannot use popup_close() for a terminal popup.
Solution:   Allow using popup_close(). (closes #5666)
Files:      src/popupwin.c, runtime/doc/popup.txt,
            src/testdir/test_terminal.vim,
            src/testdir/dumps/Test_terminal_popup_5.dump,
            src/testdir/dumps/Test_terminal_popup_6.dump

Patch 8.2.0287
Problem:    Vim9: return in try block not tested; catch with pattern not
            tested.
Solution:   Add tests.  Make it work.
Files:      src/vim9execute.c, src/testdir/test_vim9_script.vim

Patch 8.2.0288
Problem:    Vim9: some float and blob operators not tested.
Solution:   Add float and blob tests.  Fix addition.
Files:      src/testdir/test_vim9_expr.vim, src/vim9compile.c

Patch 8.2.0289
Problem:    Vim9: :echo did not clear the rest of the line.
Solution:   Call msg_clr_eos(). (Ken Takata, closes #5668)
Files:      src/vim9execute.c

Patch 8.2.0290
Problem:    Running individual test differs from all tests.
Solution:   Pass on environment variables. (Yee Cheng Chin, closes #5672)
Files:      src/testdir/Makefile, src/testdir/README.txt

Patch 8.2.0291
Problem:    Vim9: assigning [] to list<string> doesn't work.
Solution:   Use void for empty list and dict. (Ken Takata, closes #5669)
Files:      src/vim9compile.c, src/globals.h, src/testdir/test_vim9_script.vim

Patch 8.2.0292
Problem:    Vim9: CHECKNR and CHECKTYPE instructions not tested.
Solution:   Add tests.
Files:      src/testdir/test_vim9_expr.vim, src/testdir/test_vim9_script.vim

Patch 8.2.0293
Problem:    Various Ex commands not sufficiently tested.
Solution:   Add more test cases. (Yegappan Lakshmanan, closes #5673)
Files:      src/testdir/test_arglist.vim, src/testdir/test_cmdline.vim,
            src/testdir/test_ex_mode.vim, src/testdir/test_excmd.vim,
            src/testdir/test_expand.vim, src/testdir/test_filetype.vim,
            src/testdir/test_filter_cmd.vim, src/testdir/test_global.vim,
            src/testdir/test_normal.vim, src/testdir/test_plus_arg_edit.vim,
            src/testdir/test_quickfix.vim, src/testdir/test_trycatch.vim,
            src/testdir/test_vimscript.vim

Patch 8.2.0294
Problem:    Cannot use Ex command that is also a function name.
Solution:   Recognize an Ex command by a colon prefix.
Files:      src/vim9compile.c, src/testdir/test_vim9_script.vim,
            runtime/doc/vim9.txt

Patch 8.2.0295
Problem:    Highlighting for :s wrong when using different separator.
Solution:   Use separate argument for search direction and separator. (Rob
            Pilling, closes #5665)
Files:      src/ex_docmd.c, src/ex_getln.c, src/gui.c, src/normal.c,
            src/proto/search.pro, src/quickfix.c, src/search.c, src/spell.c,
            src/tag.c, src/testdir/dumps/Test_incsearch_substitute_15.dump,
            src/testdir/test_search.vim

Patch 8.2.0296
Problem:    Mixing up "long long" and __int64 may cause problems. (John
            Marriott)
Solution:   Pass varnumber_T to vim_snprintf().  Add v:numbersize.
Files:      src/message.c, src/eval.c, src/fileio.c, src/json.c, src/ops.c,
            src/vim.h, src/structs.h, src/evalvars.c, runtime/doc/eval.txt,
            runtime/doc/various.txt, src/testdir/test_eval_stuff.vim

Patch 8.2.0297
Problem:    Compiler warnings for the Ruby interface.
Solution:   Undefine a few macros, fix initialization. (Ozaki Kiichi,
            closes #5677)
Files:      src/if_ruby.c

Patch 8.2.0298
Problem:    Vim9 script: cannot start command with a string constant.
Solution:   Recognize expression starting with '('.
Files:      src/ex_docmd.c, src/vim9compile.c,
            src/testdir/test_vim9_script.vim, runtime/doc/vim9.txt

Patch 8.2.0299
Problem:    Vim9: ISN_STORE with argument not tested.  Some cases in tv2bool()
            not tested.
Solution:   Add tests.  Add test_unknown() and test_void().
Files:      src/testing.c, src/proto/testing.pro, src/evalfunc.c,
            src/testdir/test_vim9_disassemble.vim,
            src/testdir/test_vim9_expr.vim, runtime/doc/eval.txt,
            runtime/doc/testing.txt

Patch 8.2.0300
Problem:    Vim9: expression test fails without channel support.
Solution:   Add has('channel') check.
Files:      src/testdir/test_vim9_expr.vim

Patch 8.2.0301
Problem:    Insufficient testing for exception handling and the "attention"
            prompt.
Solution:   Add test cases. (Yegappan Lakshmanan, closes #5681)
Files:      src/testdir/test_swap.vim, src/testdir/test_trycatch.vim

Patch 8.2.0302
Problem:    Setting 'term' may cause error in TermChanged autocommand.
Solution:   Use aucmd_prepbuf() to switch to the buffer where the autocommand
            is to be executed. (closes #5682)
Files:      src/term.c, src/testdir/test_autocmd.vim

Patch 8.2.0303
Problem:    TermChanged test fails in the GUI.
Solution:   Skip the test when running the GUI.
Files:      src/testdir/test_autocmd.vim

Patch 8.2.0304
Problem:    Terminal test if failing on some systems.
Solution:   Wait for the job to finish. (James McCoy)
Files:      src/testdir/test_terminal.vim

Patch 8.2.0305
Problem:    Relativenumber test fails on some systems. (James McCoy)
Solution:   Clear the command line.
Files:      src/testdir/test_number.vim,
            src/testdir/dumps/Test_relnr_colors_2.dump,
            src/testdir/dumps/Test_relnr_colors_3.dump

Patch 8.2.0306
Problem:    Vim9: :substitute(pat(repl does not work in Vim9 script.
Solution:   Remember starting with a colon. (closes #5676)
Files:      src/ex_docmd.c, src/testdir/test_vim9_script.vim

Patch 8.2.0307
Problem:    Python 3 vim.eval not well tested.
Solution:   Add a test. (Dominique PellÃ©, closes #5680)
Files:      src/testdir/test_python3.vim

Patch 8.2.0308
Problem:    'showbreak' does not work for a very long line. (John Little)
Solution:   Check whether 'briopt' contains "sbr". (Ken Takata, closes #5523,
            closes #5684)
Files:      src/drawline.c, src/testdir/test_breakindent.vim

Patch 8.2.0309
Problem:    Window-local values have confusing name.
Solution:   Rename w_p_bri* to w_briopt_*.
Files:      src/structs.h, src/indent.c, src/drawline.c

Patch 8.2.0310
Problem:    Autocmd test fails on a slow system.
Solution:   Adjust the expectations. (James McCoy, closes #5685)
Files:      src/testdir/test_autocmd.vim

Patch 8.2.0311
Problem:    Vim9: insufficient script tests.
Solution:   Add tests.  Free imports when re-using a script.
Files:      src/testdir/test_vim9_script.vim, src/scriptfile.c

Patch 8.2.0312
Problem:    Vim9: insufficient script tests.
Solution:   Add more tests.  Make "import * as Name" work.
Files:      src/testdir/test_vim9_script.vim, src/vim9script.c,
            src/proto/vim9script.pro, src/vim9compile.c

Patch 8.2.0313
Problem:    Vim9: insufficient script tests.
Solution:   Add tests.  Make import of alphanumeric name work.
Files:      src/testdir/test_vim9_script.vim, src/vim9script.c

Patch 8.2.0314
Problem:    Short name not set for terminal buffer.
Solution:   Set the short name. (closes #5687)
Files:      src/terminal.c, src/testdir/test_terminal.vim

Patch 8.2.0315
Problem:    Build failure on HP-UX system.
Solution:   Use LONG_LONG_MIN instead of LLONG_MIN.  Add type casts for switch
            statement. (John Marriott)
Files:      src/structs.h, src/json.c

Patch 8.2.0316
Problem:    ex_getln.c code has insufficient test coverage.
Solution:   Add more tests. Fix a problem. (Yegappan Lakshmanan, closes #5693)
Files:      src/cmdhist.c, src/testdir/test_cmdline.vim,
            src/testdir/test_functions.vim, src/testdir/test_history.vim,
            src/testdir/test_menu.vim

Patch 8.2.0317
Problem:    MSVC: _CRT_SECURE_NO_DEPRECATE not defined on DEBUG build.
Solution:   Move where CFLAGS is updated. (Ken Takata, closes #5692)
Files:      src/Make_mvc.mak

Patch 8.2.0318
Problem:    Vim9: types not sufficiently tested.
Solution:   Add tests with more types.
Files:      src/globals.h, src/vim9compile.c,
            src/testdir/test_vim9_script.vim, src/testdir/test_vim9_expr.vim

Patch 8.2.0319
Problem:    File missing in distribution, comments outdated.
Solution:   Correct path of README file.  Update comments.
Files:      Filelist, src/evalvars.c, src/register.c, src/if_python3.c

Patch 8.2.0320
Problem:    No Haiku support.
Solution:   Add support for Haiku. (Emir SarÄ±, closes #5605)
Files:      Filelist, runtime/doc/Makefile, runtime/doc/eval.txt,
            runtime/doc/gui.txt, runtime/doc/help.txt,
            runtime/doc/options.txt, runtime/doc/os_haiku.txt,
            runtime/doc/starting.txt, runtime/doc/tags,
            runtime/gvimrc_example.vim, runtime/vimrc_example.vim,
            src/INSTALL, src/Makefile, src/auto/configure, src/configure.ac,
            src/evalfunc.c, src/feature.h, src/fileio.c, src/globals.h,
            src/gui.c, src/gui.h, src/gui_haiku.cc, src/gui_haiku.h,
            src/mbyte.c, src/menu.c, src/misc1.c, src/mouse.c, src/option.h,
            src/os_haiku.h, src/os_haiku.rdef, src/os_unix.c, src/os_unix.h,
            src/osdef1.h.in, src/proto.h, src/proto/gui_haiku.pro, src/pty.c,
            src/screen.c, src/structs.h, src/term.c, src/version.c, src/vim.h

Patch 8.2.0321
Problem:    Vim9: ":execute" does not work yet.
Solution:   Add ISN_EXECUTE. (closes #5699) Also make :echo work with more
            than one argument.
Files:      src/vim9.h, src/vim9compile.c, src/vim9execute.c,
            src/testdir/test_vim9_disassemble.vim,
            src/testdir/test_vim9_script.vim

Patch 8.2.0322
Problem:    Vim9: error checks not tested.
Solution:   Add more test cases.  Avoid error for function loaded later.
Files:      src/vim9compile.c, src/evalvars.c, src/testdir/test_vim9_script.vim

Patch 8.2.0323
Problem:    Vim9: calling a function that is defined later is slow.
Solution:   Once the function is found update the instruction so it can be
            called directly.
Files:      src/vim9execute.c, src/testdir/test_vim9_script.vim,
            src/testdir/test_vim9_disassemble.vim

Patch 8.2.0324
Problem:    Text property not updated correctly when inserting/deleting.
Solution:   Use the right column when deleting. Make zero-width text
            properties respect start_incl and end_incl. (Axel Forsman,
            closes #5696, closes #5679)
Files:      src/change.c, src/textprop.c, src/testdir/test_listener.vim,
            src/testdir/test_textprop.vim

Patch 8.2.0325
Problem:    Ex_getln.c code not covered by tests.
Solution:   Add a few more tests. (Yegappan Lakshmanan, closes #5702)
Files:      src/testdir/test_cmdline.vim, src/testdir/test_ex_mode.vim,
            src/testdir/test_functions.vim, src/testdir/test_history.vim,
            src/testdir/test_options.vim

Patch 8.2.0326
Problem:    Compiler warning for using uninitialized variable. (Yegappan
            Lakshmanan)
Solution:   Do not jump to failed but return.
Files:      src/vim9execute.c

Patch 8.2.0327
Problem:    Crash when opening and closing two popup terminal windows.
Solution:   Check that prevwin is valid. (closes #5707)
Files:      src/popupwin.c, src/testdir/test_terminal.vim

Patch 8.2.0328
Problem:    No redraw when leaving terminal-normal mode in a terminal popup
            window.
Solution:   Redraw the popup window. (closes #5708)
Files:      src/macros.h, src/vim.h, src/terminal.c, src/drawscreen.c,
            src/move.c, src/popupwin.c, src/testdir/test_terminal.vim,
            src/testdir/dumps/Test_terminal_popup_7.dump,
            src/testdir/dumps/Test_terminal_popup_8.dump

Patch 8.2.0329
Problem:    Popup filter converts 0x80 bytes.
Solution:   Keep 0x80 bytes as-is. (Ozaki Kiichi, closes #5706)
Files:      src/popupwin.c, src/testdir/test_popupwin.vim

Patch 8.2.0330
Problem:    Build error with popup window but without terminal.
Solution:   Add #ifdef.
Files:      src/popupwin.c

Patch 8.2.0331
Problem:    Internal error when using test_void() and test_unknown().
            (Dominique PellÃ©)
Solution:   Give a normal error.
Files:      src/evalfunc.c, src/testdir/test_functions.vim,
            src/testdir/test_vimscript.vim

Patch 8.2.0332
Problem:    Some code in ex_getln.c not covered by tests.
Solution:   Add a few more tests. (Yegappan Lakshmanan, closes #5710)
Files:      src/testdir/test_arabic.vim, src/testdir/test_cmdline.vim

Patch 8.2.0333
Problem:    Terminal in popup test is flaky.
Solution:   Make sure redraw is done before opening the popup.
Files:      src/testdir/test_terminal.vim,
            src/testdir/dumps/Test_terminal_popup_1.dump

Patch 8.2.0334
Problem:    Abort called when using test_void(). (Dominique PellÃ©)
Solution:   Only give an error, don't abort.
Files:      src/message.c, src/proto/message.pro, src/evalfunc.c,
            src/eval.c, src/json.c, src/testdir/test_functions.vim

Patch 8.2.0335
Problem:    No completion for :disassemble.
Solution:   Make completion work.  Also complete script-local functions if the
            name starts with "s:".
Files:      src/cmdexpand.c, src/testdir/test_cmdline.vim,
            runtime/doc/vim9.txt

Patch 8.2.0336
Problem:    Vim9: insufficient test coverage for compiling.
Solution:   Add more tests.
Files:      src/testdir/test_vim9_expr.vim, src/testdir/test_vim9_script.vim,
            src/vim9.h, src/vim9compile.c, src/vim9execute.c

Patch 8.2.0337
Problem:    Build fails on a few systems.
Solution:   Use vim_snprintf() instead of snprintf().
Files:      src/cmdexpand.c

Patch 8.2.0338
Problem:    Build failure without the channel feature.
Solution:   Add #ifdef
Files:      src/vim9compile.c

Patch 8.2.0339
Problem:    Vim9: function return type may depend on arguments.
Solution:   Instead of a fixed return type use a function to figure out the
            return type.
Files:      src/evalfunc.c, src/proto/evalfunc.pro, src/vim9compile.c,
            src/evalbuffer.c, src/proto/evalbuffer.pro,
            src/testdir/test_vim9_script.vim

Patch 8.2.0340
Problem:    Vim9: function and partial types not tested.
Solution:   Support more for partial, add tests.
Files:      src/vim9.h, src/vim9compile.c, src/vim9execute.c,
            src/testdir/test_vim9_script.vim

Patch 8.2.0341
Problem:    Using ":for" in Vim9 script gives an error.
Solution:   Pass the LET_NO_COMMAND flag. (closes #5715)
Files:      src/eval.c, src/testdir/test_vim9_script.vim

Patch 8.2.0342
Problem:    Some code in ex_getln.c not covered by tests.
Solution:   Add more tests. (Yegappan Lakshmanan, closes #5717)
Files:      src/testdir/test_cmdline.vim, src/testdir/test_ex_mode.vim,
            src/testdir/test_history.vim, src/testdir/test_iminsert.vim

Patch 8.2.0343
Problem:    Vim9: using wrong instruction, limited test coverage.
Solution:   Use ISN_PUSHJOB.  Add a few more tests.
Files:      src/vim9compile.c, src/vim9execute.c,
            src/testdir/test_vim9_script.vim,
            src/testdir/test_vim9_disassemble.vim

Patch 8.2.0344
Problem:    ":def" not skipped properly.
Solution:   Add CMD_def to list of commands the require evaluation even when
            not being executed.
Files:      src/ex_docmd.c

Patch 8.2.0345
Problem:    Compiler warning when building without the float feature.
Solution:   Add #ifdef. (John Marriott)
Files:      src/evalfunc.c

Patch 8.2.0346
Problem:    Vim9: finding common list type not tested.
Solution:   Add more tests.  Fix listing function.  Fix overwriting type.
Files:      src/vim9compile.c, src/userfunc.c,
            src/testdir/test_vim9_script.vim, src/testdir/runtest.vim,
            src/testdir/test_vim9_disassemble.vim

Patch 8.2.0347
Problem:    Various code not covered by tests.
Solution:   Add more test coverage. (Yegappan Lakshmanan, closes #5720)
Files:      src/testdir/gen_opt_test.vim, src/testdir/test86.in,
            src/testdir/test_cmdline.vim, src/testdir/test_digraph.vim,
            src/testdir/test_ex_mode.vim, src/testdir/test_history.vim

Patch 8.2.0348
Problem:    Vim9: not all code tested.
Solution:   Add a few more tests. fix using "b:" in literal dictionary.
Files:      src/testdir/test_vim9_expr.vim, src/vim9compile.c,
            src/proto/vim9compile.pro, src/testdir/test_vim9_script.vim

Patch 8.2.0349
Problem:    Vim9: constant expression not well tested.
Solution:   Add tests for "if" with constant expression.
Files:      src/testdir/test_vim9_script.vim

Patch 8.2.0350
Problem:    Vim9: expression tests don't use recognized constants.
Solution:   Recognize "true" and "false" as constants.  Make skipping work for
            assignment and expression evaluation.
Files:      src/vim9compile.c

Patch 8.2.0351
Problem:    Terminal in popup test is still a bit flaky.
Solution:   Clear and redraw before opening the popup.
Files:      src/testdir/test_terminal.vim

Patch 8.2.0352
Problem:    FreeBSD: test for sourcing utf-8 is skipped.
Solution:   Run the matchadd_conceal test separately to avoid that setting
            'term' to "ansi" causes problems for other tests. (Ozaki Kiichi,
            closes #5721)
Files:      src/testdir/Make_all.mak, src/testdir/test_alot_utf8.vim,
            src/testdir/test_source_utf8.vim

Patch 8.2.0353
Problem:    Vim9: while loop not tested.
Solution:   Add test with "while", "break" and "continue"
Files:      src/testdir/test_vim9_script.vim

Patch 8.2.0354
Problem:    Python 3.9 does not define _Py_DEC_REFTOTAL. (Zdenek Dohnal)
Solution:   Remove it, it was only for debugging.
Files:      src/if_python3.c

Patch 8.2.0355
Problem:    Vim9: str_val is confusing, it's a number
Solution:   Rename to stnr_val.
Files:      src/vim9.h, src/vim9compile.c, src/vim9execute.c

Patch 8.2.0356
Problem:    MS-Windows: feedkeys() with VIMDLL cannot handle CSI correctly.
Solution:   Modify mch_inchar() to encode CSI bytes. (Ozaki Kiichi, Ken
            Takata, closes #5726)
Files:      src/getchar.c, src/os_win32.c, src/testdir/test_popupwin.vim

Patch 8.2.0357
Problem:    Cannot delete a text property matching both id and type. (Axel
            Forsman)
Solution:   Add the "both" argument.
Files:      src/textprop.c, runtime/doc/textprop.txt,
            src/testdir/test_textprop.vim

Patch 8.2.0358
Problem:    Insufficient testing for indent.c.
Solution:   Add indent tests. (Yegappan Lakshmanan, closes #5736)
Files:      src/testdir/Make_all.mak, src/testdir/test_ex_mode.vim,
            src/testdir/test_expand_func.vim, src/testdir/test_indent.vim,
            src/testdir/test_lispwords.vim, src/testdir/test_smartindent.vim,
            src/testdir/test_vartabs.vim

Patch 8.2.0359
Problem:    popup_atcursor() may hang. (Yasuhiro Matsumoto)
Solution:   Take the decoration into account. (closes #5728)
Files:      src/popupwin.c, src/testdir/test_popupwin.vim

Patch 8.2.0360
Problem:    Yaml files are only recognized by the file extension.
Solution:   Check for a line starting with "%YAML". (Jason Franklin)
Files:      runtime/scripts.vim, src/testdir/test_filetype.vim

Patch 8.2.0361
Problem:    Internal error when using "0" for a callback.
Solution:   Give a normal error. (closes #5743)
Files:      src/evalvars.c, src/testdir/test_timers.vim

Patch 8.2.0362
Problem:    MS-Windows: channel test fails if grep is not available.
Solution:   Use another command. (Ken Takata, closes #5739)
Files:      src/testdir/test_channel.vim

Patch 8.2.0363
Problem:    Some Normal mode commands not tested.
Solution:   Add more tests. (Yegappan Lakshmanan, closes #5746)
Files:      src/testdir/test_cindent.vim, src/testdir/test_cmdline.vim,
            src/testdir/test_edit.vim, src/testdir/test_indent.vim,
            src/testdir/test_normal.vim, src/testdir/test_prompt_buffer.vim,
            src/testdir/test_virtualedit.vim, src/testdir/test_visual.vim

Patch 8.2.0364
Problem:    Printf test failing on Haiku.
Solution:   Make a difference between int and short. (Dominique PellÃ©,
            closes #5749)
Files:      src/message.c

Patch 8.2.0365
Problem:    Tag kind can't be a multibyte character. (Marcin Szamotulski)
Solution:   Recognize multibyte character. (closes #5724)
Files:      src/tag.c, src/testdir/test_taglist.vim

Patch 8.2.0366
Problem:    Hardcopy command not tested enough.
Solution:   Add tests for printing. (Dominique PellÃ©, closes #5748)
Files:      src/testdir/test_hardcopy.vim

Patch 8.2.0367
Problem:    Can use :pedit in a popup window.
Solution:   Disallow it.
Files:      src/ex_docmd.c, src/testdir/test_popupwin.vim

Patch 8.2.0368
Problem:    Vim9: import that redefines local variable does not fail.
Solution:   Check for already defined symbols.
Files:      src/vim9script.c, src/proto/vim9script.pro, src/vim9compile.c,
            src/proto/vim9compile.pro, src/testdir/test_vim9_script.vim

Patch 8.2.0369
Problem:    Various Normal mode commands not fully tested.
Solution:   Add more tests. (Yegappan Lakshmanan, closes #5751)
Files:      src/testdir/test_arglist.vim, src/testdir/test_changelist.vim,
            src/testdir/test_charsearch.vim, src/testdir/test_cmdline.vim,
            src/testdir/test_edit.vim, src/testdir/test_ex_mode.vim,
            src/testdir/test_excmd.vim, src/testdir/test_gf.vim,
            src/testdir/test_iminsert.vim, src/testdir/test_increment.vim,
            src/testdir/test_marks.vim, src/testdir/test_normal.vim,
            src/testdir/test_prompt_buffer.vim, src/testdir/test_put.vim,
            src/testdir/test_registers.vim, src/testdir/test_tagjump.vim,
            src/testdir/test_visual.vim

Patch 8.2.0370
Problem:    The typebuf_was_filled flag is sometimes not reset, which may
            cause a hang.
Solution:   Make sure typebuf_was_filled is reset when the typeahead buffer is
            empty.
Files:      src/edit.c, src/getchar.c,

Patch 8.2.0371
Problem:    Crash with combination of terminal popup and autocmd.
Solution:   Disallow closing a popup that is the current window.  Add a check
            that the current buffer is valid. (closes #5754)
Files:      src/macros.h, src/buffer.c, src/popupwin.c, src/terminal.c,
            src/testdir/test_terminal.vim

Patch 8.2.0372
Problem:    Prop_find() may not find text property at start of the line.
Solution:   Adjust the loop to find properties. (Axel Forsman, closes #5761,
            closes #5663)
Files:      src/textprop.c, src/testdir/test_textprop.vim

Patch 8.2.0373
Problem:    Type of term_sendkeys() is unknown.
Solution:   Just return zero. (closes #5762)
Files:      src/terminal.c, src/testdir/test_terminal.vim

Patch 8.2.0374
Problem:    Using wrong printf directive for jump location.
Solution:   Change "%lld" to "%d". (James McCoy, closes #5773)
Files:      src/vim9execute.c

Patch 8.2.0375
Problem:    Coverity warning for not using return value.
Solution:   Move error message to separate function.
Files:      src/popupwin.c

Patch 8.2.0376
Problem:    Nasty callback test fails on some systems.
Solution:   Increase the sleep time.
Files:      src/testdir/test_terminal.vim

Patch 8.2.0377
Problem:    No CI test for a big-endian system.
Solution:   Test with s390x. (James McCoy, closes #5772)
Files:      .travis.yml

Patch 8.2.0378
Problem:    prop_find() does not find all props.
Solution:   Check being in the start line. (Axel Forsman, closes #5776)
Files:      src/textprop.c, src/testdir/test_textprop.vim

Patch 8.2.0379
Problem:    Gcc warns for ambiguous else.
Solution:   Add braces. (Dominique PellÃ©, closes #5778)
Files:      src/textprop.c

Patch 8.2.0380
Problem:    Tiny popup when creating a terminal popup without minwidth.
Solution:   Use a default minimum size of 5 lines of 20 characters.
Files:      src/popupwin.c, src/testdir/test_terminal.vim,
            src/testdir/dumps/Test_terminal_popup_m1.dump

Patch 8.2.0381
Problem:    Using freed memory with :lvimgrep and autocommand. (extracted from
            POC by Dominique PellÃ©)
Solution:   Avoid deleting a dummy buffer used in a window. (closes #5777)
Files:      src/quickfix.c, src/testdir/test_quickfix.vim

Patch 8.2.0382
Problem:    Some tests fail when run under valgrind.
Solution:   Increase timeouts.
Files:      src/testdir/test_autocmd.vim, src/testdir/test_debugger.vim,
            src/testdir/test_channel.vim, src/testdir/test_ins_complete.vim,
            src/testdir/test_terminal.vim,
            src/testdir/dumps/Test_terminal_popup_1.dump,
            src/testdir/dumps/Test_terminal_popup_2.dump,
            src/testdir/dumps/Test_terminal_popup_3.dump,
            src/testdir/dumps/Test_terminal_popup_5.dump,
            src/testdir/dumps/Test_terminal_popup_6.dump,
            src/testdir/dumps/Test_terminal_popup_7.dump,
            src/testdir/dumps/Test_terminal_popup_8.dump,
            src/testdir/dumps/Test_terminal_popup_m1.dump

Patch 8.2.0383
Problem:    Wrong feature check causes test not to be run.
Solution:   Use CheckFunction instead of CheckFeature. (Ozaki Kiichi,
            closes #5781)
Files:      src/testdir/test_channel.vim

Patch 8.2.0384
Problem:    Travis CI has warnings.
Solution:   Avoid warnings, clean up the config. (Ozaki Kiichi, closes #5779)
Files:      .travis.yml

Patch 8.2.0385
Problem:    Menu functionality insufficiently tested.
Solution:   Add tests.  Add menu_info(). (Yegappan Lakshmanan, closes #5760)
Files:      runtime/doc/eval.txt, runtime/doc/gui.txt, runtime/doc/usr_41.txt,
            src/evalfunc.c, src/menu.c, src/proto/menu.pro,
            src/testdir/test_menu.vim, src/testdir/test_popup.vim,
            src/testdir/test_termcodes.vim

Patch 8.2.0386 (after 8.2.0385)
Problem:    Part from unfinished patch got included.
Solution:   Undo that part.
Files:      src/evalfunc.c

Patch 8.2.0387
Problem:    Error for possible NULL argument to qsort().
Solution:   Don't call qsort() when there is nothing to sort. (Dominique
            PellÃ©, closes #5780)
Files:      src/spellsuggest.c

Patch 8.2.0388
Problem:    Printmbcharset option not tested.
Solution:   Add a test.  Enable PostScript for AppVeyor build. (Dominique
            PellÃ©, closes #5783)
Files:      appveyor.yml, src/testdir/test_hardcopy.vim

Patch 8.2.0389
Problem:    Delayed redraw when shifting text from Insert mode.
Solution:   Use msg_attr_keep() instead of msg(). (closes #5782)
Files:      src/ops.c

Patch 8.2.0390
Problem:    Terminal postponed scrollback test is flaky.
Solution:   Add delay in between sending keys.  Rename dump files.
Files:      src/testdir/test_terminal.vim,
            src/testdir/dumps/Test_terminal_01.dump,
            src/testdir/dumps/Test_terminal_02.dump,
            src/testdir/dumps/Test_terminal_03.dump,
            src/testdir/dumps/Test_terminal_scrollback_1.dump,
            src/testdir/dumps/Test_terminal_scrollback_2.dump,
            src/testdir/dumps/Test_terminal_scrollback_3.dump

Patch 8.2.0391 (after 8.2.0377)
Problem:    CI test coverage dropped.
Solution:   Set $DISPLAY also for non-GUI builds. (James McCoy, closes #5788)
Files:      .travis.yml

Patch 8.2.0392
Problem:    Coverity warns for using array index out of range.
Solution:   Add extra "if" to avoid warning.
Files:      src/menu.c

Patch 8.2.0393
Problem:    Coverity warns for not using return value.
Solution:   Add (void).
Files:      src/popupmenu.c

Patch 8.2.0394
Problem:    Coverity complains about using NULL pointer.
Solution:   Use empty string when option value is NULL.
Files:      src/optionstr.c

Patch 8.2.0395
Problem:    Build fails with FEAT_EVAL but without FEAT_MENU.
Solution:   Add #ifdef. (John Marriott)
Files:      src/evalfunc.c

Patch 8.2.0396
Problem:    Cmdexpand.c insufficiently tested.
Solution:   Add more tests. (Yegappan Lakshmanan, closes #5789)
Files:      src/testdir/test_cmdline.vim, src/testdir/test_taglist.vim,
            src/testdir/test_terminal.vim, src/testdir/test_usercommands.vim

Patch 8.2.0397
Problem:    Delayed screen update when using undo from Insert mode.
Solution:   Update w_topline and cursor shape before sleeping. (closes #5790)
Files:      src/normal.c

Patch 8.2.0398
Problem:    Profile test fails when two functions take same time.
Solution:   Add a short sleep in once function. (closes #5797)
Files:      src/testdir/test_profile.vim

Patch 8.2.0399
Problem:    Various memory leaks.
Solution:   Avoid the leaks. (Ozaki Kiichi, closes #5803)
Files:      src/ex_docmd.c, src/ex_getln.c, src/menu.c, src/message.c,
            src/scriptfile.c, src/userfunc.c

Patch 8.2.0400
Problem:    Not all tests using a terminal are in the list of flaky tests.
Solution:   Introduce the test_is_flaky flag.
Files:      src/testdir/runtest.vim, src/testdir/term_util.vim,
            src/testdir/screendump.vim, src/testdir/test_autocmd.vim

Patch 8.2.0401
Problem:    Not enough test coverage for evalvars.c.
Solution:   Add more tests. (Yegappan Lakshmanan, closes #5804)
Files:      src/testdir/test_cmdline.vim, src/testdir/test_const.vim,
            src/testdir/test_diffmode.vim, src/testdir/test_excmd.vim,
            src/testdir/test_functions.vim, src/testdir/test_let.vim,
            src/testdir/test_listdict.vim, src/testdir/test_spell.vim,
            src/testdir/test_unlet.vim, src/testdir/test_user_func.vim,
            src/testdir/test_vimscript.vim

Patch 8.2.0402 (after 8.2.0401)
Problem:    Setting local instead of global flag.
Solution:   Prepend "g:" to "test_is_flaky".
Files:      src/testdir/term_util.vim, src/testdir/screendump.vim,
            src/testdir/test_autocmd.vim

Patch 8.2.0403
Problem:    When 'buftype' is "nofile" there is no overwrite check.
Solution:   Also check for existing file when 'buftype' is set.
            (closes #5807)
Files:      src/ex_cmds.c, src/testdir/test_options.vim

Patch 8.2.0404
Problem:    Writefile() error does not give a hint.
Solution:   Add remark about first argument.
Files:      src/filepath.c, src/testdir/test_writefile.vim

Patch 8.2.0405
Problem:    MSVC: build fails with some combination of features.
Solution:   Enable CHANNEL if TERMINAL is enabled. (Mike Williams)
Files:      src/Make_mvc.mak

Patch 8.2.0406
Problem:    FileReadCmd event not well tested.
Solution:   Add a test.
Files:      src/testdir/test_autocmd.vim

Patch 8.2.0407
Problem:    No early check if :find and :sfind have an argument.
Solution:   Add EX_NEEDARG.
Files:      src/ex_cmds.h, src/testdir/test_findfile.vim,
            src/testdir/test_find_complete.vim

Patch 8.2.0408
Problem:    Delete() commented out for testing.
Solution:   Undo commenting-out.
Files:      src/testdir/test_vim9_disassemble.vim

Patch 8.2.0409
Problem:    Search test leaves file behind.
Solution:   Delete the file.  Also use Check commands.
Files:      src/testdir/test_search.vim

Patch 8.2.0410
Problem:    Channel test fails too often on slow Mac.
Solution:   Increase waiting time to 10 seconds.
Files:      src/testdir/test_channel.vim

Patch 8.2.0411
Problem:    Mac: breakcheck is using a value from the stone ages.
Solution:   Delete BREAKCHECK_SKIP from the Mac header file. (Ben Jackson)
Files:      src/os_mac.h

Patch 8.2.0412
Problem:    MS-Windows: cannot use vimtutor from the start menu.
Solution:   Better check for writable directory. Use the right path for the
            executable. (Wu Yongwei, closes #5774, closes #5756)
Files:      vimtutor.bat

Patch 8.2.0413
Problem:    Buffer menu does not handle special buffers properly.
Solution:   Keep a dictionary with buffer names to reliably keep track of
            entries.
            Also trigger BufFilePre and BufFilePost for command-line and
            terminal buffers when the name changes.
Files:      src/testdir/test_alot.vim, src/testdir/Make_all.mak,
            runtime/menu.vim, src/ex_getln.c, src/terminal.c,
            src/testdir/test_menu.vim

Patch 8.2.0414
Problem:    Channel connect_waittime() test is flaky.
Solution:   Set the test_is_flaky flag.  Use test_is_flaky for more tests.
Files:      src/testdir/test_channel.vim, src/testdir/test_terminal.vim,
            src/testdir/runtest.vim

Patch 8.2.0415
Problem:    Bsdl filetype is not detected.
Solution:   Add an entry in the filetype list. (Daniel Kho, closes #5810)
Files:      runtime/filetype.vim, src/testdir/test_filetype.vim

Patch 8.2.0416
Problem:    Test leaves file behind.
Solution:   Delete the file.
Files:      src/testdir/test_indent.vim

Patch 8.2.0417
Problem:    Travis CI config can be improved.
Solution:   Remove COVERAGE variable. Add load-snd-dummy script. add "-i NONE"
            to avoid messages about viminfo. (Ozaki Kiichi, closes #5813)
Files:      .travis.yml, ci/load-snd-dummy.sh

Patch 8.2.0418
Problem:    Code in eval.c not sufficiently covered by tests.
Solution:   Add more tests. (Yegappan Lakshmanan, closes #5815)
Files:      src/testdir/test_blob.vim, src/testdir/test_channel.vim,
            src/testdir/test_cmdline.vim, src/testdir/test_eval_stuff.vim,
            src/testdir/test_expr.vim, src/testdir/test_functions.vim,
            src/testdir/test_job_fails.vim, src/testdir/test_lambda.vim,
            src/testdir/test_let.vim, src/testdir/test_listdict.vim,
            src/testdir/test_marks.vim, src/testdir/test_method.vim,
            src/testdir/test_normal.vim, src/testdir/test_unlet.vim,
            src/testdir/test_usercommands.vim, src/testdir/test_vimscript.vim,
            src/testdir/test_window_cmd.vim

Patch 8.2.0419
Problem:    Various memory leaks in Vim9 script code.
Solution:   Fix the leaks. (Ozaki Kiichi, closes #5814)
Files:      src/proto/vim9compile.pro, src/scriptfile.c, src/structs.h,
            src/testdir/test_vim9_script.vim, src/vim9.h, src/vim9compile.c,
            src/vim9execute.c, src/vim9script.c

Patch 8.2.0420
Problem:    Vim9: cannot interrupt a loop with CTRL-C.
Solution:   Check for CTRL-C once in a while.  Doesn't fully work yet.
Files:      src/misc1.c, src/proto/misc1.pro,
            src/testdir/test_vim9_script.vim

Patch 8.2.0421
Problem:    Interrupting with CTRL-C does not always work.
Solution:   Recognize CTRL-C while modifyOtherKeys is set.
Files:      src/ui.c, src/testdir/test_vim9_script.vim, src/evalfunc.c

Patch 8.2.0422
Problem:    Crash when passing popup window to win_splitmove(). (john Devin)
Solution:   Disallow moving a popup window. (closes #5816)
Files:      src/testdir/test_popupwin.vim, src/evalwindow.c

Patch 8.2.0423
Problem:    In some environments a few tests are expected to fail.
Solution:   Add $TEST_MAY_FAIL to list tests that should not cause make to
            fail.
Files:      src/testdir/runtest.vim

Patch 8.2.0424
Problem:    Checking for wrong return value. (Tom)
Solution:   Invert the check and fix the test.
Files:      src/vim9execute.c, src/testdir/test_vim9_script.vim

Patch 8.2.0425
Problem:    Code for modeless selection not sufficiently tested.
Solution:   Add tests.  Move mouse code functionality to a common script file.
            (Yegappan Lakshmanan, closes #5821)
Files:      src/testdir/Make_all.mak, src/testdir/gen_opt_test.vim,
            src/testdir/mouse.vim, src/testdir/test_edit.vim,
            src/testdir/test_global.vim, src/testdir/test_modeless.vim,
            src/testdir/test_normal.vim, src/testdir/test_selectmode.vim,
            src/testdir/test_termcodes.vim, src/testdir/test_visual.vim,
            src/ui.c

Patch 8.2.0426
Problem:    Some errors were not tested for.
Solution:   Add tests. (Dominique PellÃ©, closes #5824)
Files:      src/testdir/test_buffer.vim, src/testdir/test_options.vim,
