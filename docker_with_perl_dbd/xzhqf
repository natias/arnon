            closes #9521)
Files:      .github/workflows/ci.yml

Patch 8.2.4093
Problem:    Cached breakindent values not initialized properly.
Solution:   Initialize and cache formatlistpat. (Christian Brabandt,
            closes #9526, closes #9512)
Files:      runtime/doc/options.txt, src/indent.c, src/option.c,
            src/proto/option.pro, src/testdir/test_breakindent.vim

Patch 8.2.4094
Problem:    'virtualedit' is window-local but using buffer-local enum.
Solution:   Use window-local enum. (closes #9529)
Files:      src/option.h, src/optiondefs.h

Patch 8.2.4095
Problem:    Sed script not recognized by the first line.
Solution:   Recognize a sed script starting with "#n". (Doug Kearns)
Files:      runtime/scripts.vim, src/testdir/test_filetype.vim

Patch 8.2.4096
Problem:    Linux CI: unnecessarily installing packages
Solution:   Only install packages for huge build.  (Ozaki Kiichi,
            closes #9530)
Files:      .github/workflows/ci.yml

Patch 8.2.4097
Problem:    Wrong number in error message on 32 bit system. (John Paul Adrian
            Glaubitz)
Solution:   Add type cast. (closes #9527)
Files:      src/vim9compile.c

Patch 8.2.4098
Problem:    Typing "interrupt" at debug prompt may keep exception around,
            causing function calls to fail.
Solution:   Discard any exception at the toplevel. (closes #9532)
Files:      src/main.c

Patch 8.2.4099
Problem:    Vim9: cannot use Vim9 syntax in mapping.
Solution:   Add <ScriptCmd> to use the script context for a command.
Files:      runtime/doc/map.txt, src/normal.c, src/getchar.c,
            src/proto/getchar.pro, src/ex_getln.c, src/edit.c, src/terminal.c,
            src/keymap.h, src/insexpand.c, src/misc2.c, src/ops.c,
            src/testdir/test_vim9_import.vim

Patch 8.2.4100
Problem:    Early return when getting the 'formatlistpat' value.
Solution:   Remove the first line. (Christian Brabandt)
Files:      src/option.c, src/testdir/test_breakindent.vim

Patch 8.2.4101
Problem:    Warning for unused argument in tiny version.
Solution:   Add "UNUSED".
Files:      src/getchar.c

Patch 8.2.4102
Problem:    Vim9: import cannot be used after method.
Solution:   Recognize an imported function name. (closes #9496)
Files:      src/eval.c, src/testdir/test_vim9_import.vim

Patch 8.2.4103
Problem:    Vim9: variable declared in for loop not initialized.
Solution:   Always initialize the variable. (closes #9535)
Files:      src/vim9instr.c, src/proto/vim9instr.pro, src/vim9compile.c,
            src/testdir/test_vim9_assign.vim

Patch 8.2.4104
Problem:    Vim9: lower casing the autoload prefix causes problems.
Solution:   Always store the prefix with case preserved.
Files:      src/scriptfile.c, src/testdir/test_vim9_import.vim

Patch 8.2.4105
Problem:    Translation related comment in the wrong place.
Solution:   Move it back with the text. (Ken Takata, closes #9537)
Files:      src/errors.h, src/ex_docmd.c

Patch 8.2.4106
Problem:    Going over the end of the w_lines array.
Solution:   Break out of the loop when "idx" is too big. (issue #9540)
Files:      src/drawscreen.c

Patch 8.2.4107
Problem:    Script context not restored after using <ScriptCmd>.
Solution:   Also restore context when not in a script. (closes #9536)
            Add the 'c' flag to feedkeys() to be able to test this.
Files:      runtime/doc/builtin.txt, src/getchar.c, src/evalfunc.c,
            src/testdir/test_mapping.vim

Patch 8.2.4108
Problem:    Going over the end of the w_lines array.
Solution:   Check not going over the end and limit to Rows. (issue #9540)
Files:      src/drawscreen.c

Patch 8.2.4109
Problem:    MS-Windows: high dpi support is outdated.
Solution:   Improve High DPI support by using PerMonitorV2. (Ken Takata
            closes #9525, closes #3102)
Files:      src/gui.c, src/gui.h, src/gui_w32.c, src/vim.manifest

Patch 8.2.4110
Problem:    Coverity warns for using NULL pointer.
Solution:   Check "evalarg" is not NULL.  Skip errors when "verbose" is false.
Files:      src/eval.c

Patch 8.2.4111
Problem:    Potential problem when map is deleted while executing.
Solution:   Reset last used map pointer when deleting a mapping.
Files:      src/map.c

Patch 8.2.4112
Problem:    Function not deleted at end of test.
Solution:   Delete the function.
Files:      src/testdir/test_diffmode.vim

Patch 8.2.4113
Problem:    Typo on DOCMD_RANGEOK results in not recognizing command.
Solution:   Correct the typo. (closes #9539)
Files:      src/vim.h, src/testdir/test_mapping.vim

Patch 8.2.4114
Problem:    Vim9: type checking for a funcref does not work for when it is
            used in a method.
Solution:   Pass the base to where the type is checked.
Files:      src/vim9type.c, src/proto/vim9type.pro, src/userfunc.c,
            src/testdir/test_vim9_expr.vim

Patch 8.2.4115
Problem:    Cannot use a method with a complex expression.
Solution:   Evaluate the expression after "->" and use the result.
Files:      src/eval.c, src/errors.h, src/testdir/test_vim9_expr.vim

Patch 8.2.4116
Problem:    Vim9: cannot use a method with a complex expression in a :def
            function.
Solution:   Implement compiling the expression.
Files:      src/vim9expr.c, src/testdir/test_vim9_expr.vim

Patch 8.2.4117
Problem:    Vim9: wrong white space error after using imported item.
Solution:   Don't skip over white space. (closes #9544)
Files:      src/eval.c, src/testdir/test_vim9_import.vim

Patch 8.2.4118
Problem:    Using UNUSED for argument that is used.
Solution:   Remove UNUSED.
Files:      src/usercmd.c

Patch 8.2.4119
Problem:    Build failure when disabling the channel feature.
Solution:   Adjust #ifdef. (Dominique Pellé, closes #9545)
Files:      src/misc2.c

Patch 8.2.4120
Problem:    Block insert goes over the end of the line.
Solution:   Handle invalid byte better.  Fix inserting the wrong text.
Files:      src/ops.c, src/testdir/test_visual.vim

Patch 8.2.4121
Problem:    Visual test fails on MS-Windows.
Solution:   Set 'isprint' so that the character used is not printable.
Files:      src/testdir/test_visual.vim

Patch 8.2.4122
Problem:    ":command Cmd" does not show custom completion argument.
Solution:   Show the completion argument when using ":verbose".
Files:      src/usercmd.c, src/testdir/test_usercommands.vim

Patch 8.2.4123
Problem:    Complete function cannot be import.Name.
Solution:   Dereference the function name if needed.  Also: do not see
            "import.Name" as a builtin function. (closes #9541)
Files:      src/userfunc.c, src/eval.c, src/testdir/test_vim9_import.vim

Patch 8.2.4124
Problem:    Vim9: method in compiled function may not see script item.
Solution:   Make sure not to skip to the next line. (closes #9496)
Files:      src/vim9expr.c, src/testdir/test_vim9_expr.vim

Patch 8.2.4125
Problem:    Completion tests fail.
Solution:   Disable error messages while dereferencing the function name.
Files:      src/eval.c

Patch 8.2.4126
Problem:    Crash on exit when built with dynamic Tcl and EXITFREE is defined.
            (Dominique Pellé)
Solution:   Only call Tcl_Finalize() when initialized. (closes #9546)
Files:      src/if_tcl.c

Patch 8.2.4127
Problem:    Build failure without the +eval feature.
Solution:   Add #ifdef.
Files:      src/usercmd.c

Patch 8.2.4128
Problem:    Crash when method cannot be found. (Christian J. Robinson)
Solution:   Don't mix up pointer names.
Files:      src/eval.c, src/testdir/test_vim9_expr.vim

Patch 8.2.4129
Problem:    Building with +sound but without +eval fails. (Dominique Pellé)
Solution:   Disable canberra in tiny and small build. (closes #9548)
Files:      src/configure.ac, src/auto/configure

Patch 8.2.4130
Problem:    MS-Windows: MSVC build may have libraries duplicated.
Solution:   Improve the MSVC Makefile. (Ken Takata, closes #9547)
Files:      src/Make_mvc.mak

Patch 8.2.4131
Problem:    Vim9: calling function in autoload import does not work in a :def
            function.
Solution:   When a variable is not found and a PCALL follows use a funcref.
            (closes #9550)
Files:      src/vim9execute.c, src/testdir/test_vim9_import.vim

Patch 8.2.4132
Problem:    Vim9: wrong error message when autoload script can't be found.
Solution:   Correct check for using autoload with wrong name.
Files:      src/vim9script.c, src/testdir/test_vim9_import.vim

Patch 8.2.4133
Problem:    output of ":scriptnames" goes into the message history, while this
            does not happen for other commands, such as ":ls".
Solution:   Use msg_outtrans() instead of smsg(). (closes #9551)
Files:      src/scriptfile.c, src/testdir/test_scriptnames.vim

Patch 8.2.4134
Problem:    MS-Windows: test for import with absolute path fails.
Solution:   Handle path starting with slash as an absolute path.
Files:      src/vim9script.c

Patch 8.2.4135
Problem:    Vim9: ":scriptnames" shows unloaded imported autoload script.
Solution:   Mark the unloaded script with "A". (closes #9552)
Files:      runtime/doc/repeat.txt, src/scriptfile.c,
            src/testdir/test_vim9_import.vim

Patch 8.2.4136
Problem:    Vim9: the "autoload" argument of ":vim9script" is not useful.
Solution:   Remove the argument. (closes #9555)
Files:      runtime/doc/vim9.txt, runtime/doc/repeat.txt, src/vim9script.c,
            src/errors.h, src/testdir/test_vim9_import.vim

Patch 8.2.4137
Problem:    Vim9: calling import with and without method is inconsistent.
Solution:   Set a flag that a parenthesis follows to compile_load_scriptvar().
            Add some more tests.  Improve error message.
Files:      src/vim9expr.c, src/vim9execute.c, src/vim9script.c,
            src/testdir/test_vim9_import.vim

Patch 8.2.4138
Problem:    Vim9: no error for return with argument when the function does not
            return anything.
Solution:   Give an error for the invalid argument. (issue #9497)
Files:      src/vim9cmds.c, src/testdir/test_vim9_func.vim

Patch 8.2.4139
Problem:    Using freed memory if an expression abbreviation deletes the
            abbreviation.
Solution:   Do not access the pointer after evaluating the expression.
Files:      src/map.c, src/testdir/test_mapping.vim

Patch 8.2.4140
Problem:    maparg() does not indicate the type of script where it was defined.
Solution:   Add "scriptversion".
Files:      runtime/doc/builtin.txt, src/map.c, src/testdir/test_maparg.vim

Patch 8.2.4141 (after 8.2.4140)
Problem:    Vim9 builtin functions test fails.
Solution:   Add "scriptversion" item to maparg() result.
Files:      src/testdir/test_vim9_builtin.vim

Patch 8.2.4142
Problem:    Build failure with normal features without persistent undo.
Solution:   Adjust #ifdef. (closes #9557)
Files:      src/fileio.c

Patch 8.2.4143
Problem:    MS-Windows: IME support for Win9x is obsolete.
Solution:   Remove the Win9x code. (Ken Takata, closes #9559)
Files:      src/gui_w32.c

Patch 8.2.4144
Problem:    Cannot load libsodium dynamically.
Solution:   Support dynamic loading on MS-Windows. (Ken Takata, closes #9554)
Files:      src/Make_cyg_ming.mak, src/Make_mvc.mak, src/buffer.c,
            src/crypt.c, src/memline.c, src/proto/crypt.pro

Patch 8.2.4145
Problem:    Confusing error when using name of import for a function.
Solution:   Pass a flag to trans_function_name().
Files:      src/vim.h, src/userfunc.c, src/proto/userfunc.pro, src/eval.c,
            src/testdir/test_vim9_import.vim

Patch 8.2.4146
Problem:    Vim9: shadowed function can be used in compiled function but not
            at script level.
Solution:   Also give an error in a compiled function. (closes #9563)
Files:      src/vim9expr.c

Patch 8.2.4147
Problem:    E464 does not always include the offending command.
Solution:   Add another error message with "%s". (closes #9564)
Files:      src/errors.h, src/vim9compile.c, src/ex_docmd.c,
            src/testdir/test_vim9_script.vim

Patch 8.2.4148
Problem:    Deleting any mapping may cause <ScriptCmd> to not set the script
            context.
Solution:   Only reset last_used_map if it is the deleted mapping.
            (closes #9568)
Files:      src/map.c, src/getchar.c, src/proto/getchar.pro,
            src/testdir/test_mapping.vim

Patch 8.2.4149
Problem:    Test override not restored, autocommand left behind.
Solution:   Correct restoring test override.  Delete autocommand afterwards.
Files:      src/testdir/test_autocmd.vim, src/testdir/test_mapping.vim

Patch 8.2.4150
Problem:    Coverity warns for using pointer after free.
Solution:   Swap statements, even though using the pointer is no problem.
Files:      src/map.c

Patch 8.2.4151
Problem:    Reading beyond the end of a line.
Solution:   For block insert only use the offset for correcting the length.
Files:      src/ops.c, src/testdir/test_visual.vim

Patch 8.2.4152
Problem:    Block insert with double wide character fails.
Solution:   Adjust the expected output.
Files:      src/testdir/test_utf8.vim

Patch 8.2.4153
Problem:    MS-Windows: Global IME is no longer supported.
Solution:   Remove the Global IME implementation. (Ken Takata, closes #9562)
Files:      Filelist, runtime/doc/mbyte.txt, src/Make_mvc.mak, src/dimm.idl,
            src/glbl_ime.cpp, src/glbl_ime.h, src/gui_w32.c, src/vim.h

Patch 8.2.4154
Problem:    ml_get error when exchanging windows in Visual mode.
Solution:   Correct end of Visual area when entering another buffer.
Files:      src/window.c, src/testdir/test_visual.vim

Patch 8.2.4155
Problem:    Translating strftime() argument results in check error.
Solution:   Add gettext comment.
Files:      src/time.c

Patch 8.2.4156
Problem:    Fileinfo message overwrites echo'ed message.
Solution:   Reset need_fileinfo when displaying a message. (Rob Pilling,
            closes #9569)
Files:      src/message.c, src/testdir/test_messages.vim,
            src/testdir/dumps/Test_fileinfo_after_echo.dump

Patch 8.2.4157
Problem:    Terminal test fails because Windows sets the title.
Solution:   Add the "vterm_title" testing override and use it in the test.
            (Ozaki Kiichi, closes #9556)
Files:      runtime/doc/testing.txt, src/globals.h, src/terminal.c,
            src/testing.c, src/testdir/test_terminal.vim

Patch 8.2.4158
Problem:    MS-Windows: memory leak in :browse.
Solution:   Free stuff before returning. (Ken Takata, closes #9574)
Files:      src/gui_w32.c

Patch 8.2.4159
Problem:    MS-Windows: _WndProc() is very long.
Solution:   Move code to separate functions. (Ken Takata, closes #9573)
Files:      src/gui_w32.c

Patch 8.2.4160
Problem:    Cannot change the register used for Select mode delete.
Solution:   Make CTRL-R set the register to be used when deleting text for
            Select mode. (Shougo Matsushita, closes #9531)
Files:      runtime/doc/visual.txt, src/globals.h, src/normal.c, src/ops.c,
            src/testdir/test_selectmode.vim

Patch 8.2.4161
Problem:    Vim9: warning for missing white space after imported variable.
Solution:   Do not skip white space. (closes #9567)
Files:      src/vim9expr.c, src/testdir/test_vim9_import.vim

Patch 8.2.4162
Problem:    Vim9: no error for redefining function with export.
Solution:   Check for existing function with/without prefix. (closes #9577)
Files:      src/userfunc.c, src/scriptfile.c, src/testdir/test_vim9_import.vim

Patch 8.2.4163
Problem:    No error for omitting function name after autoload prefix.
Solution:   Check for missing function name. (issue #9577)
Files:      src/userfunc.c, src/testdir/test_vim9_import.vim

Patch 8.2.4164 (after 8.2.4162)
Problem:    Error in legacy code for function shadowing variable.
Solution:   Only give the error in Vim9 script.
Files:      src/userfunc.c

Patch 8.2.4165
Problem:    The nv_g_cmd() function is too long.
Solution:   Move code to separate functions. (Yegappan Lakshmanan,
            closes #9576)
Files:      src/normal.c

Patch 8.2.4166
Problem:    Undo synced when switching buffer in another window.
Solution:   Do not sync undo when not needed. (closes #9575)
Files:      src/buffer.c, src/testdir/test_timers.vim

Patch 8.2.4167
Problem:    Vim9: error message for old style import.
Solution:   Use another error message.  Add a test.
Files:      src/evalvars.c, src/errors.h, src/testdir/test_vim9_import.vim

Patch 8.2.4168 (after 8.2.4163)
Problem:    Disallowing empty function name breaks existing plugins.
Solution:   Allow empty function name in legacy script.
Files:      src/userfunc.c, src/testdir/test_autoload.vim,
            src/testdir/sautest/autoload/foo.vim

Patch 8.2.4169
Problem:    MS-Windows: unnecessary casts and other minor things.
Solution:   Clean up the MS-Windows code. (Ken Takata, closes #9583)
Files:      src/gui_w32.c

Patch 8.2.4170
Problem:    MS-Windows: still using old message API calls.
Solution:   Call the "W" functions directly. (Ken Takata, closes #9582)
Files:      src/gui_w32.c, src/os_mswin.c, src/os_win32.c, src/os_win32.h

Patch 8.2.4171
Problem:    Cannot invoke option function using autoload import.
Solution:   Expand the import to an autoload function name. (closes #9578)
Files:      src/userfunc.c, src/evalvars.c, src/proto/evalvars.pro,
            src/option.c, src/testdir/test_vim9_import.vim

Patch 8.2.4172
Problem:    Filetype detection for BASIC is not optimal.
Solution:   Improve BASIC filetype detection. (Doug Kearns)
Files:      runtime/autoload/dist/ft.vim, runtime/filetype.vim,
            src/testdir/test_filetype.vim

Patch 8.2.4173
Problem:    Cannot use an import in 'foldexpr'.
Solution:   Set the script context to where 'foldexpr' was set. (closes #9584)
            Fix that the script context was not set for all buffers.
Files:      src/eval.c, src/proto/eval.pro, src/fold.c, src/structs.h,
            src/option.c, src/testdir/test_vim9_import.vim

Patch 8.2.4174
Problem:    Vim9: can use an autoload name in normal script.
Solution:   Disallow using an autoload name.
Files:      src/userfunc.c, src/errors.h, src/testdir/test_vim9_import.vim

Patch 8.2.4175
Problem:    MS-Windows: runtime check for multi-line balloon is obsolete.
Solution:   Remove the obsolete code. (Ken Takata, closes #9592)
Files:      src/evalfunc.c, src/gui_w32.c, src/proto/gui_w32.pro

Patch 8.2.4176
Problem:    Vim9: cannot use imported function with call().
Solution:   Translate the function name. (closes #9590)
Files:      src/evalfunc.c, src/testdir/test_vim9_import.vim

Patch 8.2.4177
Problem:    Vim9: autoload script not loaded after "vim9script noclear".
Solution:   Check IMP_FLAGS_AUTOLOAD properly. (closes #9593)
Files:      src/vim9compile.c, src/testdir/test_vim9_import.vim

Patch 8.2.4178
Problem:    Vim9: invalid error for return type of lambda when debugging.
Solution:   Do not check the return type of a lambda. (closes #9589)
Files:      src/vim9cmds.c

Patch 8.2.4179
Problem:    'foldtext' is evaluated in the current script context.
Solution:   Use the script context where the option was set.
Files:      src/fold.c, src/buffer.c, src/eval.c, src/proto/eval.pro,
            src/findfile.c, src/testdir/test_vim9_import.vim

Patch 8.2.4180
Problem:    'balloonexpr' is evaluated in the current script context.
Solution:   Use the script context where the option was set.
Files:      src/beval.c, src/option.c, src/proto/option.pro,
            src/testdir/test_balloon.vim,
            src/testdir/dumps/Test_balloon_eval_term_01.dump,
            src/testdir/dumps/Test_balloon_eval_term_01a.dump,
            src/testdir/dumps/Test_balloon_eval_term_02.dump

Patch 8.2.4181
Problem:    Vim9: cannot use an import in 'diffexpr'.
Solution:   Set the script context when evaluating 'diffexpr'.  Do not require
            'diffexpr' to return a bool, it was ignored anyway.
Files:      src/evalvars.c, src/testdir/test_vim9_import.vim

Patch 8.2.4182 (after 8.2.4182)
Problem:    Memory leak when evaluating 'diffexpr'.
Solution:   Use free_tv() instead of clear_tv().
Files:      src/evalvars.c

Patch 8.2.4183
Problem:    Cannot use an import in 'formatexpr'.
Solution:   Set the script context when evaluating 'formatexpr'.
Files:      src/textformat.c, src/testdir/test_vim9_import.vim

Patch 8.2.4184
Problem:    Cannot use an import in 'includeexpr'.
Solution:   Set the script context when evaluating 'includeexpr'
Files:      src/findfile.c, src/testdir/test_vim9_import.vim

Patch 8.2.4185
Problem:    Cannot use an import in 'indentexpr'.
Solution:   Set the script context when evaluating 'indentexpr'
Files:      src/indent.c, src/testdir/test_vim9_import.vim

Patch 8.2.4186
Problem:    Cannot use an import in 'patchexpr'.
Solution:   Set the script context when evaluating 'patchexpr'.  Do not
            require 'patchexpr' to return a bool, it was ignored anyway.
Files:      src/evalvars.c, src/testdir/test_vim9_import.vim

Patch 8.2.4187
Problem:    Gnuplot file not recognized.
Solution:   Recognize ".gnuplot". (closes #9588)
Files:      runtime/filetype.vim, src/testdir/test_filetype.vim

Patch 8.2.4188
Problem:    Not all gitconfig files are recognized.
Solution:   Add a few more patterns. (Tim Pope, closes #9597)
Files:      runtime/filetype.vim, src/testdir/test_filetype.vim

Patch 8.2.4189
Problem:    MS-Windows: code for "old look" is obsolete.
Solution:   Delete obsolete code.  Use "MS Shell Dlg" font. (Ken Takata,
            closes #9596)
Files:      src/gui_w32.c

Patch 8.2.4190
Problem:    All conceal tests are skipped without the screendumps feature.
Solution:   Only skip the tests that use screendumps. (closes #9599)
Files:      src/testdir/test_conceal.vim

Patch 8.2.4191
Problem:    json5 files are not recognized.
Solution:   Add a pattern for json5 files. (closes #9601)
Files:      runtime/filetype.vim, src/testdir/test_filetype.vim

Patch 8.2.4192
Problem:    Cannot use an import in 'printexpr'.
Solution:   Set the script context when evaluating 'printexpr'.
Files:      src/evalvars.c, src/testdir/test_vim9_import.vim

Patch 8.2.4193
Problem:    Cannot use an import in 'charconvert'.
Solution:   Set the script context when evaluating 'charconvert'.  Also expand
            script-local functions in 'charconvert'.
Files:      src/evalvars.c, src/optionstr.c, src/testdir/test_vim9_import.vim

Patch 8.2.4194
Problem:    MS-Windows: code for calculating font size is duplicated.
Solution:   Move the code to a function. (Ken Takata, closes #9603)
Files:      src/gui_w32.c

Patch 8.2.4195
Problem:    Resizing terminal may cause to behave like CTRL-Z.
Solution:   Set "got_tstp" only when in_mch_suspend is set. (Dorian Bivolaru,
            closes #9602, closes #9586)
Files:      src/os_unix.c

Patch 8.2.4196
Problem:    Various file types not recognized.
Solution:   Add patterns to recognize more file types (closes #9607)
Files:      runtime/filetype.vim, src/testdir/test_filetype.vim

Patch 8.2.4197
Problem:    Cannot use an import in the "expr" part of 'spellsuggest'.
Solution:   Set the script context when evaluating "expr" of 'spellsuggest'.
Files:      src/evalvars.c, src/testdir/test_vim9_import.vim

Patch 8.2.4198
Problem:    Vim9: the switch for executing instructions is too long.
Solution:   Move some code to separate functions.
Files:      src/vim9execute.c

Patch 8.2.4199
Problem:    MS-Windows: Support for MSVC before 2003 is not useful.
Solution:   Remove the exceptions for MSVC 6.0. (Ken Takata, closes #9616)
Files:      src/GvimExt/gvimext.h, src/ex_docmd.c, src/feature.h,
            src/gui_w32.c, src/if_cscope.c, src/if_ole.cpp, src/if_ruby.c,
            src/macros.h, src/os_mswin.c, src/os_win32.c, src/os_win32.h,
            src/proto/os_win32.pro, src/time.c, src/vim.h

Patch 8.2.4200
Problem:    Some tests do not clean up properly.
Solution:   Delete created files. (Yegappan Lakshmanan, closes #9611)
Files:      src/testdir/test_filetype.vim, src/testdir/test_messages.vim,
            src/testdir/test_vim9_import.vim

Patch 8.2.4201
Problem:    When using the GUI CTRL-Z does not stop gvim.
Solution:   When using the GUI set SIGTSTP to SIG_DFL. (Andrew Maltsev,
            closes #9570)
Files:      src/os_unix.c

Patch 8.2.4202
Problem:    Vim9: cannot export function that exists globally.
Solution:   When checking if a function already exists only check for
            script-local functions. (closes #9615)
Files:      src/userfunc.c, src/proto/userfunc.pro, src/vim.h,
            src/vim9compile.c, src/vim9instr.c,
            src/testdir/test_vim9_import.vim

Patch 8.2.4203
Problem:    Entering a character with CTRL-V may include modifiers.
Solution:   Reset "mod_mask" when entering a character with digits after
            CTRL-V. (closes #9610)
Files:      src/edit.c, src/testdir/test_edit.vim

Patch 8.2.4204
Problem:    screenpos() has non-zero row for invisible text.
Solution:   Only add the window row when the text is visible. (closes #9618)
Files:      src/move.c, src/testdir/test_cursor_func.vim

Patch 8.2.4205
Problem:    The normal_cmd() function is too long.
Solution:   Move parts to separate functions. (Yegappan Lakshmanan,
            closes #9608)
Files:      src/normal.c

Patch 8.2.4206
Problem:    Condition with many "(" causes a crash.
Solution:   Limit recursion to 1000.
Files:      src/errors.h, src/eval.c, src/testdir/test_eval_stuff.vim

Patch 8.2.4207 (after 8.2.4206)
Problem:    Recursion test fails with MSVC.
Solution:   Use a smaller limit for MSVC.
Files:      src/eval.c

Patch 8.2.4208
Problem:    Using setbufvar() may change the window title.
Solution:   Do not redraw when creating the autocommand window. (closes #9613)
Files:      src/autocmd.c, src/testdir/test_functions.vim

Patch 8.2.4209
Problem:    partial in 'opfunc' cannot use an imported function.
Solution:   Also expand the function name in a partial. (closes #9614)
Files:      src/evalvars.c, src/testdir/test_vim9_import.vim

Patch 8.2.4210 (after 8.2.4208)
Problem:    Window title test fails in some configurations.
Solution:   Only run the test if the title can be obtained.
Files:      src/testdir/test_functions.vim

Patch 8.2.4211 (after 8.2.4208)
Problem:    Window title test still fails in some configurations.
Solution:   Use WaitForAssert().
Files:      src/testdir/test_functions.vim

Patch 8.2.4212 (after 8.2.4208)
Problem:    Window title test still fails in some configurations.
Solution:   Explicitly set the 'title' option.
Files:      src/testdir/test_functions.vim

Patch 8.2.4213
Problem:    Too much code for supporting old MSVC versions.
Solution:   Remove MSVC 2003 support. (Ken Takata, closes #9623)
Files:      Filelist, src/INSTALLpc.txt, src/Make_mvc.mak, src/gui_w32.c,
            src/msvcsetup.bat, src/os_win32.c

Patch 8.2.4214
Problem:    Illegal memory access with large 'tabstop' in Ex mode.
Solution:   Allocate enough memory.
Files:      src/ex_getln.c, src/testdir/test_ex_mode.vim

Patch 8.2.4215
Problem:    Illegal memory access when copying lines in Visual mode.
Solution:   Adjust the Visual position after copying lines.
Files:      src/ex_cmds.c, src/testdir/test_visual.vim

Patch 8.2.4216
Problem:    Vim9: cannot use a function from an autoload import directly.
Solution:   Add the AUTOLOAD instruction to figure out at runtime.
            (closes #9620)
Files:      src/vim9expr.c, src/vim9.h, src/vim9execute.c, src/vim9instr.c,
            src/proto/vim9instr.pro, src/testdir/test_vim9_import.vim,
            src/testdir/test_vim9_disassemble.vim

Patch 8.2.4217
Problem:    Illegal memory access when undo makes Visual area invalid.
Solution:   Correct the Visual area after undo.
Files:      src/undo.c, src/testdir/test_visual.vim

Patch 8.2.4218
Problem:    Illegal memory access with bracketed paste in Ex mode.
Solution:   Reserve space for the trailing NUL.
Files:      src/edit.c, src/testdir/test_paste.vim

Patch 8.2.4219
Problem:    Reading before the start of the line.
Solution:   Check boundary before trying to read the character.
Files:      src/register.c, src/testdir/test_visual.vim

Patch 8.2.4220
Problem:    MS-Windows: some old compiler support remains.
Solution:   Remove obsolete compiler support. (Ken Takata, closes #9627)
Files:      src/Make_mvc.mak, src/vim.h

Patch 8.2.4221
Problem:    Some functions in normal.c are very long.
Solution:   Move code to separate functions. (Yegappan Lakshmanan,
            closes #9628)
Files:      src/normal.c

Patch 8.2.4222
Problem:    MS-Windows: clumsy way to suppress progress on CI.
Solution:   Check for "$CI" in the Makefile itself. (Ken Takata, closes #9631)
Files:      .github/workflows/ci.yml, ci/appveyor.bat, src/Make_mvc.mak

Patch 8.2.4223
Problem:    Long/int compiler warnings; function arguments swapped.
Solution:   Add type casts.  Swap arguments. (Ken Takata, closes #9632)
Files:      src/alloc.c, src/eval.c, src/vim9script.c

Patch 8.2.4224
Problem:    Vim9: no error when using a number for map() second argument
Solution:   Disallow number to string conversion. (closes #9630)
Files:      src/eval.c, src/evalfunc.c, src/testdir/test_vim9_builtin.vim

Patch 8.2.4225
Problem:    Vim9: depth argument of :lockvar not parsed in :def function.
Solution:   Parse the optional depth argument. (closes #9629)
            Fix that locking doesn't work for a non-materialize list.
Files:      src/vim9cmds.c, src/evalvars.c, src/structs.h, src/evalfunc.c,
            src/errors.h, src/vim9execute.c, src/testdir/test_vim9_cmd.vim,
            src/testdir/test_vim9_disassemble.vim

Patch 8.2.4226 (after 8.2.4224)
Problem:    Filter-map test fails.
Solution:   Only reject number argument in Vim9 script.
Files:      src/eval.c

Patch 8.2.4227
Problem:    Vim9: using "lockvar!" in :def function does not work.
Solution:   Add "!" instead of "-1". (closes #9634)
Files:      src/vim9cmds.c, src/testdir/test_vim9_cmd.vim

Patch 8.2.4228
Problem:    No tests for clicking in the GUI tabline.
Solution:   Add test functions to generate the events.  Add tests using the
            functions. (Yegappan Lakshmanan, closes #9638)
Files:      runtime/doc/builtin.txt, runtime/doc/testing.txt,
            runtime/doc/usr_41.txt, src/evalfunc.c, src/normal.c,
            src/proto/testing.pro, src/testdir/test_diffmode.vim,
            src/testdir/test_gui.vim, src/testdir/test_normal.vim,
            src/testing.c

Patch 8.2.4229
Problem:    Possible crash when invoking timer callback fails.
Solution:   Initialize the typval.  Give an error for an empty callback.
            (closes #9636)
Files:      src/time.c, src/testdir/test_vim9_builtin.vim

Patch 8.2.4230
Problem:    MS-Windows: set_guifontwide() is included but won't work.
Solution:   Include set_guifontwide() only for X11. (Ken Takata, closes #9640)
Files:      src/gui.c

Patch 8.2.4231
Problem:    Vim9: map() gives type error when type was not declared.
Solution:   Only check the type when it was declared, like extend() does.
            (closes #9635)
Files:      src/list.c, src/evalfunc.c, src/vim9instr.c,
            src/testdir/test_vim9_builtin.vim,
            src/testdir/test_vim9_assign.vim

Patch 8.2.4232 (after 8.2.4231)
Problem:    Some compilers don't like a goto label without statement.
Solution:   Return instead of using a goto.
Files:      src/list.c

Patch 8.2.4233
Problem:    Crash when recording and using Select mode.
Solution:   When deleting the last recorded character check there is something
            to delete.
Files:      src/getchar.c, src/testdir/test_registers.vim

Patch 8.2.4234
Problem:    test_garbagecollect_now() does not check v:testing as documented.
Solution:   Give an error if v:testing is not set.
Files:      src/testing.c, src/errors.h, src/testdir/test_functions.vim

Patch 8.2.4235
Problem:    Invalid check for NULL pointer.
Solution:   Remove the check.
Files:      src/getchar.c

Patch 8.2.4236
Problem:    Accessing freed memory.
Solution:   Set the bh_curr pointer to NULL.
Files:      src/getchar.c

Patch 8.2.4237
Problem:    Record buffer wrong if character in Select mode was not typed.
Solution:   Only delete the tail from the record buffer if the character was
            typed. (closes #9650)
Files:      src/normal.c, src/testdir/test_registers.vim

Patch 8.2.4238
Problem:    *.tf file could be filetype "tf" or "terraform".
Solution:   Detect the type from the file contents. (closes #9642)
Files:      runtime/filetype.vim, runtime/autoload/dist/ft.vim,
            src/testdir/test_filetype.vim

Patch 8.2.4239
Problem:    Build fails with unusual configuration.
Solution:   Adjust #ifdef. (closes #9651)
Files:      src/testing.c

Patch 8.2.4240
Problem:    Error for using flatten() in Vim9 script is unclear.
Solution:   Add a remark to use flattennew().
Files:      src/errors.h

Patch 8.2.4241
Problem:    Some type casts are redundant.
Solution:   Remove the type casts. (closes #9643)
Files:      src/blob.c, src/buffer.c, src/channel.c, src/clientserver.c,
            src/clipboard.c, src/drawline.c, src/drawscreen.c, src/edit.c,
            src/evalfunc.c, src/ex_cmds.c, src/ex_docmd.c, src/ex_eval.c,
            src/fold.c, src/if_cscope.c, src/json.c, src/match.c,
            src/memline.c, src/message.c, src/misc1.c, src/normal.c,
            src/ops.c, src/option.c, src/optionstr.c, src/os_unix.c,
            src/register.c, src/sign.c, src/spellfile.c, src/tag.c, src/ui.c,
            src/undo.c, src/window.c

Patch 8.2.4242
Problem:    Put in Visual mode cannot be repeated.
Solution:   Use "P" to put without yanking the deleted text into the unnamed
            register. (Shougo Matsushita, closes #9591)
Files:      runtime/doc/visual.txt, src/normal.c, src/register.c,
            src/testdir/test_visual.vim

Patch 8.2.4243
Problem:    Lua tests fail with Lua 5.4.4.
Solution:   Check messages like before Lua 5.4.3. (Jakub Kulík, closes #9652)
Files:      src/testdir/test_lua.vim

Patch 8.2.4244
Problem:    MS-Windows: warning from MSVC on debug build.
Solution:   Adjust "/opt" options.  Remove unused variables.  Make variables
            uppercase for consistency. (Ken Takata, closes #9647)
Files:      src/Make_mvc.mak

Patch 8.2.4245
Problem:    ":retab 0" may cause illegal memory access.
Solution:   Limit the value of 'tabstop' to 10000.
Files:      src/option.c, src/vim.h, src/indent.c,
            src/testdir/test_options.vim

Patch 8.2.4246
Problem:    One error message not in errors.h. (Antonio Colombo)
Solution:   Move the message and rename.
Files:      src/errors.h, src/if_perl.xs

Patch 8.2.4247
Problem:    Stack corruption when looking for spell suggestions.
Solution:   Prevent the depth increased too much.  Add a five second time
            limit to finding suggestions.
Files:      src/spellsuggest.c, src/testdir/test_spell.vim

Patch 8.2.4248
Problem:    No proper test for moving the window separator.
Solution:   Add a test.  Add comment in code. (closes #9656)
Files:      src/window.c, src/testdir/test_window_cmd.vim

Patch 8.2.4249
Problem:    The timeout limit for spell suggestions is always 5000 milli
            seconds.
Solution:   Add the "timeout" entry to 'spellsuggest'.
Files:      runtime/doc/options.txt, src/spellsuggest.c,
            src/testdir/test_spell.vim

Patch 8.2.4250
Problem:    Channel out callback test is flaky on Mac.
Solution:   Assign high priority to the test process. (Ozaki Kiichi,
            closes #9653)
Files:      src/testdir/test_channel_pipe.py, src/testdir/thread_util.py

Patch 8.2.4251
Problem:    Vala files are not recognized.
Solution:   Add the *.vala pattern. (closes #9654)
Files:      runtime/filetype.vim, src/testdir/test_filetype.vim

Patch 8.2.4252
Problem:    Generating the normal command table at runtime is inefficient.
Solution:   Generate the table with a Vim script and put it in a header file.
            (Yegappan Lakshmanan, closes #9648)
Files:      Filelist, runtime/doc/builtin.txt, runtime/doc/usr_41.txt,
            src/Make_cyg_ming.mak, src/Make_mvc.mak, src/Make_vms.mms,
            src/Makefile, src/create_nvcmdidxs.vim, src/evalfunc.c,
            src/main.c, src/normal.c, src/nv_cmdidxs.h, src/proto/normal.pro

Patch 8.2.4253
Problem:    Using freed memory when substitute uses a recursive function call.
Solution:   Make a copy of the substitute text.
Files:      src/ex_cmds.c, src/testdir/test_substitute.vim

Patch 8.2.4254
Problem:    Using short instead of int.
Solution:   Use int. (closes #9658)
Files:      src/if_cscope.c

Patch 8.2.4255
Problem:    Theoretical computation overflow.
Solution:   Perform multiplication in a wider type. (closes #9657)
Files:      src/alloc.c, src/drawline.c, src/eval.c, src/evalfunc.c,
            src/ex_docmd.c, src/hardcopy.c, src/list.c, src/memfile.c,
            src/memline.c, src/popupwin.c

Patch 8.2.4256
Problem:    MS-Windows: compiler warnings when compiled with /W4.
Solution:   Small adjustments to the code. (Ken Takata, closes #9659)
Files:      src/gui_w32.c, src/os_win32.c

Patch 8.2.4257
Problem:    Vim9: finding global function without g: prefix but not finding
            global variable is inconsistent.
Solution:   Require using g: for a global function.  Change the vim9.vim
            script into a Vim9 script with exports.  Fix that import in legacy
            script does not work.
Files:      src/vim9expr.c, src/evalfunc.c, src/eval.c, src/userfunc.c,
            src/testdir/vim9.vim, src/testdir/test_vim9_assign.vim,
            src/testdir/test_vim9_builtin.vim, src/testdir/test_vim9_cmd.vim,
            src/testdir/test_vim9_disassemble.vim,
            src/testdir/test_vim9_expr.vim, src/testdir/test_vim9_func.vim,
            src/testdir/test_vim9_import.vim,
            src/testdir/test_vim9_script.vim, src/testdir/test_blob.vim,
            src/testdir/test_execute_func.vim, src/testdir/test_debugger.vim,
            src/testdir/test_expr.vim, src/testdir/test_filter_map.vim,
            src/testdir/test_float_func.vim, src/testdir/test_functions.vim,
            src/testdir/test_glob2regpat.vim, src/testdir/test_highlight.vim,
            src/testdir/test_iminsert.vim, src/testdir/test_ins_complete.vim,
            src/testdir/test_listdict.vim, src/testdir/test_mapping.vim,
            src/testdir/test_normal.vim, src/testdir/test_popupwin.vim,
            src/testdir/test_profile.vim, src/testdir/test_quickfix.vim,
            src/testdir/test_tagfunc.vim, src/testdir/test_textprop.vim,
            src/testdir/test_usercommands.vim

Patch 8.2.4258
Problem:    Coverity warns for array overrun.
Solution:   Restrict depth to MAXWLEN - 1.
Files:      src/spellsuggest.c

Patch 8.2.4259
Problem:    Number of test functions for GUI events is growing.
Solution:   Use one function with a dictionary. (Yegappan Lakshmanan,
            closes #9660)
Files:      runtime/doc/builtin.txt, runtime/doc/testing.txt,
            runtime/doc/usr_41.txt, src/evalfunc.c, src/proto/testing.pro,
            src/testdir/test_gui.vim, src/testdir/test_vim9_builtin.vim,
            src/testing.c

Patch 8.2.4260
Problem:    Vim9: can still use a global function without g: at the script
            level.
Solution:   Also check for g: at the script level. (issue #9637)
Files:      src/userfunc.c, src/proto/userfunc.pro, src/evalvars.c,
            src/vim9expr.c, src/testdir/test_vim9_assign.vim,
            src/testdir/test_vim9_builtin.vim, src/testdir/test_vim9_cmd.vim,
            src/testdir/test_vim9_disassemble.vim,
            src/testdir/test_vim9_expr.vim, src/testdir/test_vim9_func.vim,
            src/testdir/test_vim9_import.vim,
            src/testdir/test_ins_complete.vim, src/testdir/test_popupwin.vim,
            src/testdir/dumps/Test_popupwin_scroll_11.dump,
            src/testdir/dumps/Test_popupwin_scroll_12.dump

Patch 8.2.4261
Problem:    Accessing invalid memory when a regular expression checks the
            Visual area while matching in a string.
Solution:   Do not try matching the Visual area in a string.
Files:      src/regexp.c, src/testdir/test_help.vim

Patch 8.2.4262 (after 8.2.4261)
Problem:    Some search tests fail.
Solution:   Use a better way to reject searching for the Visual area.
Files:      src/regexp.c

Patch 8.2.4263
Problem:    No test for the GUI find/replace dialog.
Solution:   Add a test function and a test. (Yegappan Lakshmanan,
            closes #9662)
Files:      runtime/doc/testing.txt, src/testdir/test_gui.vim, src/testing.c

Patch 8.2.4264
